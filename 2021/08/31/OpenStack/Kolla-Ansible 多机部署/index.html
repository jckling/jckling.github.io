<!DOCTYPE html><html lang="[&quot;zh-CN&quot;,&quot;en&quot;,&quot;zh-HK&quot;,&quot;zh-TW&quot;,&quot;default&quot;]" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Kolla-Ansible å¤šæœºéƒ¨ç½² V ç‰ˆ OpenStack | Jckling's Blog</title><meta name="author" content="Jckling"><meta name="copyright" content="Jckling"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="ä½¿ç”¨ Kolla-Ansible çš„ multinode é…ç½®è¿œç¨‹éƒ¨ç½² OpenStack (Victoria)">
<meta property="og:type" content="article">
<meta property="og:title" content="Kolla-Ansible å¤šæœºéƒ¨ç½² V ç‰ˆ OpenStack">
<meta property="og:url" content="https://jckling.github.io/2021/08/31/OpenStack/Kolla-Ansible%20%E5%A4%9A%E6%9C%BA%E9%83%A8%E7%BD%B2/index.html">
<meta property="og:site_name" content="Jckling&#39;s Blog">
<meta property="og:description" content="ä½¿ç”¨ Kolla-Ansible çš„ multinode é…ç½®è¿œç¨‹éƒ¨ç½² OpenStack (Victoria)">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2021/06/14/O6DgG2AzyvJfTso.jpg">
<meta property="article:published_time" content="2021-08-31T01:49:26.000Z">
<meta property="article:modified_time" content="2025-08-14T09:56:57.429Z">
<meta property="article:author" content="Jckling">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="Ubuntu">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/06/14/O6DgG2AzyvJfTso.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Kolla-Ansible å¤šæœºéƒ¨ç½² V ç‰ˆ OpenStack",
  "url": "https://jckling.github.io/2021/08/31/OpenStack/Kolla-Ansible%20%E5%A4%9A%E6%9C%BA%E9%83%A8%E7%BD%B2/",
  "image": "https://i.loli.net/2021/06/14/O6DgG2AzyvJfTso.jpg",
  "datePublished": "2021-08-31T01:49:26.000Z",
  "dateModified": "2025-08-14T09:56:57.429Z",
  "author": [
    {
      "@type": "Person",
      "name": "Jckling",
      "url": "https://github.com/jckling"
    }
  ]
}</script><link rel="shortcut icon" href="/img/jckling/favicon.ico"><link rel="canonical" href="https://jckling.github.io/2021/08/31/OpenStack/Kolla-Ansible%20%E5%A4%9A%E6%9C%BA%E9%83%A8%E7%BD%B2/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="lfjhmONZuO834dnjVuGulU6croTwfNMGSgNV5vNkf60"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-164555720-1"></script><script>window.dataLayer = window.dataLayer || []
function gtag(){dataLayer.push(arguments)}
gtag('js', new Date())
gtag('config', 'UA-164555720-1')
btf.addGlobalFn('pjaxComplete', () => {
  gtag('config', 'UA-164555720-1', {'page_path': window.location.pathname})
}, 'google_analytics')
</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":300,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶å¤±è´¥',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Kolla-Ansible å¤šæœºéƒ¨ç½² V ç‰ˆ OpenStack',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="Jckling's Blog" type="application/atom+xml">
<link rel="alternate" href="/rss2.xml" title="Jckling's Blog" type="application/rss+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/jckling/avatar.jpg" onerror="this.onerror=null;this.src='/img/jckling/avatar_404.png'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">126</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">49</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">9</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://i.loli.net/2021/06/14/O6DgG2AzyvJfTso.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Jckling's Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">Kolla-Ansible å¤šæœºéƒ¨ç½² V ç‰ˆ OpenStack</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  è¿”å›é¦–é¡µ</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Kolla-Ansible å¤šæœºéƒ¨ç½² V ç‰ˆ OpenStack</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">å‘è¡¨äº</span><time datetime="2021-08-31T01:49:26.000Z" title="å‘è¡¨äº 2021-08-31 09:49:26">2021-08-31</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/OpenStack/">OpenStack</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">æµè§ˆé‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">è¯„è®ºæ•°:</span><a href="/2021/08/31/OpenStack/Kolla-Ansible%20%E5%A4%9A%E6%9C%BA%E9%83%A8%E7%BD%B2/#post-comment"><span class="waline-comment-count" data-path="/2021/08/31/OpenStack/Kolla-Ansible%20%E5%A4%9A%E6%9C%BA%E9%83%A8%E7%BD%B2/"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1>æµ‹è¯•ç¯å¢ƒæ­å»º</h1>
<p>ä¹‹å‰æŠŠæœ¬åœ°é•œåƒä»“åº“ã€OpenStackã€Jaeger å…¨éƒ½æ”¾åœ¨äº†ä¸€å°ä¸»æœºä¸Šè·‘ï¼Œè´Ÿè½½å¾ˆå¤§ï¼Œè€Œä¸”ä¹Ÿä¸ä¿é™©ã€‚ç°åœ¨æ‹†åˆ†ä¸º 2 å°ä¸»æœºï¼š</p>
<ol>
<li>éƒ¨ç½²èŠ‚ç‚¹ï¼ˆKolla-Ansibleï¼‰
<ul>
<li>Ubuntu 20.04</li>
<li>4 CPU</li>
<li>å†…å­˜ 16 GB</li>
<li>ç¡¬ç›˜ 500 GB</li>
<li>ç½‘å¡1</li>
</ul>
</li>
<li>æ§åˆ¶èŠ‚ç‚¹ï¼ˆOpenStackï¼‰
<ul>
<li>Ubuntu 20.04</li>
<li>4 CPU</li>
<li>å†…å­˜ 16 GB</li>
<li>ç¡¬ç›˜ 500 GB</li>
<li>ç½‘å¡1</li>
<li>ç½‘å¡2ï¼ˆæœªå¯ç”¨ï¼‰</li>
</ul>
</li>
</ol>
<p>åœ¨éƒ¨ç½²èŠ‚ç‚¹ç”¨ multinode é…ç½®è¿œç¨‹éƒ¨ç½² OpenStackï¼Œè™½ç„¶è¿™é‡Œåªæœ‰ä¸€å° OpenStack ä¸»æœºğŸ˜‚</p>
<h1>æ§åˆ¶èŠ‚ç‚¹</h1>
<p>æ§åˆ¶èŠ‚ç‚¹åªéœ€ç»™ç”¨æˆ·é…ç½® sudo æƒé™</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ·»åŠ ç”¨æˆ·</span></span><br><span class="line">sudo vim /etc/sudoers</span><br><span class="line"><span class="comment">##includedir /etc/sudoers.d</span></span><br><span class="line"><span class="comment">#op1 ALL=(ALL) NOPASSWD: ALL</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>Prior to Queens, when users want to connect using non-root user, they must add extra option <code>ansible_become=True</code> which is inconvenient and add security risk. In Queens, almost all services have support for escalation for only necessary tasks. In Rocky, all services have this capability, so users do not need to add <code>ansible_become</code> option if connection user has passwordless sudo capability.</p>
</blockquote>
<h1>éƒ¨ç½²èŠ‚ç‚¹</h1>
<h2 id="ç¯å¢ƒå‡†å¤‡">ç¯å¢ƒå‡†å¤‡</h2>
<ol>
<li>
<p>é…ç½® Python3</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¾ä¸ºé»˜è®¤</span></span><br><span class="line">sudo update-alternatives --install /usr/bin/python python /usr/bin/python3.8 1</span><br><span class="line"><span class="comment">#sudo update-alternatives --remove python /usr/bin/python3.8</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£… pip</span></span><br><span class="line">sudo apt install -y python3-pip</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>æ›´æ¢ pip æº</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºæ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="built_in">mkdir</span> .pip &amp;&amp; <span class="built_in">cd</span> .pip</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºå¹¶ç¼–è¾‘é…ç½®æ–‡ä»¶</span></span><br><span class="line">sudo vim pip.conf</span><br></pre></td></tr></table></figure>
<p>é…ç½®å¦‚ä¸‹</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[global]</span><br><span class="line">timeout = 6000</span><br><span class="line">index-url = http://mirrors.aliyun.com/pypi/simple/</span><br><span class="line">trusted-host = mirrors.aliyun.com</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>æ›´æ¢ Ubuntu æº</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¤‡ä»½</span></span><br><span class="line">sudo <span class="built_in">mv</span> /etc/apt/sources.list /etc/apt/sources.list.bk</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®é•œåƒæº</span></span><br><span class="line">sudo vim /etc/apt/sources.list</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ›´æ–°æº</span></span><br><span class="line">sudo apt update</span><br><span class="line"></span><br><span class="line"><span class="comment"># å‡çº§</span></span><br><span class="line">sudo apt dist-upgrade -y</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡å¯</span></span><br><span class="line">sudo reboot</span><br></pre></td></tr></table></figure>
<p>é•œåƒæºé…ç½®å¦‚ä¸‹ï¼š</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é»˜è®¤æ³¨é‡Šäº†æºç é•œåƒä»¥æé«˜ apt update é€Ÿåº¦ï¼Œå¦‚æœ‰éœ€è¦å¯è‡ªè¡Œå–æ¶ˆæ³¨é‡Š</span></span><br><span class="line">deb http://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse</span><br><span class="line"><span class="comment"># deb-src http://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse</span></span><br><span class="line">deb http://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse</span><br><span class="line"><span class="comment"># deb-src http://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse</span></span><br><span class="line">deb http://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse</span><br><span class="line"><span class="comment"># deb-src http://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse</span></span><br><span class="line">deb http://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse</span><br><span class="line"><span class="comment"># deb-src http://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>é…ç½®å…å¯†ç™»å½•</p>
<p>æ·»åŠ åŸŸåè§£æ /etc/hosts</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># local</span></span><br><span class="line">10.111.1.125 controller</span><br><span class="line"> </span><br><span class="line"><span class="comment"># openstack</span></span><br><span class="line">10.111.1.250 openstack01</span><br></pre></td></tr></table></figure>
<p>ç”Ÿæˆå¯†é’¥å¹¶æ‹·è´åˆ°ç›®æ ‡ä¸»æœº</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen</span><br><span class="line">ssh-copy-id -i /home/jck/.ssh/id_rsa.pub op1@openstack01</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>å®‰è£…ä¾èµ–</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ›´æ–°æº</span></span><br><span class="line">sudo apt update</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£… Python æ„å»ºä¾èµ–</span></span><br><span class="line">sudo apt install python3-dev libffi-dev gcc libssl-dev -y</span><br></pre></td></tr></table></figure>
<p>å®‰è£… <code>venv</code>ï¼Œåˆ›å»ºå¹¶ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£… venv</span></span><br><span class="line">sudo apt install python3-venv -y</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</span></span><br><span class="line"><span class="built_in">mkdir</span> code</span><br><span class="line">python -m venv ~/code</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ</span></span><br><span class="line"><span class="built_in">source</span> ~/code/bin/activate</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>å®‰è£… Kolla-Ansibleï¼ŒæŒ‡å®š Victoria ç‰ˆæœ¬</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£… Ansible</span></span><br><span class="line">pip install -U pip</span><br><span class="line">pip install <span class="string">&#x27;ansible&lt;3.0&#x27;</span></span><br><span class="line">pip install kolla-ansible</span><br><span class="line">pip install kolla</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸‹è½½æºç </span></span><br><span class="line"><span class="comment">#pip install &#x27;ansible&lt;2.10&#x27;</span></span><br><span class="line"><span class="comment">#git clone https://github.com/openstack/kolla -b stable/victoria</span></span><br><span class="line"><span class="comment">#git clone https://github.com/openstack/kolla-ansible -b stable/victoria</span></span><br><span class="line"><span class="comment"># å®‰è£…</span></span><br><span class="line"><span class="comment">#pip install ./kolla</span></span><br><span class="line"><span class="comment">#pip install ./kolla-ansible</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºç›®å½•</span></span><br><span class="line">sudo <span class="built_in">mkdir</span> -p /etc/kolla</span><br><span class="line"></span><br><span class="line"><span class="comment"># æƒé™è®¾ç½®</span></span><br><span class="line">sudo <span class="built_in">chown</span> <span class="variable">$USER</span>:<span class="variable">$USER</span> /etc/kolla</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‹·è´é…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="comment">#cp -r kolla-ansible/etc/kolla/* /etc/kolla</span></span><br><span class="line"><span class="comment">#cp kolla-ansible/ansible/inventory/* .</span></span><br><span class="line"><span class="built_in">cp</span> -r /home/jck/code/share/kolla-ansible/etc_examples/kolla/* /etc/kolla</span><br><span class="line"><span class="built_in">cp</span> /home/jck/code/share/kolla-ansible/ansible/inventory/* .</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>é…ç½® Ansible</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»º</span></span><br><span class="line">sudo <span class="built_in">mkdir</span> /etc/ansible</span><br><span class="line">sudo vim /etc/ansible/ansible.cfg</span><br></pre></td></tr></table></figure>
<p>é…ç½®å¦‚ä¸‹</p>
 <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[defaults]</span><br><span class="line">host_key_checking=False</span><br><span class="line">pipelining=True</span><br><span class="line">forks=100</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>å®‰è£… Docker å’Œ docker-compose</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># docker</span></span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install -y \</span><br><span class="line">    apt-transport-https \</span><br><span class="line">    ca-certificates \</span><br><span class="line">    curl \</span><br><span class="line">    gnupg \</span><br><span class="line">    lsb-release</span><br><span class="line"> </span><br><span class="line">curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg</span><br><span class="line"> </span><br><span class="line"><span class="built_in">echo</span> \</span><br><span class="line">  <span class="string">&quot;deb [arch=amd64 signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/ubuntu \</span></span><br><span class="line"><span class="string">  <span class="subst">$(lsb_release -cs)</span> stable&quot;</span> | sudo <span class="built_in">tee</span> /etc/apt/sources.list.d/docker.list &gt; /dev/null</span><br><span class="line">   </span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install -y docker-ce docker-ce-cli containerd.io</span><br><span class="line"> </span><br><span class="line"><span class="comment"># ç”¨æˆ·ç»„è®¾ç½®</span></span><br><span class="line">sudo groupadd docker</span><br><span class="line">sudo usermod -aG docker <span class="variable">$USER</span></span><br><span class="line">newgrp docker</span><br><span class="line"> </span><br><span class="line"><span class="comment"># å¼€æœºå¯åŠ¨</span></span><br><span class="line">sudo systemctl <span class="built_in">enable</span> docker.service</span><br><span class="line">sudo systemctl <span class="built_in">enable</span> containerd.service</span><br><span class="line"> </span><br><span class="line"><span class="comment"># docker-compose</span></span><br><span class="line">sudo curl -L <span class="string">&quot;https://github.com/docker/compose/releases/download/1.29.2/docker-compose-<span class="subst">$(uname -s)</span>-<span class="subst">$(uname -m)</span>&quot;</span> -o /usr/local/bin/docker-compose</span><br><span class="line"> </span><br><span class="line">sudo <span class="built_in">chmod</span> +x /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure>
<p>åˆ›å»ºé…ç½®æ–‡ä»¶ /etc/docker/daemon.jsonï¼Œè®¾ç½®å›½å†…é•œåƒæº</p>
 <figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;registry-mirrors&quot;:</span> [</span><br><span class="line">        <span class="string">&quot;http://hub-mirror.c.163.com&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">&quot;insecure-registries&quot;:</span> [</span><br><span class="line">        <span class="string">&quot;10.111.1.125:5000&quot;</span> <span class="comment"># æŒ‡å‘ä¹‹åéƒ¨ç½²çš„æœ¬åœ°é•œåƒä»“åº“</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">&quot;iptables&quot;:</span> <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">&quot;log-opts&quot;:</span> &#123;</span><br><span class="line">        <span class="attr">&quot;max-file&quot;:</span> <span class="string">&quot;5&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;max-size&quot;:</span> <span class="string">&quot;50m&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é‡å¯ docker æœåŠ¡</p>
 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo service docker restart</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="registry-registry-ui">registry + registry-ui</h2>
<p>ç›´æ¥ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://github.com/Joxit/docker-registry-ui">Joxit/docker-registry-ui</a> ä»“åº“çš„ç¤ºä¾‹é…ç½®ï¼Œåœ¨æœ¬åœ°éƒ¨ç½² registry å’Œ registry-ui</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…‹éš†ä»“åº“</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/Joxit/docker-registry-ui.git</span><br><span class="line"><span class="built_in">cd</span> docker-registry-ui/examples/ui-as-standalone</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹é…ç½® localhost -&gt; 10.111.1.125</span></span><br><span class="line">vim simple.yml</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹é…ç½® Access-Control-Allow-Origin: [&#x27;*&#x27;]</span></span><br><span class="line">vim registry-config/simple.yml</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿è¡Œå®¹å™¨</span></span><br><span class="line">docker-compose -f simple.yml up -d</span><br></pre></td></tr></table></figure>
<p><em>PSï¼šç”¨å®Œä¹‹åæ‰å‘ç°å®Œå…¨å¯ä»¥æ­ä¸ª harbor ç”¨â€¦</em></p>
<p><img src="https://i.loli.net/2021/08/31/VrvtLg7TQ1YxwcH.png" alt=""></p>
<h2 id="æ„å»ºåŸºç¡€é•œåƒ">æ„å»ºåŸºç¡€é•œåƒ</h2>
<p>ç¼–å†™ ubuntu 20.04 åŸºç¡€é•œåƒ Dockerfileï¼Œæ›¿æ¢ source æºå’Œ pip æºï¼Œ</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu:<span class="number">20.04</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ADD</span><span class="language-bash"> pip.conf /etc/pip.conf</span></span><br><span class="line"><span class="keyword">ADD</span><span class="language-bash"> sources.list /etc/apt/sources.list</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt-get update</span></span><br></pre></td></tr></table></figure>
<p>æ›¿æ¢ pip æºï¼ˆpip.confï¼‰</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[global]</span></span><br><span class="line"><span class="attr">timeout</span> = <span class="number">6000</span></span><br><span class="line"><span class="attr">index-url</span> = http://mirrors.aliyun.com/pypi/simple/</span><br><span class="line"><span class="attr">trusted-host</span> = mirrors.aliyun.com</span><br></pre></td></tr></table></figure>
<p>æ›¿æ¢ sources.listï¼Œæ³¨æ„è¿™é‡Œå†™çš„æ˜¯ <code>http</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é»˜è®¤æ³¨é‡Šäº†æºç é•œåƒä»¥æé«˜ apt update é€Ÿåº¦ï¼Œå¦‚æœ‰éœ€è¦å¯è‡ªè¡Œå–æ¶ˆæ³¨é‡Š</span></span><br><span class="line">deb http://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse</span><br><span class="line"><span class="comment"># deb-src http://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse</span></span><br><span class="line">deb http://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse</span><br><span class="line"><span class="comment"># deb-src http://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse</span></span><br><span class="line">deb http://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse</span><br><span class="line"><span class="comment"># deb-src http://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse</span></span><br><span class="line">deb http://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse</span><br><span class="line"><span class="comment"># deb-src http://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-security main restricted universe multiverse</span></span><br></pre></td></tr></table></figure>
<p>æ„å»ºé•œåƒå¹¶å‘å¸ƒåˆ° dockerhub</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ„å»ºé•œåƒï¼Œ--network=host é¿å…åŸŸåè§£æé”™è¯¯</span></span><br><span class="line">docker build --network=host -t lycanj/kolla_ansible-base_image-ubuntu:20.04 .</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç™»å½• dockerhub</span></span><br><span class="line">docker login</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸Šä¼ åˆ° dockerhub</span></span><br><span class="line">docker push lycanj/kolla_ansible-base_image-ubuntu:20.04</span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2021/08/31/4KVtSW6Bx5NYaeh.jpg" alt=""></p>
<h2 id="æ„å»ºç»„ä»¶é•œåƒ">æ„å»ºç»„ä»¶é•œåƒ</h2>
<p>ä¸‹è½½ Victoria ç»„ä»¶æºç </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/openstack/keystone.git --branch stable/victoria --single-branch</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/openstack/glance.git --branch stable/victoria --single-branch</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/openstack/nova.git --branch stable/victoria --single-branch</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/openstack/neutron.git --branch stable/victoria --single-branch</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/openstack/heat.git --branch stable/victoria --single-branch</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨ kolla-build ç”Ÿæˆé•œåƒï¼Œå¹¶ push åˆ°æœ¬åœ°ä»“åº“ã€‚ä¸‹è½½ kolla ä»“åº“å¹¶ä½¿ç”¨ tox ç”Ÿæˆé…ç½®æ–‡ä»¶ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…‹éš†ä»“åº“</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/openstack/kolla.git --branch stable/victoria</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£… toxï¼ˆè™šæ‹Ÿç¯å¢ƒä¸­ï¼‰</span></span><br><span class="line">pip install tox</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆé…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="built_in">cd</span> kolla</span><br><span class="line">tox -e genconfig</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹é…ç½®æ–‡ä»¶</span></span><br><span class="line">vim kolla/etc/kolla/kolla-build.conf</span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<ul>
<li>æŒ‡å®šåŸºç¡€ ubuntu é•œåƒ</li>
<li>ä½¿ç”¨æºç æ„å»ºé•œåƒ</li>
</ul>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[DEFAULT]</span></span><br><span class="line"><span class="comment"># The distro type of the base image. (string value)</span></span><br><span class="line"><span class="comment"># Possible values:</span></span><br><span class="line"><span class="comment"># centos - &lt;No description provided&gt;</span></span><br><span class="line"><span class="comment"># rhel - &lt;No description provided&gt;</span></span><br><span class="line"><span class="comment"># ubuntu - &lt;No description provided&gt;</span></span><br><span class="line"><span class="comment"># debian - &lt;No description provided&gt;</span></span><br><span class="line"><span class="attr">base</span> = ubuntu</span><br><span class="line"></span><br><span class="line"><span class="comment"># The base image name. Default is the same with base. (string value)</span></span><br><span class="line"><span class="attr">base_image</span> = lycanj/kolla_ansible-base_image-ubuntu</span><br><span class="line"></span><br><span class="line"><span class="comment"># The Docker namespace name (string value)</span></span><br><span class="line"><span class="comment">#namespace = kolla</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The network mode for Docker build. Example: host (string value)</span></span><br><span class="line"><span class="attr">network_mode</span> = host</span><br><span class="line"></span><br><span class="line"><span class="comment"># Push images after building (boolean value)</span></span><br><span class="line"><span class="attr">push</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The docker registry host. The default registry host is Docker Hub</span></span><br><span class="line"><span class="comment"># (string value)</span></span><br><span class="line"><span class="attr">registry</span> = <span class="number">10.111</span>.<span class="number">1.125</span>:<span class="number">5000</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># The method of the OpenStack install. (string value)</span></span><br><span class="line"><span class="comment"># Possible values:</span></span><br><span class="line"><span class="comment"># binary - &lt;No description provided&gt;</span></span><br><span class="line"><span class="comment"># source - &lt;No description provided&gt;</span></span><br><span class="line"><span class="comment"># rdo - &lt;No description provided&gt;</span></span><br><span class="line"><span class="comment"># rhos - &lt;No description provided&gt;</span></span><br><span class="line"><span class="attr">install_type</span> = source</span><br><span class="line"></span><br><span class="line"><span class="comment"># The Docker tag (string value)</span></span><br><span class="line"><span class="attr">tag</span> = victoria</span><br><span class="line"></span><br><span class="line"><span class="comment"># OpenStack release for building kolla-toolbox (string value)</span></span><br><span class="line"><span class="attr">openstack_release</span> = victoria</span><br><span class="line"></span><br><span class="line"><span class="comment"># Branch for source images (string value)</span></span><br><span class="line"><span class="attr">openstack_branch</span> = victoria-stable</span><br><span class="line"></span><br><span class="line"><span class="comment"># Content of the maintainer label (string value)</span></span><br><span class="line"><span class="comment">#maintainer = Kolla Project (https://launchpad.net/kolla)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Path to custom sources.list (string value)</span></span><br><span class="line"><span class="comment">#apt_sources_list = &lt;None&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="section">[keystone-base]</span></span><br><span class="line"><span class="comment"># Source location type (string value)</span></span><br><span class="line"><span class="comment"># Possible values:</span></span><br><span class="line"><span class="comment"># local - &lt;No description provided&gt;</span></span><br><span class="line"><span class="comment"># git - &lt;No description provided&gt;</span></span><br><span class="line"><span class="comment"># url - &lt;No description provided&gt;</span></span><br><span class="line"><span class="attr">type</span> = local</span><br><span class="line"></span><br><span class="line"><span class="comment"># The location for source install (string value)</span></span><br><span class="line"><span class="attr">location</span> = /home/jck/keystone</span><br><span class="line"></span><br><span class="line"><span class="section">[glance-base]</span></span><br><span class="line"><span class="attr">type</span> = local</span><br><span class="line"><span class="attr">location</span> = /home/jck/glance</span><br><span class="line"></span><br><span class="line"><span class="section">[nova-base]</span></span><br><span class="line"><span class="attr">type</span> = local</span><br><span class="line"><span class="attr">location</span> = /home/jck/nova</span><br><span class="line"></span><br><span class="line"><span class="section">[neutron-base]</span></span><br><span class="line"><span class="attr">type</span> = local</span><br><span class="line"><span class="attr">location</span> = /home/jck/neutron</span><br><span class="line"></span><br><span class="line"><span class="section">[heat-base]</span></span><br><span class="line"><span class="attr">type</span> = local</span><br><span class="line"><span class="attr">location</span> = /home/jck/heat</span><br></pre></td></tr></table></figure>
<p>ç„¶åæŒ‡å®šè¯¥é…ç½®æ–‡ä»¶æ„å»ºé•œåƒ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kolla-build --config-file ~/kolla/etc/kolla/kolla-build.conf</span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2021/08/31/XHqEmYQgOL2lBU7.png" alt=""></p>
<h2 id="éƒ¨ç½²-OpenStack">éƒ¨ç½² OpenStack</h2>
<p>ä¿®æ”¹ multinode é…ç½®ï¼Œç¼–è¾‘æœ€å‰é¢çš„å‡ é¡¹ï¼Œå°†ç›®æ ‡ä¸»æœºè®¾ç½®ä¸º <code>openstack01</code></p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[control]</span></span><br><span class="line">openstack01       <span class="attr">ansible_user</span>=op1</span><br><span class="line"></span><br><span class="line"><span class="section">[network]</span></span><br><span class="line">openstack01       <span class="attr">ansible_user</span>=op1</span><br><span class="line"></span><br><span class="line"><span class="section">[compute]</span></span><br><span class="line">openstack01       <span class="attr">ansible_user</span>=op1</span><br><span class="line"></span><br><span class="line"><span class="section">[monitoring]</span></span><br><span class="line">openstack01       <span class="attr">ansible_user</span>=op1</span><br><span class="line"></span><br><span class="line"><span class="section">[storage]</span></span><br><span class="line">openstack01       <span class="attr">ansible_user</span>=op1</span><br><span class="line"></span><br><span class="line"><span class="section">[deployment]</span></span><br><span class="line">localhost       <span class="attr">ansible_connection</span>=local</span><br></pre></td></tr></table></figure>
<p>æµ‹è¯•æ˜¯å¦å¯è¾¾</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible -i ~/multinode all -m ping</span><br></pre></td></tr></table></figure>
<p>å‚ç…§åŸå§‹çš„é…ç½®ç¼–å†™ç²¾ç®€é…ç½®ï¼ˆåªè®¾ç½®ç”¨åˆ°çš„é€‰é¡¹ï¼‰</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç”Ÿæˆçš„ç¤ºä¾‹é…ç½®æ–‡ä»¶</span></span><br><span class="line">/etc/kolla/globals.yml</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºç²¾ç®€é…ç½®æ–‡ä»¶</span></span><br><span class="line">vim ~/globals.yml </span><br></pre></td></tr></table></figure>
<p>å†…å®¹å¦‚ä¸‹ï¼š</p>
<ul>
<li>æŒ‡å®šä½¿ç”¨æºç æ„å»ºçš„é•œåƒ <code>openstack_tag=victoria</code></li>
</ul>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Valid options are [&#x27;centos&#x27;, &#x27;debian&#x27;, &#x27;rhel&#x27;, &#x27;ubuntu&#x27;]</span></span><br><span class="line">kolla_base_distro: &quot;ubuntu&quot;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Valid options are [ binary, source ]</span></span><br><span class="line">kolla_install_type: &quot;source&quot;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Do not override this unless you know what you are doing.</span></span><br><span class="line">openstack_release: &quot;victoria&quot;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Docker image tag used by default.</span></span><br><span class="line">openstack_tag: &quot;victoria&quot;</span><br><span class="line"></span><br><span class="line"><span class="comment"># This should be a VIP, an unused IP on your network that will float between</span></span><br><span class="line"><span class="comment"># the hosts running keepalived for high-availability. If you want to run an</span></span><br><span class="line"><span class="comment"># All-In-One without haproxy and keepalived, you can set enable_haproxy to no</span></span><br><span class="line"><span class="comment"># in &quot;OpenStack options&quot; section, and set this value to the IP of your</span></span><br><span class="line"><span class="comment"># &#x27;network_interface&#x27; as set in the Networking section below.</span></span><br><span class="line">kolla_internal_vip_address: &quot;10.111.1.251&quot; <span class="comment"># å’Œ network_interface åŒç½‘æ®µ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Custom docker registry settings:</span></span><br><span class="line">docker_registry: 10.111.1.125:5000</span><br><span class="line"></span><br><span class="line"><span class="comment"># Namespace of images:</span></span><br><span class="line"><span class="comment">#docker_namespace: &quot;kolla&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># This interface is what all your api services will be bound to by default.</span></span><br><span class="line"><span class="comment"># Additionally, all vxlan/tunnel and storage network traffic will go over this</span></span><br><span class="line"><span class="comment"># interface by default. This interface must contain an IP address.</span></span><br><span class="line"><span class="comment"># It is possible for hosts to have non-matching names of interfaces - these can</span></span><br><span class="line"><span class="comment"># be set in an inventory file per host or per group or stored separately, see</span></span><br><span class="line"><span class="comment">#     http://docs.ansible.com/ansible/intro_inventory.html</span></span><br><span class="line"><span class="comment"># Yet another way to workaround the naming problem is to create a bond for the</span></span><br><span class="line"><span class="comment"># interface on all hosts and give the bond name here. Similar strategy can be</span></span><br><span class="line"><span class="comment"># followed for other types of interfaces.</span></span><br><span class="line">network_interface: &quot;ens160&quot;</span><br><span class="line"></span><br><span class="line"><span class="comment"># This is the raw interface given to neutron as its external network port. Even</span></span><br><span class="line"><span class="comment"># though an IP address can exist on this interface, it will be unusable in most</span></span><br><span class="line"><span class="comment"># configurations. It is recommended this interface not be configured with any IP</span></span><br><span class="line"><span class="comment"># addresses for that reason.</span></span><br><span class="line">neutron_external_interface: &quot;ens192&quot; <span class="comment"># ç©ºé—²ç½‘å¡</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Valid options are [ qemu, kvm, vmware ]</span></span><br><span class="line">nova_compute_virt_type: &quot;qemu&quot;</span><br></pre></td></tr></table></figure>
<p>ç”Ÿæˆéšæœºå¯†ç ï¼Œå¹¶æ‹·è´åˆ°å½“å‰ç›®å½•</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç”Ÿæˆå¯†ç </span></span><br><span class="line">kolla-genpwd</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‹·è´</span></span><br><span class="line"><span class="built_in">cp</span> /etc/kolla/passwords.yml ~/passwords.yml</span><br></pre></td></tr></table></figure>
<p>éƒ¨ç½² OpenStack</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># bootstrap</span></span><br><span class="line">kolla-ansible -i ~/multinode --configdir ~ bootstrap-servers</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€æŸ¥</span></span><br><span class="line">kolla-ansible -i ~/multinode --configdir ~ prechecks</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‹‰å–é•œåƒ</span></span><br><span class="line"><span class="comment"># kolla-ansible -i ~/multinode --configdir ~ pull</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># éƒ¨ç½²</span></span><br><span class="line">kolla-ansible -i ~/multinode --configdir ~ deploy</span><br><span class="line"><span class="comment"># kolla-ansible -i ~/multinode --configdir ~ reconfigure</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># éƒ¨ç½²å¤±è´¥</span></span><br><span class="line">kolla-ansible -i ~/multinode --configdir ~ destroy --yes-i-really-really-mean-it</span><br></pre></td></tr></table></figure>
<h1>éªŒè¯</h1>
<p>åœ¨éƒ¨ç½²èŠ‚ç‚¹ä¸Šæ‰§è¡Œä»¥ä¸‹æŒ‡ä»¤ï¼Œç”Ÿæˆèº«ä»½è®¤è¯æ–‡ä»¶</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£… OpenStack CLI å®¢æˆ·ç«¯</span></span><br><span class="line">pip install python-openstackclient</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆè®¤è¯æ–‡ä»¶</span></span><br><span class="line">kolla-ansible -i ~/multinode --configdir ~ post-deploy</span><br><span class="line"></span><br><span class="line"><span class="comment"># èº«ä»½è®¤è¯</span></span><br><span class="line">. ~/admin-openrc.sh</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨ Kolla-Ansible è‡ªå¸¦çš„è„šæœ¬æµ‹è¯•</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‰§è¡Œè„šæœ¬ç”Ÿæˆç¤ºä¾‹ç½‘ç»œã€é•œåƒã€å®ä¾‹ç­‰</span></span><br><span class="line">~/code/share/kolla-ansible/init-runonce</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºå®ä¾‹</span></span><br><span class="line">openstack server create \</span><br><span class="line">    --image cirros \</span><br><span class="line">    --flavor m1.tiny \</span><br><span class="line">    --key-name mykey \</span><br><span class="line">    --network demo-net \</span><br><span class="line">    demo1</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¡®è®¤å®ä¾‹çŠ¶æ€</span></span><br><span class="line">openstack server list</span><br></pre></td></tr></table></figure>
<img src="https://i.loli.net/2021/08/31/RYBPvwHzVpFrm84.jpg" width="80%">
<p>ç›´æ¥è®¿é—® <a target="_blank" rel="noopener" href="http://10.111.1.250">http://10.111.1.250</a> å¯ä»¥çœ‹åˆ°åˆšæ‰åˆ›å»ºçš„å®ä¾‹æ‰€å ç”¨çš„èµ„æº</p>
<ul>
<li>ç”¨æˆ·åå¯†ç æŸ¥çœ‹ <a target="_blank" rel="noopener" href="http://admin-openrc.sh">admin-openrc.sh</a> æ–‡ä»¶å³å¯</li>
</ul>
<p><img src="https://i.loli.net/2021/08/31/QFzHXR43DqjsdwO.png" alt=""></p>
<h1>å‚é˜…</h1>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/Joxit/docker-registry-ui">Joxit/docker-registry-ui</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/huangxincheng/p/11131623.html">8å¤©å…¥é—¨dockerç³»åˆ— â€”â€” ç¬¬å…­å¤© æ­å»ºè‡ªå·±çš„ç§æœ‰é•œåƒä»“åº“Registry</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.docker.com/registry/configuration/">Configuring a registry</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.openstack.org/kolla/latest/admin/image-building.html">Building Container Images</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.openstack.org/kolla-ansible/latest/user/quickstart.html">Kolla-Ansible - Quick Start</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.openstack.org/kolla/latest/contributor/genconfig.html">Generating kolla-build.conf</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.openstack.org/kolla-ansible/latest/user/security.html">Kolla Security</a></li>
<li><a target="_blank" rel="noopener" href="https://timonweb.com/devops/how-to-enable-passwordless-sudo-for-a-specific-user-in-linux/">How To Enable Passwordless Sudo For A Specific User in Linux</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_28513801/article/details/116035363">ä½¿ç”¨kolla-ansibleéƒ¨ç½²å¤šèŠ‚ç‚¹OpenStack(Tç‰ˆ)åŠå¯¹æ¥Ceph</a></li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a target="_blank" rel="noopener" href="https://github.com/jckling">Jckling</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://jckling.github.io/2021/08/31/OpenStack/Kolla-Ansible%20%E5%A4%9A%E6%9C%BA%E9%83%A8%E7%BD%B2/">https://jckling.github.io/2021/08/31/OpenStack/Kolla-Ansible%20%E5%A4%9A%E6%9C%BA%E9%83%A8%E7%BD%B2/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥æº <a href="https://jckling.github.io" target="_blank">Jckling's Blog</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Python/">Python</a><a class="post-meta__tags" href="/tags/Ubuntu/">Ubuntu</a></div><div class="post-share"><div class="social-share" data-image="https://i.loli.net/2021/06/14/O6DgG2AzyvJfTso.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="ads-wrap"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-1035234274961147" data-ad-slot="3100725659" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2021/09/08/Security/%E7%99%BE%E5%BA%A6%20OpenRASP%20%E6%9E%B6%E6%9E%84%E5%88%86%E6%9E%90/" title="ç™¾åº¦ OpenRASP ç»„æˆåˆ†æ"><img class="cover" src="https://s2.loli.net/2022/03/10/iwzyYvM81fpWkUn.png" onerror="onerror=null;src='/img/jckling/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">ä¸Šä¸€ç¯‡</div><div class="info-item-2">ç™¾åº¦ OpenRASP ç»„æˆåˆ†æ</div></div><div class="info-2"><div class="info-item-1">æ¢³ç† OpenRASP çš„å„ä¸ªç»„æˆéƒ¨åˆ†ï¼šJava Agent æ’æ¡©ã€JS æ’ä»¶æ£€æµ‹ã€ç®¡ç†åå°ã€IAST æ‰«æå™¨ã€‚</div></div></div></a><a class="pagination-related" href="/2021/08/23/Other/Python%20%E9%A1%B9%E7%9B%AE%E6%89%93%E5%8C%85%E5%B9%B6%E5%8F%91%E5%B8%83%E5%88%B0%E7%A7%81%E6%9C%89%20PyPI%20%E6%9C%8D%E5%8A%A1%E5%99%A8/" title="Python é¡¹ç›®æ‰“åŒ…å¹¶å‘å¸ƒåˆ°ç§æœ‰ PyPI æœåŠ¡å™¨"><img class="cover" src="https://i.loli.net/2021/06/14/f3EiKbmVUTQyPSc.png" onerror="onerror=null;src='/img/jckling/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">ä¸‹ä¸€ç¯‡</div><div class="info-item-2">Python é¡¹ç›®æ‰“åŒ…å¹¶å‘å¸ƒåˆ°ç§æœ‰ PyPI æœåŠ¡å™¨</div></div><div class="info-2"><div class="info-item-1">ä½¿ç”¨ pypiserver æ­å»ºæœ¬åœ°æœåŠ¡å™¨</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2021/06/14/OpenStack/Kolla-Ansible%20%E6%9C%AC%E5%9C%B0%E4%BB%93%E5%BA%93%E9%83%A8%E7%BD%B2/" title="Kolla-Ansible æœ¬åœ°ä»“åº“éƒ¨ç½²"><img class="cover" src="https://i.loli.net/2021/06/14/O6DgG2AzyvJfTso.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2021-06-14</div><div class="info-item-2">Kolla-Ansible æœ¬åœ°ä»“åº“éƒ¨ç½²</div></div><div class="info-2"><div class="info-item-1">Ubuntu 20.04 + OpenStack (Victoria)</div></div></div></a><a class="pagination-related" href="/2021/05/31/OpenStack/OpenStack%20%E5%8D%95%E6%9C%BA%E9%83%A8%E7%BD%B2%20%E2%80%94%E2%80%94%20Kolla-Ansible/" title="OpenStack å•æœºéƒ¨ç½² â€”â€” Kolla-Ansible"><img class="cover" src="https://i.loli.net/2021/06/14/O6DgG2AzyvJfTso.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2021-05-31</div><div class="info-item-2">OpenStack å•æœºéƒ¨ç½² â€”â€” Kolla-Ansible</div></div><div class="info-2"><div class="info-item-1">Ubuntu 20.04 + OpenStack (Victoria)</div></div></div></a><a class="pagination-related" href="/2021/05/13/OpenStack/Ubuntu18.04%20%E6%BA%90%E7%A0%81%E5%AE%89%E8%A3%85%20Glance%20(Victoria)/" title="Ubuntu 18.04 æºç å®‰è£… Glance (Victoria)"><img class="cover" src="https://i.loli.net/2021/06/14/O6DgG2AzyvJfTso.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2021-05-13</div><div class="info-item-2">Ubuntu 18.04 æºç å®‰è£… Glance (Victoria)</div></div><div class="info-2"><div class="info-item-1">è®°å½•éƒ¨ç½²æµç¨‹</div></div></div></a><a class="pagination-related" href="/2021/05/13/OpenStack/Ubuntu18.04%20%E6%BA%90%E7%A0%81%E5%AE%89%E8%A3%85%20Keystone%20(Victoria)/" title="Ubuntu 18.04 æºç å®‰è£… Keystone (Victoria)"><img class="cover" src="https://i.loli.net/2021/06/14/O6DgG2AzyvJfTso.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2021-05-13</div><div class="info-item-2">Ubuntu 18.04 æºç å®‰è£… Keystone (Victoria)</div></div><div class="info-2"><div class="info-item-1">è®°å½•éƒ¨ç½²æµç¨‹</div></div></div></a><a class="pagination-related" href="/2021/05/13/OpenStack/Ubuntu18.04%20%E6%BA%90%E7%A0%81%E5%AE%89%E8%A3%85%20Nova%20(Victoria)/" title="Ubuntu 18.04 æºç å®‰è£… Placement + Nova (Victoria)"><img class="cover" src="https://i.loli.net/2021/06/14/O6DgG2AzyvJfTso.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2021-05-13</div><div class="info-item-2">Ubuntu 18.04 æºç å®‰è£… Placement + Nova (Victoria)</div></div><div class="info-2"><div class="info-item-1">è®°å½•éƒ¨ç½²æµç¨‹</div></div></div></a><a class="pagination-related" href="/2021/05/31/OpenStack/Ubuntu20.04%20%E6%BA%90%E7%A0%81%E5%AE%89%E8%A3%85%20nova-compute%20(Victoria)/" title="Ubuntu 20.04 è®¡ç®—èŠ‚ç‚¹æºç å®‰è£… nova-compute (Victoria)"><img class="cover" src="https://i.loli.net/2021/06/14/O6DgG2AzyvJfTso.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2021-05-31</div><div class="info-item-2">Ubuntu 20.04 è®¡ç®—èŠ‚ç‚¹æºç å®‰è£… nova-compute (Victoria)</div></div><div class="info-2"><div class="info-item-1">è®°å½•éƒ¨ç½²æµç¨‹</div></div></div></a><a class="pagination-related" href="/2021/11/05/Jaeger/CVE-2020-12691%20%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E7%9B%B8%E5%85%B3%E4%BF%A1%E6%81%AF%E8%BF%BD%E8%B8%AA/" title="CVE-2020-12691 æ¼æ´åˆ©ç”¨ç›¸å…³ä¿¡æ¯è¿½è¸ª"><img class="cover" src="https://i.loli.net/2021/06/14/bk5UlhqE4DZJfYu.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2021-11-05</div><div class="info-item-2">CVE-2020-12691 æ¼æ´åˆ©ç”¨ç›¸å…³ä¿¡æ¯è¿½è¸ª</div></div><div class="info-2"><div class="info-item-1">ä½¿ç”¨ Jaeger å¯¹ Keystone è¿›è¡Œè¿½è¸ª</div></div></div></a><a class="pagination-related" href="/2021/05/10/Jaeger/Jaeger%20+%20Elasticsearch%20+%20Kibana/" title="ä½¿ç”¨ Docker éƒ¨ç½² Jaeger + Elasticsearch + Kibana"><img class="cover" src="https://i.loli.net/2021/06/14/bk5UlhqE4DZJfYu.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2021-05-10</div><div class="info-item-2">ä½¿ç”¨ Docker éƒ¨ç½² Jaeger + Elasticsearch + Kibana</div></div><div class="info-2"><div class="info-item-1">ä½¿ç”¨ Elasticsearch ä½œä¸ºæŒä¹…åŒ–å­˜å‚¨ï¼Œéƒ¨ç½² all-in-one é•œåƒ/å•ç‹¬éƒ¨ç½² Jaeger ç»„ä»¶ï¼›elasticdump å¯¼å‡ºæ•°æ®ï¼ŒKibana å¯è§†åŒ–è¿½è¸ªä¿¡æ¯ã€‚</div></div></div></a><a class="pagination-related" href="/2021/04/02/Jaeger/%E5%85%A8%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA%E4%B8%8E%20Jaeger%20%E5%85%A5%E9%97%A8/" title="å…¨é“¾è·¯è¿½è¸ªä¸ Jaeger å…¥é—¨"><img class="cover" src="https://i.loli.net/2021/06/14/bk5UlhqE4DZJfYu.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2021-04-02</div><div class="info-item-2">å…¨é“¾è·¯è¿½è¸ªä¸ Jaeger å…¥é—¨</div></div><div class="info-2"><div class="info-item-1">å…¨é“¾è·¯è¿½è¸ªåŠ OpenTracing æ¦‚å¿µä»‹ç»ï¼ŒJaeger Python å…¥é—¨å®éªŒ</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/jckling/avatar.jpg" onerror="this.onerror=null;this.src='/img/jckling/avatar_404.png'" alt="avatar"/></div><div class="author-info-name">Jckling</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">126</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">49</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/jckling"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">æ¬¢è¿è®¿é—®æœ¬ç«™ ğŸ¥³ <br/>è¯„è®ºéœ€è¦å®¡æ ¸ï¼Œè¯·ä¸è¦é‡å¤æäº¤~</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">æµ‹è¯•ç¯å¢ƒæ­å»º</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">2.</span> <span class="toc-text">æ§åˆ¶èŠ‚ç‚¹</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">3.</span> <span class="toc-text">éƒ¨ç½²èŠ‚ç‚¹</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="toc-number">3.1.</span> <span class="toc-text">ç¯å¢ƒå‡†å¤‡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#registry-registry-ui"><span class="toc-number">3.2.</span> <span class="toc-text">registry + registry-ui</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA%E5%9F%BA%E7%A1%80%E9%95%9C%E5%83%8F"><span class="toc-number">3.3.</span> <span class="toc-text">æ„å»ºåŸºç¡€é•œåƒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%84%E5%BB%BA%E7%BB%84%E4%BB%B6%E9%95%9C%E5%83%8F"><span class="toc-number">3.4.</span> <span class="toc-text">æ„å»ºç»„ä»¶é•œåƒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2-OpenStack"><span class="toc-number">3.5.</span> <span class="toc-text">éƒ¨ç½² OpenStack</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">4.</span> <span class="toc-text">éªŒè¯</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">5.</span> <span class="toc-text">å‚é˜…</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/08/11/Notes/openwebui+deepseek/" title="æœ¬åœ°éƒ¨ç½² Open WebUI ä½¿ç”¨ DeepSeek/Qwen"><img src="https://s2.loli.net/2025/07/15/XnLZaMF9gipcfGQ.jpg" onerror="this.onerror=null;this.src='/img/jckling/404.jpg'" alt="æœ¬åœ°éƒ¨ç½² Open WebUI ä½¿ç”¨ DeepSeek/Qwen"/></a><div class="content"><a class="title" href="/2025/08/11/Notes/openwebui+deepseek/" title="æœ¬åœ°éƒ¨ç½² Open WebUI ä½¿ç”¨ DeepSeek/Qwen">æœ¬åœ°éƒ¨ç½² Open WebUI ä½¿ç”¨ DeepSeek/Qwen</a><time datetime="2025-08-11T02:57:10.000Z" title="å‘è¡¨äº 2025-08-11 10:57:10">2025-08-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/03/Notes/qwen+vscode/" title="Qwen3-Coder æ¥å…¥ VS Code"><img src="https://qianwen-res.oss-cn-beijing.aliyuncs.com/Qwen3-Coder/qwen3-coder-main.jpg" onerror="this.onerror=null;this.src='/img/jckling/404.jpg'" alt="Qwen3-Coder æ¥å…¥ VS Code"/></a><div class="content"><a class="title" href="/2025/08/03/Notes/qwen+vscode/" title="Qwen3-Coder æ¥å…¥ VS Code">Qwen3-Coder æ¥å…¥ VS Code</a><time datetime="2025-08-03T13:35:43.000Z" title="å‘è¡¨äº 2025-08-03 21:35:43">2025-08-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/02/24/Other/NVIDIA%20Omniverse%20Audio%20%E7%B3%BB%E5%88%97%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/" title="NVIDIA Omniverse Audio ç³»åˆ—å·¥å…·ä½¿ç”¨"><img src="https://www.nvidia.cn/content/dam/en-zz/Solutions/about-nvidia/logo-and-brand/02-nvidia-logo-color-blk-500x200-4c25-p@2x.png" onerror="this.onerror=null;this.src='/img/jckling/404.jpg'" alt="NVIDIA Omniverse Audio ç³»åˆ—å·¥å…·ä½¿ç”¨"/></a><div class="content"><a class="title" href="/2024/02/24/Other/NVIDIA%20Omniverse%20Audio%20%E7%B3%BB%E5%88%97%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/" title="NVIDIA Omniverse Audio ç³»åˆ—å·¥å…·ä½¿ç”¨">NVIDIA Omniverse Audio ç³»åˆ—å·¥å…·ä½¿ç”¨</a><time datetime="2024-02-24T04:25:45.000Z" title="å‘è¡¨äº 2024-02-24 12:25:45">2024-02-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/01/24/Other/%E6%90%AD%E5%BB%BA%E6%9C%AC%E5%9C%B0%20Gitea%20Actions/" title="æ­å»ºæœ¬åœ° Gitea Actions"><img src="https://about.gitea.com/gitea-text.svg" onerror="this.onerror=null;this.src='/img/jckling/404.jpg'" alt="æ­å»ºæœ¬åœ° Gitea Actions"/></a><div class="content"><a class="title" href="/2024/01/24/Other/%E6%90%AD%E5%BB%BA%E6%9C%AC%E5%9C%B0%20Gitea%20Actions/" title="æ­å»ºæœ¬åœ° Gitea Actions">æ­å»ºæœ¬åœ° Gitea Actions</a><time datetime="2024-01-24T09:02:46.000Z" title="å‘è¡¨äº 2024-01-24 17:02:46">2024-01-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/12/12/Notes/%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93/" title="å·¥ä½œæ€»ç»“"><img src="https://s2.loli.net/2024/01/06/aDmdihO2fwpQ1sS.png" onerror="this.onerror=null;this.src='/img/jckling/404.jpg'" alt="å·¥ä½œæ€»ç»“"/></a><div class="content"><a class="title" href="/2023/12/12/Notes/%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93/" title="å·¥ä½œæ€»ç»“">å·¥ä½œæ€»ç»“</a><time datetime="2023-12-12T03:47:30.000Z" title="å‘è¡¨äº 2023-12-12 11:47:30">2023-12-12</time></div></div></div></div><div class="card-widget ads-wrap"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-1035234274961147" data-ad-slot="8787224657" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div></div></main><footer id="footer" style="background-image: url(https://i.loli.net/2021/06/14/O6DgG2AzyvJfTso.jpg);"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2020 - 2025 By Jckling</span><span class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.3</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æ—¥é—´å’Œå¤œé—´æ¨¡å¼åˆ‡æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="å‰å¾€è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  let initFn = window.walineFn || null
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = {"emoji":["https://unpkg.com/@waline/emojis@1.2.0/tw-emoji"]}

  const destroyWaline = ele => ele.destroy()

  const initWaline = (Fn, el = document, path = window.location.pathname) => {
    const waline = Fn({
      el: el.querySelector('#waline-wrap'),
      serverURL: 'https://blog-comments-puce.vercel.app',
      pageview: false,
      dark: 'html[data-theme="dark"]',
      comment: true,
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    if (isShuoshuo) {
      window.shuoshuoComment.destroyWaline = () => {
        destroyWaline(waline)
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }
  }

  const loadWaline = (el, path) => {
    if (initFn) initWaline(initFn, el, path)
    else {
      btf.getCSS('https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.min.css')
        .then(() => import('https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.min.js'))
        .then(({ init }) => {
          initFn = init || Waline.init
          initWaline(initFn, el, path)
          window.walineFn = initFn
        })
    }
  }

  if (isShuoshuo) {
    'Waline' === 'Waline'
      ? window.shuoshuoComment = { loadComment: loadWaline } 
      : window.loadOtherComment = loadWaline
    return
  }

  if ('Waline' === 'Waline' || !false) {
    if (false) btf.loadComment(document.getElementById('waline-wrap'),loadWaline)
    else setTimeout(loadWaline, 0)
  } else {
    window.loadOtherComment = loadWaline
  }
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>