<!DOCTYPE html><html lang="[&quot;zh-CN&quot;,&quot;en&quot;,&quot;zh-HK&quot;,&quot;zh-TW&quot;,&quot;default&quot;]" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>《MySQL 必知必会》实验 | Jckling's Blog</title><meta name="keywords" content="数据库,Database,MySQL"><meta name="author" content="Jckling"><meta name="copyright" content="Jckling"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="英文原书标题《MySQL Crash Course》，文中存在大小写混用的情况，由于 MySQL 语句不区分大小写，暂时不改（其实是懒）。">
<meta property="og:type" content="article">
<meta property="og:title" content="《MySQL 必知必会》实验">
<meta property="og:url" content="https://jckling.github.io/2020/11/22/Notes/Database/MySQL%20%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/index.html">
<meta property="og:site_name" content="Jckling&#39;s Blog">
<meta property="og:description" content="英文原书标题《MySQL Crash Course》，文中存在大小写混用的情况，由于 MySQL 语句不区分大小写，暂时不改（其实是懒）。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2021/06/14/wF3vNBjf1LH79Ss.png">
<meta property="article:published_time" content="2020-11-22T12:20:59.000Z">
<meta property="article:modified_time" content="2021-11-23T14:04:58.777Z">
<meta property="article:author" content="Jckling">
<meta property="article:tag" content="数据库">
<meta property="article:tag" content="Database">
<meta property="article:tag" content="MySQL">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/06/14/wF3vNBjf1LH79Ss.png"><link rel="shortcut icon" href="/img/jckling/favicon.ico"><link rel="canonical" href="https://jckling.github.io/2020/11/22/Notes/Database/MySQL%20%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google_site_verification" content="pZZt69mo0ndoxIJ1vjEe830lXbvD26aiVAZ-k0FWM5k"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?20b7797c0b5f4e821c1449cd4c6c98c8";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-164555720-1"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-164555720-1');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '《MySQL 必知必会》实验',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-11-23 22:04:58'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="Jckling's Blog" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/jckling/avatar.jpg" onerror="onerror=null;src='/img/jckling/avatar_404.png'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">107</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">40</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-film"></i><span> Movie</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://i.loli.net/2021/06/14/wF3vNBjf1LH79Ss.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Jckling's Blog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-film"></i><span> Movie</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">《MySQL 必知必会》实验</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2020-11-22T12:20:59.000Z" title="undefined 2020-11-22 20:20:59">2020-11-22</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Notes/">Notes</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="《MySQL 必知必会》实验"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2020/11/22/Notes/Database/MySQL%20%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/#post-comment"><span class="waline-comment-count" id="/2020/11/22/Notes/Database/MySQL%20%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/"></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="MySQL-环境搭建"><a href="#MySQL-环境搭建" class="headerlink" title="MySQL 环境搭建"></a>MySQL 环境搭建</h2><p>在 Ubuntu 虚拟机上使用 Docker 容器。<code>docker-compose up -d</code> 启动 MySQL 容器，设置密码和数据库并挂载文件夹，目前最新版本是 MySQL Server 8.0.22 ，挂载文件夹时为了之后使用 SQL 脚本。</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3&quot;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">db:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mysql:latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">mysql</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">environment:</span> </span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_ROOT_PASSWORD=password</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_DATABASE=test</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">3306</span><span class="string">:3306</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">~/test/MySQL</span> <span class="string">Crash</span> <span class="string">Course/mysql_scripts:/home</span> <span class="comment"># 主机:容器</span></span><br></pre></td></tr></table></figure>

<p>使用 <code>root</code> 用户登录 MySQL 容器，密码为 <code>password</code> ：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 第一个 mysql 是容器名称（container_name）</span></span><br><span class="line">docker <span class="built_in">exec</span> -it mysql mysql -u root -p</span><br></pre></td></tr></table></figure>

<p>使用 <code>test</code> 数据库，从 <code>.sql</code> 文件读取 SQL 语句并执行：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/mysql-batch-commands.html">Executing SQL Statements from a Text File</a></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">use <span class="built_in">test</span>;</span><br><span class="line"><span class="built_in">source</span> /home/create.sql</span><br><span class="line"><span class="built_in">source</span> /home/populate.sql</span><br></pre></td></tr></table></figure>

<p><img src="source_sql.png"></p>
<p>查看一下执行结果：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 列出当前数据库（test）中所有的表</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">tables</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 列出 customers 表的信息</span></span><br><span class="line"><span class="keyword">describe</span> customers;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 列出 customers 表中的前 3 行数据</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> customers <span class="keyword">limit</span> <span class="number">3</span>;</span><br></pre></td></tr></table></figure>

<p><img src="show_table.png"></p>
<p>注意事项：</p>
<ul>
<li>MySQL 清屏：<code>CTRL+l</code></li>
<li>MySQL 必须使用 <code>;</code> 来结束 SQL 语句</li>
<li>SQL 语句不区分大小写</li>
<li>SQL 语句可以分为多行</li>
</ul>
<h2 id="HELP"><a href="#HELP" class="headerlink" title="HELP"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/help.html">HELP</a></h2><p>帮助语句，用于返回 MySQL 参考手册中的信息，例如查找 <code>SHOW</code> 语句用法（不区分大小写）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; help show;</span><br><span class="line">Name: &#39;SHOW&#39;</span><br><span class="line">Description:</span><br><span class="line">SHOW has many forms that provide information about databases, tables,</span><br><span class="line">columns, or status information about the server. This section describes</span><br><span class="line">those following:</span><br><span class="line"></span><br><span class="line">SHOW &#123;BINARY | MASTER&#125; LOGS</span><br><span class="line">SHOW BINLOG EVENTS [IN &#39;log_name&#39;] [FROM pos] [LIMIT [offset,] row_count]</span><br><span class="line">SHOW CHARACTER SET [like_or_where]</span><br><span class="line">SHOW COLLATION [like_or_where]</span><br><span class="line">SHOW [FULL] COLUMNS FROM tbl_name [FROM db_name] [like_or_where]</span><br><span class="line">SHOW CREATE DATABASE db_name</span><br><span class="line">SHOW CREATE EVENT event_name</span><br><span class="line">SHOW CREATE FUNCTION func_name</span><br><span class="line">SHOW CREATE PROCEDURE proc_name</span><br><span class="line">SHOW CREATE TABLE tbl_name</span><br><span class="line">SHOW CREATE TRIGGER trigger_name</span><br><span class="line">SHOW CREATE VIEW view_name</span><br><span class="line">SHOW DATABASES [like_or_where]</span><br><span class="line">SHOW ENGINE engine_name &#123;STATUS | MUTEX&#125;</span><br><span class="line">SHOW [STORAGE] ENGINES</span><br><span class="line">SHOW ERRORS [LIMIT [offset,] row_count]</span><br><span class="line">SHOW EVENTS</span><br><span class="line">SHOW FUNCTION CODE func_name</span><br><span class="line">SHOW FUNCTION STATUS [like_or_where]</span><br><span class="line">SHOW GRANTS FOR user</span><br><span class="line">SHOW INDEX FROM tbl_name [FROM db_name]</span><br><span class="line">SHOW MASTER STATUS</span><br><span class="line">SHOW OPEN TABLES [FROM db_name] [like_or_where]</span><br><span class="line">SHOW PLUGINS</span><br><span class="line">SHOW PROCEDURE CODE proc_name</span><br><span class="line">SHOW PROCEDURE STATUS [like_or_where]</span><br><span class="line">SHOW PRIVILEGES</span><br><span class="line">SHOW [FULL] PROCESSLIST</span><br><span class="line">SHOW PROFILE [types] [FOR QUERY n] [OFFSET n] [LIMIT n]</span><br><span class="line">SHOW PROFILES</span><br><span class="line">SHOW RELAYLOG EVENTS [IN &#39;log_name&#39;] [FROM pos] [LIMIT [offset,] row_count]</span><br><span class="line">SHOW SLAVE HOSTS</span><br><span class="line">SHOW SLAVE STATUS [FOR CHANNEL channel]</span><br><span class="line">SHOW [GLOBAL | SESSION] STATUS [like_or_where]</span><br><span class="line">SHOW TABLE STATUS [FROM db_name] [like_or_where]</span><br><span class="line">SHOW [FULL] TABLES [FROM db_name] [like_or_where]</span><br><span class="line">SHOW TRIGGERS [FROM db_name] [like_or_where]</span><br><span class="line">SHOW [GLOBAL | SESSION] VARIABLES [like_or_where]</span><br><span class="line">SHOW WARNINGS [LIMIT [offset,] row_count]</span><br><span class="line"></span><br><span class="line">like_or_where: &#123;</span><br><span class="line">    LIKE &#39;pattern&#39;</span><br><span class="line">  | WHERE expr</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">If the syntax for a given SHOW statement includes a LIKE &#39;pattern&#39;</span><br><span class="line">part, &#39;pattern&#39; is a string that can contain the SQL % and _ wildcard</span><br><span class="line">characters. The pattern is useful for restricting statement output to</span><br><span class="line">matching values.</span><br><span class="line"></span><br><span class="line">Several SHOW statements also accept a WHERE clause that provides more</span><br><span class="line">flexibility in specifying which rows to display. See</span><br><span class="line">https:&#x2F;&#x2F;dev.mysql.com&#x2F;doc&#x2F;refman&#x2F;8.0&#x2F;en&#x2F;extended-show.html.</span><br><span class="line"></span><br><span class="line">URL: https:&#x2F;&#x2F;dev.mysql.com&#x2F;doc&#x2F;refman&#x2F;8.0&#x2F;en&#x2F;show.html</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="USE"><a href="#USE" class="headerlink" title="USE"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/use.html">USE</a></h2><p>使用 <code>USE</code> 语句打开特定名称的数据库，作为后续语句的默认（当前）数据库：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; use test;</span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; </span><br></pre></td></tr></table></figure>

<h2 id="SHOW"><a href="#SHOW" class="headerlink" title="SHOW"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/show.html">SHOW</a></h2><h3 id="SHOW-DATABASES"><a href="#SHOW-DATABASES" class="headerlink" title="SHOW DATABASES"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/show-databases.html">SHOW DATABASES</a></h3><p>使用 <code>SHOW DATABASES</code> 语句列出 MySQL 服务器主机上的数据库：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">| test               |</span><br><span class="line">+--------------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="SHOW-TABLES"><a href="#SHOW-TABLES" class="headerlink" title="SHOW TABLES"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/show-tables.html">SHOW TABLES</a></h3><p>使用 <code>SHOW TABLES</code> 语句列出给定数据库中的非临时表（non-TEMPORARY tables），默认列出当前数据库中的表：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show tables;</span><br><span class="line">+----------------+</span><br><span class="line">| Tables_in_test |</span><br><span class="line">+----------------+</span><br><span class="line">| customers      |</span><br><span class="line">| orderitems     |</span><br><span class="line">| orders         |</span><br><span class="line">| productnotes   |</span><br><span class="line">| products       |</span><br><span class="line">| vendors        |</span><br><span class="line">+----------------+</span><br><span class="line">6 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="SHOW-COLUMNS"><a href="#SHOW-COLUMNS" class="headerlink" title="SHOW COLUMNS"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/show-columns.html">SHOW COLUMNS</a></h3><p>使用 <code>SHOW COLUMNS</code> 列出给定表中有关列的信息，也适用于视图。对每个字段返回一行，每行显示字段名、数据类型、是否允许为 NULL、键信息、默认值以及其他信息。例如，列出 customers 表的信息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show columns from customers;</span><br><span class="line">+--------------+-----------+------+-----+---------+----------------+</span><br><span class="line">| Field        | Type      | Null | Key | Default | Extra          |</span><br><span class="line">+--------------+-----------+------+-----+---------+----------------+</span><br><span class="line">| cust_id      | int       | NO   | PRI | NULL    | auto_increment |</span><br><span class="line">| cust_name    | char(50)  | NO   |     | NULL    |                |</span><br><span class="line">| cust_address | char(50)  | YES  |     | NULL    |                |</span><br><span class="line">| cust_city    | char(50)  | YES  |     | NULL    |                |</span><br><span class="line">| cust_state   | char(5)   | YES  |     | NULL    |                |</span><br><span class="line">| cust_zip     | char(10)  | YES  |     | NULL    |                |</span><br><span class="line">| cust_country | char(50)  | YES  |     | NULL    |                |</span><br><span class="line">| cust_contact | char(50)  | YES  |     | NULL    |                |</span><br><span class="line">| cust_email   | char(255) | YES  |     | NULL    |                |</span><br><span class="line">+--------------+-----------+------+-----+---------+----------------+</span><br><span class="line">9 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>也可以使用 <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/describe.html">DESCRIBE</a> 或者 <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/explain.html">EXPLAIN</a> 语句查看表信息。查看 customers 表的信息，返回的结果和使用 <code>SHOW COLUMNS</code> 相同：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; describe customers;</span><br><span class="line">+--------------+-----------+------+-----+---------+----------------+</span><br><span class="line">| Field        | Type      | Null | Key | Default | Extra          |</span><br><span class="line">+--------------+-----------+------+-----+---------+----------------+</span><br><span class="line">| cust_id      | int       | NO   | PRI | NULL    | auto_increment |</span><br><span class="line">| cust_name    | char(50)  | NO   |     | NULL    |                |</span><br><span class="line">| cust_address | char(50)  | YES  |     | NULL    |                |</span><br><span class="line">| cust_city    | char(50)  | YES  |     | NULL    |                |</span><br><span class="line">| cust_state   | char(5)   | YES  |     | NULL    |                |</span><br><span class="line">| cust_zip     | char(10)  | YES  |     | NULL    |                |</span><br><span class="line">| cust_country | char(50)  | YES  |     | NULL    |                |</span><br><span class="line">| cust_contact | char(50)  | YES  |     | NULL    |                |</span><br><span class="line">| cust_email   | char(255) | YES  |     | NULL    |                |</span><br><span class="line">+--------------+-----------+------+-----+---------+----------------+</span><br><span class="line">9 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; explain customers;</span><br><span class="line">+--------------+-----------+------+-----+---------+----------------+</span><br><span class="line">| Field        | Type      | Null | Key | Default | Extra          |</span><br><span class="line">+--------------+-----------+------+-----+---------+----------------+</span><br><span class="line">| cust_id      | int       | NO   | PRI | NULL    | auto_increment |</span><br><span class="line">| cust_name    | char(50)  | NO   |     | NULL    |                |</span><br><span class="line">| cust_address | char(50)  | YES  |     | NULL    |                |</span><br><span class="line">| cust_city    | char(50)  | YES  |     | NULL    |                |</span><br><span class="line">| cust_state   | char(5)   | YES  |     | NULL    |                |</span><br><span class="line">| cust_zip     | char(10)  | YES  |     | NULL    |                |</span><br><span class="line">| cust_country | char(50)  | YES  |     | NULL    |                |</span><br><span class="line">| cust_contact | char(50)  | YES  |     | NULL    |                |</span><br><span class="line">| cust_email   | char(255) | YES  |     | NULL    |                |</span><br><span class="line">+--------------+-----------+------+-----+---------+----------------+</span><br><span class="line">9 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="SHOW-STATUS"><a href="#SHOW-STATUS" class="headerlink" title="SHOW STATUS"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/show-status.html">SHOW STATUS</a></h3><p><code>SHOW STATUS</code> 用于显示服务器状态信息，使用 <code>LIKE</code> 查找模式匹配的变量，例如 <code>LIKE &#39;ssl%&#39;</code> 表示匹配以 <code>ssl</code> 开头的变量名称，不区分大小写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show status like &#39;ssl%&#39;;</span><br><span class="line">+--------------------------------+--------------------------+</span><br><span class="line">| Variable_name                  | Value                    |</span><br><span class="line">+--------------------------------+--------------------------+</span><br><span class="line">| Ssl_accept_renegotiates        | 0                        |</span><br><span class="line">| Ssl_accepts                    | 0                        |</span><br><span class="line">| Ssl_callback_cache_hits        | 0                        |</span><br><span class="line">| Ssl_cipher                     |                          |</span><br><span class="line">| Ssl_cipher_list                |                          |</span><br><span class="line">| Ssl_client_connects            | 0                        |</span><br><span class="line">| Ssl_connect_renegotiates       | 0                        |</span><br><span class="line">| Ssl_ctx_verify_depth           | 18446744073709551615     |</span><br><span class="line">| Ssl_ctx_verify_mode            | 5                        |</span><br><span class="line">| Ssl_default_timeout            | 0                        |</span><br><span class="line">| Ssl_finished_accepts           | 0                        |</span><br><span class="line">| Ssl_finished_connects          | 0                        |</span><br><span class="line">| Ssl_server_not_after           | Nov 19 07:19:37 2030 GMT |</span><br><span class="line">| Ssl_server_not_before          | Nov 21 07:19:37 2020 GMT |</span><br><span class="line">| Ssl_session_cache_hits         | 0                        |</span><br><span class="line">| Ssl_session_cache_misses       | 0                        |</span><br><span class="line">| Ssl_session_cache_mode         | SERVER                   |</span><br><span class="line">| Ssl_session_cache_overflows    | 0                        |</span><br><span class="line">| Ssl_session_cache_size         | 128                      |</span><br><span class="line">| Ssl_session_cache_timeouts     | 0                        |</span><br><span class="line">| Ssl_sessions_reused            | 0                        |</span><br><span class="line">| Ssl_used_session_cache_entries | 0                        |</span><br><span class="line">| Ssl_verify_depth               | 0                        |</span><br><span class="line">| Ssl_verify_mode                | 0                        |</span><br><span class="line">| Ssl_version                    |                          |</span><br><span class="line">+--------------------------------+--------------------------+</span><br><span class="line">25 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="SHOW-CREATE-DATABASE"><a href="#SHOW-CREATE-DATABASE" class="headerlink" title="SHOW CREATE DATABASE"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/show-create-database.html">SHOW CREATE DATABASE</a></h3><p><code>SHOW CREATE DATABASE test</code> 显示创建 <code>test</code> 数据库时使用的 <code>CREATE DATABASE</code> 语句，该数据库在容器启动后自动创建。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show create database test;</span><br><span class="line">+----------+--------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| Database | Create Database                                                                                                                |</span><br><span class="line">+----------+--------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| test     | CREATE DATABASE &#96;test&#96; &#x2F;*!40100 DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci *&#x2F; &#x2F;*!80016 DEFAULT ENCRYPTION&#x3D;&#39;N&#39; *&#x2F; |</span><br><span class="line">+----------+--------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="SHOW-CREATE-TABLE"><a href="#SHOW-CREATE-TABLE" class="headerlink" title="SHOW CREATE TABLE"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/show-create-table.html">SHOW CREATE TABLE</a></h3><p><code>SHOW CREATE TABLE customers</code> 显示创建 customers 表时使用的 <code>CREATE TABLE</code> 语句，该语句也适用于视图。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show create table customers;</span><br><span class="line">+-----------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| Table     | Create Table                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |</span><br><span class="line">+-----------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| customers | CREATE TABLE &#96;customers&#96; (</span><br><span class="line">  &#96;cust_id&#96; int NOT NULL AUTO_INCREMENT,</span><br><span class="line">  &#96;cust_name&#96; char(50) NOT NULL,</span><br><span class="line">  &#96;cust_address&#96; char(50) DEFAULT NULL,</span><br><span class="line">  &#96;cust_city&#96; char(50) DEFAULT NULL,</span><br><span class="line">  &#96;cust_state&#96; char(5) DEFAULT NULL,</span><br><span class="line">  &#96;cust_zip&#96; char(10) DEFAULT NULL,</span><br><span class="line">  &#96;cust_country&#96; char(50) DEFAULT NULL,</span><br><span class="line">  &#96;cust_contact&#96; char(50) DEFAULT NULL,</span><br><span class="line">  &#96;cust_email&#96; char(255) DEFAULT NULL,</span><br><span class="line">  PRIMARY KEY (&#96;cust_id&#96;)</span><br><span class="line">) ENGINE&#x3D;InnoDB AUTO_INCREMENT&#x3D;10006 DEFAULT CHARSET&#x3D;utf8mb4 COLLATE&#x3D;utf8mb4_0900_ai_ci |</span><br><span class="line">+-----------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="SHOW-GRANTS"><a href="#SHOW-GRANTS" class="headerlink" title="SHOW GRANTS"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/show-grants.html">SHOW GRANTS</a></h3><p>以 GRANT 语句的形式显示用户的权限信息和角色信息，不加任何参数默认显示当前用户的信息。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show grants;</span><br><span class="line">+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| Grants for root@localhost                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |</span><br><span class="line">+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP, RELOAD, SHUTDOWN, PROCESS, FILE, REFERENCES, INDEX, ALTER, SHOW DATABASES, SUPER, CREATE TEMPORARY TABLES, LOCK TABLES, EXECUTE, REPLICATION SLAVE, REPLICATION CLIENT, CREATE VIEW, SHOW VIEW, CREATE ROUTINE, ALTER ROUTINE, CREATE USER, EVENT, TRIGGER, CREATE TABLESPACE, CREATE ROLE, DROP ROLE ON *.* TO &#96;root&#96;@&#96;localhost&#96; WITH GRANT OPTION                                                                                                                                               |</span><br><span class="line">| GRANT APPLICATION_PASSWORD_ADMIN,AUDIT_ADMIN,BACKUP_ADMIN,BINLOG_ADMIN,BINLOG_ENCRYPTION_ADMIN,CLONE_ADMIN,CONNECTION_ADMIN,ENCRYPTION_KEY_ADMIN,GROUP_REPLICATION_ADMIN,INNODB_REDO_LOG_ARCHIVE,INNODB_REDO_LOG_ENABLE,PERSIST_RO_VARIABLES_ADMIN,REPLICATION_APPLIER,REPLICATION_SLAVE_ADMIN,RESOURCE_GROUP_ADMIN,RESOURCE_GROUP_USER,ROLE_ADMIN,SERVICE_CONNECTION_ADMIN,SESSION_VARIABLES_ADMIN,SET_USER_ID,SHOW_ROUTINE,SYSTEM_USER,SYSTEM_VARIABLES_ADMIN,TABLE_ENCRYPTION_ADMIN,XA_RECOVER_ADMIN ON *.* TO &#96;root&#96;@&#96;localhost&#96; WITH GRANT OPTION |</span><br><span class="line">| GRANT PROXY ON &#39;&#39;@&#39;&#39; TO &#39;root&#39;@&#39;localhost&#39; WITH GRANT OPTION                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |</span><br><span class="line">+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="SHOW-ERRORS"><a href="#SHOW-ERRORS" class="headerlink" title="SHOW ERRORS"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/show-errors.html">SHOW ERRORS</a></h3><p><code>SHOW ERRORS</code> 是一个诊断语句，类似于 <code>SHOW WARNINGS</code>，但是只显示错误信息。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show errors;</span><br><span class="line">Empty set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="SHOW-WARNINGS"><a href="#SHOW-WARNINGS" class="headerlink" title="SHOW WARNINGS"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/show-warnings.html">SHOW WARNINGS</a></h3><p><code>SHOW WARNINGS</code> 也是一个诊断语句，显示在当前会话中执行语句所产生的条件（错误、警告和注释）的信息。比 <code>SHOW ERRORS</code> 显示更多的信息，二者显示的信息是包含关系。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show warnings;</span><br><span class="line">Empty set (0.00 sec)</span><br></pre></td></tr></table></figure>


<h2 id="SELECT"><a href="#SELECT" class="headerlink" title="SELECT"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/select.html">SELECT</a></h2><p><code>SELECT</code> 语句用于从一个或多个表中检索行，可以包括联合语句（UNION）和子查询。</p>
<p><strong>1. 检索单独的列</strong></p>
<p>给出具体的表名和列名，例如，从 products 表中检索 prod_name 列：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_name from products;</span><br><span class="line">+----------------+</span><br><span class="line">| prod_name      |</span><br><span class="line">+----------------+</span><br><span class="line">| .5 ton anvil   |</span><br><span class="line">| 1 ton anvil    |</span><br><span class="line">| 2 ton anvil    |</span><br><span class="line">| Detonator      |</span><br><span class="line">| Bird seed      |</span><br><span class="line">| Carrots        |</span><br><span class="line">| Fuses          |</span><br><span class="line">| JetPack 1000   |</span><br><span class="line">| JetPack 2000   |</span><br><span class="line">| Oil can        |</span><br><span class="line">| Safe           |</span><br><span class="line">| Sling          |</span><br><span class="line">| TNT (1 stick)  |</span><br><span class="line">| TNT (5 sticks) |</span><br><span class="line">+----------------+</span><br><span class="line">14 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>2. 检索多个列</strong></p>
<p>指定表名，给出多个列名，用 <code>,</code> 分隔。例如，从 products 表中检索 prod_id,prod_name,prod_price 列：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_id, prod_name, prod_price from products;</span><br><span class="line">+---------+----------------+------------+</span><br><span class="line">| prod_id | prod_name      | prod_price |</span><br><span class="line">+---------+----------------+------------+</span><br><span class="line">| ANV01   | .5 ton anvil   |       5.99 |</span><br><span class="line">| ANV02   | 1 ton anvil    |       9.99 |</span><br><span class="line">| ANV03   | 2 ton anvil    |      14.99 |</span><br><span class="line">| DTNTR   | Detonator      |      13.00 |</span><br><span class="line">| FB      | Bird seed      |      10.00 |</span><br><span class="line">| FC      | Carrots        |       2.50 |</span><br><span class="line">| FU1     | Fuses          |       3.42 |</span><br><span class="line">| JP1000  | JetPack 1000   |      35.00 |</span><br><span class="line">| JP2000  | JetPack 2000   |      55.00 |</span><br><span class="line">| OL1     | Oil can        |       8.99 |</span><br><span class="line">| SAFE    | Safe           |      50.00 |</span><br><span class="line">| SLING   | Sling          |       4.49 |</span><br><span class="line">| TNT1    | TNT (1 stick)  |       2.50 |</span><br><span class="line">| TNT2    | TNT (5 sticks) |      10.00 |</span><br><span class="line">+---------+----------------+------------+</span><br><span class="line">14 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>3. 检索所有列</strong></p>
<p>使用 <code>*</code> 通配符匹配所有的列，给出表名即可。如果数据表有很多列，或者数据量很多，不推荐使用通配符；不过用通配符可以检索出名字未知的列。例如，检索 products 表中所有的列：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from products;</span><br><span class="line">+---------+---------+----------------+------------+----------------------------------------------------------------+</span><br><span class="line">| prod_id | vend_id | prod_name      | prod_price | prod_desc                                                      |</span><br><span class="line">+---------+---------+----------------+------------+----------------------------------------------------------------+</span><br><span class="line">| ANV01   |    1001 | .5 ton anvil   |       5.99 | .5 ton anvil, black, complete with handy hook                  |</span><br><span class="line">| ANV02   |    1001 | 1 ton anvil    |       9.99 | 1 ton anvil, black, complete with handy hook and carrying case |</span><br><span class="line">| ANV03   |    1001 | 2 ton anvil    |      14.99 | 2 ton anvil, black, complete with handy hook and carrying case |</span><br><span class="line">| DTNTR   |    1003 | Detonator      |      13.00 | Detonator (plunger powered), fuses not included                |</span><br><span class="line">| FB      |    1003 | Bird seed      |      10.00 | Large bag (suitable for road runners)                          |</span><br><span class="line">| FC      |    1003 | Carrots        |       2.50 | Carrots (rabbit hunting season only)                           |</span><br><span class="line">| FU1     |    1002 | Fuses          |       3.42 | 1 dozen, extra long                                            |</span><br><span class="line">| JP1000  |    1005 | JetPack 1000   |      35.00 | JetPack 1000, intended for single use                          |</span><br><span class="line">| JP2000  |    1005 | JetPack 2000   |      55.00 | JetPack 2000, multi-use                                        |</span><br><span class="line">| OL1     |    1002 | Oil can        |       8.99 | Oil can, red                                                   |</span><br><span class="line">| SAFE    |    1003 | Safe           |      50.00 | Safe with combination lock                                     |</span><br><span class="line">| SLING   |    1003 | Sling          |       4.49 | Sling, one size fits all                                       |</span><br><span class="line">| TNT1    |    1003 | TNT (1 stick)  |       2.50 | TNT, red, single stick                                         |</span><br><span class="line">| TNT2    |    1003 | TNT (5 sticks) |      10.00 | TNT, red, pack of 10 sticks                                    |</span><br><span class="line">+---------+---------+----------------+------------+----------------------------------------------------------------+</span><br><span class="line">14 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>4. 检索不同的行</strong></p>
<p>当检索出的列中有重复数据时，可以使用 <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/distinct-optimization.html"><code>DISTINCT</code></a> 关键字在行上进行过滤。例如，检索 products 表的 vend_id 列，包含许多重复数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select vend_id from products;</span><br><span class="line">+---------+</span><br><span class="line">| vend_id |</span><br><span class="line">+---------+</span><br><span class="line">|    1001 |</span><br><span class="line">|    1001 |</span><br><span class="line">|    1001 |</span><br><span class="line">|    1002 |</span><br><span class="line">|    1002 |</span><br><span class="line">|    1003 |</span><br><span class="line">|    1003 |</span><br><span class="line">|    1003 |</span><br><span class="line">|    1003 |</span><br><span class="line">|    1003 |</span><br><span class="line">|    1003 |</span><br><span class="line">|    1003 |</span><br><span class="line">|    1005 |</span><br><span class="line">|    1005 |</span><br><span class="line">+---------+</span><br><span class="line">14 rows in set (0.01 sec)</span><br></pre></td></tr></table></figure>

<p><code>DISTINCT</code> 关键字必须放在所有的列名之前，并且作用于所有的列。例如，检索 products 表，使用 <code>DISTINCT</code> 过滤重复列：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select distinct vend_id from products;</span><br><span class="line">+---------+</span><br><span class="line">| vend_id |</span><br><span class="line">+---------+</span><br><span class="line">|    1001 |</span><br><span class="line">|    1002 |</span><br><span class="line">|    1003 |</span><br><span class="line">|    1005 |</span><br><span class="line">+---------+</span><br><span class="line">4 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>5. 限制数量</strong></p>
<p>在语句的末尾使用 <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/limit-optimization.html"><code>LIMIT</code></a> 关键字限制返回的行数。例如，从 products 表中检索 prod_name 列，限制返回 5 行数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_name from products limit 5;</span><br><span class="line">+--------------+</span><br><span class="line">| prod_name    |</span><br><span class="line">+--------------+</span><br><span class="line">| .5 ton anvil |</span><br><span class="line">| 1 ton anvil  |</span><br><span class="line">| 2 ton anvil  |</span><br><span class="line">| Detonator    |</span><br><span class="line">| Bird seed    |</span><br><span class="line">+--------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><code>LIMIT 5,5</code> 表示从第 5 行开始返回 5 行，如果行数不够则有多少返回多少。注意，MySQL 中的行从 0 开始计数。</p>
<ul>
<li>第一个数字表示从第几行开始</li>
<li>第二个数字表示返回几行</li>
</ul>
<p>例如，从 products 表中检索 prod_name 列，从第 5 行开始返回 5 行数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_name from products limit 5,5;</span><br><span class="line">+--------------+</span><br><span class="line">| prod_name    |</span><br><span class="line">+--------------+</span><br><span class="line">| Carrots      |</span><br><span class="line">| Fuses        |</span><br><span class="line">| JetPack 1000 |</span><br><span class="line">| JetPack 2000 |</span><br><span class="line">| Oil can      |</span><br><span class="line">+--------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>使用 <code>OFFSET</code> 关键字可以实现同样的效果，语义更加直观，表示从第 5 行（OFFSET）开始返回 5 行数据（LIMIT）。同样的语句可以改写为如下形式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_name from products limit 5 offset 5;</span><br><span class="line">+--------------+</span><br><span class="line">| prod_name    |</span><br><span class="line">+--------------+</span><br><span class="line">| Carrots      |</span><br><span class="line">| Fuses        |</span><br><span class="line">| JetPack 1000 |</span><br><span class="line">| JetPack 2000 |</span><br><span class="line">| Oil can      |</span><br><span class="line">+--------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>6. 完全限定的表名</strong></p>
<p>完全限定的表名是指同时使用数据库名和表名，完全限定的列名是指同时使用表名和列名，<code>products.prod_name</code> 表示指定 products 表中的 prod_name 列，当不的同表有相同的列名时，可以用来进行区分。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select products.prod_name from products;</span><br><span class="line">+----------------+</span><br><span class="line">| prod_name      |</span><br><span class="line">+----------------+</span><br><span class="line">| .5 ton anvil   |</span><br><span class="line">| 1 ton anvil    |</span><br><span class="line">| 2 ton anvil    |</span><br><span class="line">| Detonator      |</span><br><span class="line">| Bird seed      |</span><br><span class="line">| Carrots        |</span><br><span class="line">| Fuses          |</span><br><span class="line">| JetPack 1000   |</span><br><span class="line">| JetPack 2000   |</span><br><span class="line">| Oil can        |</span><br><span class="line">| Safe           |</span><br><span class="line">| Sling          |</span><br><span class="line">| TNT (1 stick)  |</span><br><span class="line">| TNT (5 sticks) |</span><br><span class="line">+----------------+</span><br><span class="line">14 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h2 id="WHERE"><a href="#WHERE" class="headerlink" title="WHERE"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/where-optimization.html">WHERE</a></h2><p><code>WHERE</code> 子句用于指定检索的表。子句（Clause）通常由一个关键字和所提供的数据组成。</p>
<p>只检索所需数据要指定搜索条件（search criteria），搜索条件也称为过滤条件（filter condition）。</p>
<p>MySQL 支持很多操作符（<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/non-typed-operators.html">Operators</a>），其中有不少可以用在 <code>WHERE</code> 子句中。</p>
<h3 id="比较操作符"><a href="#比较操作符" class="headerlink" title="比较操作符"></a>比较操作符</h3><p>以下为 MySQL 支持的比较操作符和比较函数，MySQL 进行匹配时默认不区分大小写：</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
</table>
<blockquote>
<p>   |Greater than operator<br>=    |Greater than or equal operator<br>&lt;    |Less than operator<br>&lt;&gt;, |!=    Not equal operator<br>&lt;=    |Less than or equal operator<br>&lt;=&gt;    |NULL-safe equal to operator<br>=    |Equal operator<br>BETWEEN … AND …    |Whether a value is within a range of values<br>COALESCE()    |Return the first non-NULL argument<br>GREATEST()    |Return the largest argument<br>IN()    |Whether a value is within a set of values<br>INTERVAL()    |Return the index of the argument that is less than the first argument<br>IS    |Test a value against a boolean<br>IS NOT    |Test a value against a boolean<br>IS NOT NULL    |NOT NULL value test<br>IS NULL    |NULL value test<br>ISNULL()    |Test whether the argument is NULL<br>LEAST()    |Return the smallest argument<br>LIKE    |Simple pattern matching<br>NOT BETWEEN … AND …    |Whether a value is not within a range of values<br>NOT IN()    |Whether a value is not within a set of values<br>NOT LIKE    |Negation of simple pattern matching<br>STRCMP()    |Compare two strings</p>
</blockquote>
<p><strong>1. 检查单个值</strong></p>
<p>使用 <code>=</code> 检索 prod_name 列中值为 <code>fuses</code> 的行：</p>
<ul>
<li>使用单引号 <code>&#39;</code> 限定字符串</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_name, prod_price</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where prod_name &#x3D; &#39;fuses&#39;;</span><br><span class="line">+-----------+------------+</span><br><span class="line">| prod_name | prod_price |</span><br><span class="line">+-----------+------------+</span><br><span class="line">| Fuses     |       3.42 |</span><br><span class="line">+-----------+------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>使用 <code>&lt;</code> 检索 prod_price 列中值小于 10 的行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_name, prod_price</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where prod_price &lt; 10;</span><br><span class="line">+---------------+------------+</span><br><span class="line">| prod_name     | prod_price |</span><br><span class="line">+---------------+------------+</span><br><span class="line">| .5 ton anvil  |       5.99 |</span><br><span class="line">| 1 ton anvil   |       9.99 |</span><br><span class="line">| Carrots       |       2.50 |</span><br><span class="line">| Fuses         |       3.42 |</span><br><span class="line">| Oil can       |       8.99 |</span><br><span class="line">| Sling         |       4.49 |</span><br><span class="line">| TNT (1 stick) |       2.50 |</span><br><span class="line">+---------------+------------+</span><br><span class="line">7 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>2. 不匹配检查</strong></p>
<p>使用 <code>&lt;&gt;</code> 检索 vend_id 列中值不为 1003 的行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select vend_id, prod_name</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where vend_id &lt;&gt; 1003;</span><br><span class="line">+---------+--------------+</span><br><span class="line">| vend_id | prod_name    |</span><br><span class="line">+---------+--------------+</span><br><span class="line">|    1001 | .5 ton anvil |</span><br><span class="line">|    1001 | 1 ton anvil  |</span><br><span class="line">|    1001 | 2 ton anvil  |</span><br><span class="line">|    1002 | Fuses        |</span><br><span class="line">|    1002 | Oil can      |</span><br><span class="line">|    1005 | JetPack 1000 |</span><br><span class="line">|    1005 | JetPack 2000 |</span><br><span class="line">+---------+--------------+</span><br><span class="line">7 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>3. 范围值检查</strong></p>
<p>使用 <code>between ... and ...</code> 检索范围内的值，包括指定的开始值和终止值：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_name, prod_price</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where prod_price between 5 and 10;</span><br><span class="line">+----------------+------------+</span><br><span class="line">| prod_name      | prod_price |</span><br><span class="line">+----------------+------------+</span><br><span class="line">| .5 ton anvil   |       5.99 |</span><br><span class="line">| 1 ton anvil    |       9.99 |</span><br><span class="line">| Bird seed      |      10.00 |</span><br><span class="line">| Oil can        |       8.99 |</span><br><span class="line">| TNT (5 sticks) |      10.00 |</span><br><span class="line">+----------------+------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>4. 空值检查</strong></p>
<p>当一个列不包含值时，称其包含空值 NULL ，在使用匹配和不匹配过滤数据时，具有 NULL 值的行将被忽略，因此需要验证返回的数据中确实给出了被过滤列具有 NULL 值的行。</p>
<p>使用 <code>IS NULL</code> 操作符检索指定列中值为 NULL 的行。例如，从 products 表中检索 prod_name ，由于列 prod_price 没有空值，返回为空集。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_name</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where prod_price is null;</span><br><span class="line">Empty set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>检索 customers 表的 cust_id 列，返回 cust_email 为空值的列。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select cust_id</span><br><span class="line">    -&gt; from customers</span><br><span class="line">    -&gt; where cust_email is null;</span><br><span class="line">+---------+</span><br><span class="line">| cust_id |</span><br><span class="line">+---------+</span><br><span class="line">|   10002 |</span><br><span class="line">|   10005 |</span><br><span class="line">+---------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>5. IN</strong></p>
<p><code>IN</code> 用来指定条件范围，其中每个条件的关系是 or ，因此满足范围中任意条件即可。下列语句检索 vender_id 为 1002 或 1003 的数据：</p>
<ul>
<li><code>IN</code> 通常比 <code>OR</code> 的运算速度更快</li>
<li><code>IN</code> 可以包含其他 <code>SELECT</code> 语句</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_name, prod_price</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where vend_id in (1002, 1003)</span><br><span class="line">    -&gt; order by prod_name;</span><br><span class="line">+----------------+------------+</span><br><span class="line">| prod_name      | prod_price |</span><br><span class="line">+----------------+------------+</span><br><span class="line">| Bird seed      |      10.00 |</span><br><span class="line">| Carrots        |       2.50 |</span><br><span class="line">| Detonator      |      13.00 |</span><br><span class="line">| Fuses          |       3.42 |</span><br><span class="line">| Oil can        |       8.99 |</span><br><span class="line">| Safe           |      50.00 |</span><br><span class="line">| Sling          |       4.49 |</span><br><span class="line">| TNT (1 stick)  |       2.50 |</span><br><span class="line">| TNT (5 sticks) |      10.00 |</span><br><span class="line">+----------------+------------+</span><br><span class="line">9 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>6. NOT</strong></p>
<p><code>NOT</code> 否定之后的任何条件，例如，检索 vender_id 为 1002 或 1003 之外的数据：</p>
<ul>
<li><code>NOT</code> 可以对 <code>IN</code> 、<code>BETWEEN</code>、<code>EXISTS</code> 语句取反</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_name, prod_price</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where vend_id not in (1002, 1003)</span><br><span class="line">    -&gt; order by prod_name;</span><br><span class="line">+--------------+------------+</span><br><span class="line">| prod_name    | prod_price |</span><br><span class="line">+--------------+------------+</span><br><span class="line">| .5 ton anvil |       5.99 |</span><br><span class="line">| 1 ton anvil  |       9.99 |</span><br><span class="line">| 2 ton anvil  |      14.99 |</span><br><span class="line">| JetPack 1000 |      35.00 |</span><br><span class="line">| JetPack 2000 |      55.00 |</span><br><span class="line">+--------------+------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>7. Like</strong></p>
<p>利用通配符可创建比较特定数据的搜索模式</p>
<ul>
<li>通配符（wildcard）：用来匹配值的一部分的特殊字符</li>
<li>搜索模式（search pattern）：由字面值、通配符或两者组合构成的搜索条件</li>
</ul>
<p>为了在搜索子句中使用通配符，必须使用 <code>LIKE</code> 操作符。</p>
<p>通配符 <code>%</code> 表示任何字符出现任意次数，例如，检索 prod_name 列中值以 <code>jet</code> 开头的行：</p>
<ul>
<li><code>%</code> 无法匹配 NULL</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_id, prod_name</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where prod_name like &#39;jet%&#39;;</span><br><span class="line">+---------+--------------+</span><br><span class="line">| prod_id | prod_name    |</span><br><span class="line">+---------+--------------+</span><br><span class="line">| JP1000  | JetPack 1000 |</span><br><span class="line">| JP2000  | JetPack 2000 |</span><br><span class="line">+---------+--------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>通配符可以在搜索模式中任意位置使用，并且可以使用多个通配符。例如，检索 prod_name 列中值包含 <code>anvil</code> 的行， <code>anvil</code> 可以出现在任意位置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_id, prod_name</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where prod_name like &#39;%anvil%&#39;;</span><br><span class="line">+---------+--------------+</span><br><span class="line">| prod_id | prod_name    |</span><br><span class="line">+---------+--------------+</span><br><span class="line">| ANV01   | .5 ton anvil |</span><br><span class="line">| ANV02   | 1 ton anvil  |</span><br><span class="line">| ANV03   | 2 ton anvil  |</span><br><span class="line">+---------+--------------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>通配符 <code>_</code> 表示匹配任意单个字符，例如，<code>_ ton anvil</code> 匹配任意单个字符开头的，后接 <code> ton anvil</code>  ：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_id, prod_name</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where prod_name like &#39;_ ton anvil&#39;;</span><br><span class="line">+---------+-------------+</span><br><span class="line">| prod_id | prod_name   |</span><br><span class="line">+---------+-------------+</span><br><span class="line">| ANV02   | 1 ton anvil |</span><br><span class="line">| ANV03   | 2 ton anvil |</span><br><span class="line">+---------+-------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="逻辑操作符"><a href="#逻辑操作符" class="headerlink" title="逻辑操作符"></a>逻辑操作符</h3><p>MySQL 中的逻辑操作符有四个：与、或、非、异或，通常用于联结或改变 WHERE 子句。</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>AND, &amp;&amp;</td>
<td>Logical AND</td>
</tr>
<tr>
<td>NOT, !</td>
<td>Negates value</td>
</tr>
<tr>
<td>OR,</td>
<td></td>
</tr>
<tr>
<td>XOR</td>
<td>Logical XOR</td>
</tr>
</tbody></table>
<p><strong>1. AND</strong></p>
<p>为 <code>WHERE</code> 子句附加条件，可以使用多个 and 附加条件，检索返回满足所有条件的行。例如，检索 products 表中 vender_id 为 1003 ，prod_price 小于等于 10 的数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_id, prod_price, prod_name</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where vend_id &#x3D; 1003 and prod_price &lt;&#x3D; 10;</span><br><span class="line">+---------+------------+----------------+</span><br><span class="line">| prod_id | prod_price | prod_name      |</span><br><span class="line">+---------+------------+----------------+</span><br><span class="line">| FB      |      10.00 | Bird seed      |</span><br><span class="line">| FC      |       2.50 | Carrots        |</span><br><span class="line">| SLING   |       4.49 | Sling          |</span><br><span class="line">| TNT1    |       2.50 | TNT (1 stick)  |</span><br><span class="line">| TNT2    |      10.00 | TNT (5 sticks) |</span><br><span class="line">+---------+------------+----------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>2. OR</strong></p>
<p>返回满足任意条件的行，可以使用多个 or 附加条件，检索返回满足任意一个条件的行。例如，检索 products 表中 vender_id 为 1003 或 1002 的数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_id, prod_price, prod_name</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where vend_id &#x3D; 1002 or vend_id &#x3D; 1003;</span><br><span class="line">+---------+------------+----------------+</span><br><span class="line">| prod_id | prod_price | prod_name      |</span><br><span class="line">+---------+------------+----------------+</span><br><span class="line">| FU1     |       3.42 | Fuses          |</span><br><span class="line">| OL1     |       8.99 | Oil can        |</span><br><span class="line">| DTNTR   |      13.00 | Detonator      |</span><br><span class="line">| FB      |      10.00 | Bird seed      |</span><br><span class="line">| FC      |       2.50 | Carrots        |</span><br><span class="line">| SAFE    |      50.00 | Safe           |</span><br><span class="line">| SLING   |       4.49 | Sling          |</span><br><span class="line">| TNT1    |       2.50 | TNT (1 stick)  |</span><br><span class="line">| TNT2    |      10.00 | TNT (5 sticks) |</span><br><span class="line">+---------+------------+----------------+</span><br><span class="line">9 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>3. 优先级</strong></p>
<p>where 子句中可以使用任意多个 and 和 or ，而 and 运算符的优先级大于 or 运算符，条件多的时候使用括号（<code>(</code>、<code>)</code>）进行分组。例如，检索 vender_id 为 1002 或 1003 的数据，同时满足 proc_price 大于等于 10 ：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_id, prod_price, prod_name</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where (vend_id &#x3D; 1002 or vend_id &#x3D; 1003) and prod_price &gt;&#x3D; 10;</span><br><span class="line">+---------+------------+----------------+</span><br><span class="line">| prod_id | prod_price | prod_name      |</span><br><span class="line">+---------+------------+----------------+</span><br><span class="line">| DTNTR   |      13.00 | Detonator      |</span><br><span class="line">| FB      |      10.00 | Bird seed      |</span><br><span class="line">| SAFE    |      50.00 | Safe           |</span><br><span class="line">| TNT2    |      10.00 | TNT (5 sticks) |</span><br><span class="line">+---------+------------+----------------+</span><br><span class="line">4 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h2 id="ORDER-BY"><a href="#ORDER-BY" class="headerlink" title="ORDER BY"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/order-by-optimization.html">ORDER BY</a></h2><p><code>ORDER BY</code> 可以根据一个或多个列对检索返回的结果进行排序。例如，从 products 表中检索 prod_name 列，按照 prod_name 列进行排序：</p>
<ul>
<li>可以指定没有被检索的列作为排序依据</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_name from products order by prod_name;</span><br><span class="line">+----------------+</span><br><span class="line">| prod_name      |</span><br><span class="line">+----------------+</span><br><span class="line">| .5 ton anvil   |</span><br><span class="line">| 1 ton anvil    |</span><br><span class="line">| 2 ton anvil    |</span><br><span class="line">| Bird seed      |</span><br><span class="line">| Carrots        |</span><br><span class="line">| Detonator      |</span><br><span class="line">| Fuses          |</span><br><span class="line">| JetPack 1000   |</span><br><span class="line">| JetPack 2000   |</span><br><span class="line">| Oil can        |</span><br><span class="line">| Safe           |</span><br><span class="line">| Sling          |</span><br><span class="line">| TNT (1 stick)  |</span><br><span class="line">| TNT (5 sticks) |</span><br><span class="line">+----------------+</span><br><span class="line">14 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>按多个列排序只需按顺序给出多个列名，<code>ORDER BY</code> 会按照指定的列的顺序比较，当前比较的列相同时才会去比较下一个列。例如，以下语句先按价格排序，然后再按名称排序：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_id,prod_price,prod_name from products order by prod_price,prod_name;</span><br><span class="line">+---------+------------+----------------+</span><br><span class="line">| prod_id | prod_price | prod_name      |</span><br><span class="line">+---------+------------+----------------+</span><br><span class="line">| FC      |       2.50 | Carrots        |</span><br><span class="line">| TNT1    |       2.50 | TNT (1 stick)  |</span><br><span class="line">| FU1     |       3.42 | Fuses          |</span><br><span class="line">| SLING   |       4.49 | Sling          |</span><br><span class="line">| ANV01   |       5.99 | .5 ton anvil   |</span><br><span class="line">| OL1     |       8.99 | Oil can        |</span><br><span class="line">| ANV02   |       9.99 | 1 ton anvil    |</span><br><span class="line">| FB      |      10.00 | Bird seed      |</span><br><span class="line">| TNT2    |      10.00 | TNT (5 sticks) |</span><br><span class="line">| DTNTR   |      13.00 | Detonator      |</span><br><span class="line">| ANV03   |      14.99 | 2 ton anvil    |</span><br><span class="line">| JP1000  |      35.00 | JetPack 1000   |</span><br><span class="line">| SAFE    |      50.00 | Safe           |</span><br><span class="line">| JP2000  |      55.00 | JetPack 2000   |</span><br><span class="line">+---------+------------+----------------+</span><br><span class="line">14 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>默认的排序顺序是升序（<code>ASC</code> 关键字），使用 <code>DESC</code> 关键字指定降序排列。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_name from products order by prod_name desc;</span><br><span class="line">+----------------+</span><br><span class="line">| prod_name      |</span><br><span class="line">+----------------+</span><br><span class="line">| TNT (5 sticks) |</span><br><span class="line">| TNT (1 stick)  |</span><br><span class="line">| Sling          |</span><br><span class="line">| Safe           |</span><br><span class="line">| Oil can        |</span><br><span class="line">| JetPack 2000   |</span><br><span class="line">| JetPack 1000   |</span><br><span class="line">| Fuses          |</span><br><span class="line">| Detonator      |</span><br><span class="line">| Carrots        |</span><br><span class="line">| Bird seed      |</span><br><span class="line">| 2 ton anvil    |</span><br><span class="line">| 1 ton anvil    |</span><br><span class="line">| .5 ton anvil   |</span><br><span class="line">+----------------+</span><br><span class="line">14 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><code>DESC</code> 关键字只应用位于其前面的列，当指定多个列排序时，可以用 <code>DESC</code> 指定需要降序排列的列，其余列默认升序排列。例如，以下语句按价格降序，名称升序排列：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_id,prod_price,prod_name from products order by prod_price desc,prod_name;</span><br><span class="line">+---------+------------+----------------+</span><br><span class="line">| prod_id | prod_price | prod_name      |</span><br><span class="line">+---------+------------+----------------+</span><br><span class="line">| JP2000  |      55.00 | JetPack 2000   |</span><br><span class="line">| SAFE    |      50.00 | Safe           |</span><br><span class="line">| JP1000  |      35.00 | JetPack 1000   |</span><br><span class="line">| ANV03   |      14.99 | 2 ton anvil    |</span><br><span class="line">| DTNTR   |      13.00 | Detonator      |</span><br><span class="line">| FB      |      10.00 | Bird seed      |</span><br><span class="line">| TNT2    |      10.00 | TNT (5 sticks) |</span><br><span class="line">| ANV02   |       9.99 | 1 ton anvil    |</span><br><span class="line">| OL1     |       8.99 | Oil can        |</span><br><span class="line">| ANV01   |       5.99 | .5 ton anvil   |</span><br><span class="line">| SLING   |       4.49 | Sling          |</span><br><span class="line">| FU1     |       3.42 | Fuses          |</span><br><span class="line">| FC      |       2.50 | Carrots        |</span><br><span class="line">| TNT1    |       2.50 | TNT (1 stick)  |</span><br><span class="line">+---------+------------+----------------+</span><br><span class="line">14 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><code>ORDER BY</code> 只能位于 <code>FROM</code> 子句之后，而 <code>LIMIT</code> 必须在 <code>ORDER BY</code> 之后。举个例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_price</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; order by prod_price desc</span><br><span class="line">    -&gt; limit 5;</span><br><span class="line">+------------+</span><br><span class="line">| prod_price |</span><br><span class="line">+------------+</span><br><span class="line">|      55.00 |</span><br><span class="line">|      50.00 |</span><br><span class="line">|      35.00 |</span><br><span class="line">|      14.99 |</span><br><span class="line">|      13.00 |</span><br><span class="line">+------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h2 id="Regular-Expressions"><a href="#Regular-Expressions" class="headerlink" title="Regular Expressions"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/regexp.html">Regular Expressions</a></h2><p>正则表达式是用来匹配文本的特殊的串（字符集合），用正则表达式语言构建。</p>
<p><strong>1. 基本字符匹配</strong></p>
<p><code>REGEXP</code> 后跟正则表达式，下列语句表示返回 prod_name 列中值匹配 <code>1000</code> 的数据，即值中任意位置包含 <code>1000</code> 就返回：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_name</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where prod_name regexp &#39;1000&#39;</span><br><span class="line">    -&gt; order by prod_name;</span><br><span class="line">+--------------+</span><br><span class="line">| prod_name    |</span><br><span class="line">+--------------+</span><br><span class="line">| JetPack 1000 |</span><br><span class="line">+--------------+</span><br><span class="line">1 row in set (0.01 sec)</span><br></pre></td></tr></table></figure>

<p>如果使用 <code>LIKE</code> 匹配，则执行的是完全匹配，即列中的值为 1000 ，而不是包含：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_name</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where prod_name like &#39;1000&#39;</span><br><span class="line">    -&gt; order by prod_name;</span><br><span class="line">Empty set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>正则表达式中，<code>.</code> 表示匹配任意一个字符，因此 2000 和 3000 都匹配 <code>.000</code> ：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_name</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where prod_name regexp &#39;.000&#39;</span><br><span class="line">    -&gt; order by prod_name;</span><br><span class="line">+--------------+</span><br><span class="line">| prod_name    |</span><br><span class="line">+--------------+</span><br><span class="line">| JetPack 1000 |</span><br><span class="line">| JetPack 2000 |</span><br><span class="line">+--------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>2. OR</strong></p>
<p>正则表达式中的或使用 <code>|</code> 表示，下列语句表示返回 prod_name 列中值包含 1000 或 2000 的数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_name</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where prod_name regexp &#39;1000|2000&#39;</span><br><span class="line">    -&gt; order by prod_name;</span><br><span class="line">+--------------+</span><br><span class="line">| prod_name    |</span><br><span class="line">+--------------+</span><br><span class="line">| JetPack 1000 |</span><br><span class="line">| JetPack 2000 |</span><br><span class="line">+--------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>3. 匹配几个字符之一</strong></p>
<p><code>[]</code> 是另一种形式的 OR 语句，<code>[123]</code> 相当于 <code>[1|2|3]</code> ：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_name</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where prod_name regexp &#39;[123] Ton&#39;</span><br><span class="line">    -&gt; order by prod_name;</span><br><span class="line">+-------------+</span><br><span class="line">| prod_name   |</span><br><span class="line">+-------------+</span><br><span class="line">| 1 ton anvil |</span><br><span class="line">| 2 ton anvil |</span><br><span class="line">+-------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><code>|</code> 默认应用于整个串，除非放置在集合中，<code>1|2|3 Ton</code> 表示匹配 1 或 2 或 3 Ton ：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_name</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where prod_name regexp &#39;1|2|3 Ton&#39;</span><br><span class="line">    -&gt; order by prod_name;</span><br><span class="line">+---------------+</span><br><span class="line">| prod_name     |</span><br><span class="line">+---------------+</span><br><span class="line">| 1 ton anvil   |</span><br><span class="line">| 2 ton anvil   |</span><br><span class="line">| JetPack 1000  |</span><br><span class="line">| JetPack 2000  |</span><br><span class="line">| TNT (1 stick) |</span><br><span class="line">+---------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>使用 <code>NOT</code> 可以获得相反的结果，即返回不匹配正则表达式的结果。例如，检索 products 表中 prod_name 不包含 1 或 2 或 3 的列：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_name</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where prod_name not regexp &#39;[123]&#39;</span><br><span class="line">    -&gt; order by prod_name;</span><br><span class="line">+----------------+</span><br><span class="line">| prod_name      |</span><br><span class="line">+----------------+</span><br><span class="line">| .5 ton anvil   |</span><br><span class="line">| Bird seed      |</span><br><span class="line">| Carrots        |</span><br><span class="line">| Detonator      |</span><br><span class="line">| Fuses          |</span><br><span class="line">| Oil can        |</span><br><span class="line">| Safe           |</span><br><span class="line">| Sling          |</span><br><span class="line">| TNT (5 sticks) |</span><br><span class="line">+----------------+</span><br><span class="line">9 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>4. 匹配范围</strong></p>
<p>使用 <code>-</code> 定义一个范围，<code>[1-5]</code> 表示匹配 1 ~ 5 共 5 个数字：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_name</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where prod_name regexp &#39;[1-5] Ton&#39;</span><br><span class="line">    -&gt; order by prod_name;</span><br><span class="line">+--------------+</span><br><span class="line">| prod_name    |</span><br><span class="line">+--------------+</span><br><span class="line">| .5 ton anvil |</span><br><span class="line">| 1 ton anvil  |</span><br><span class="line">| 2 ton anvil  |</span><br><span class="line">+--------------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>5. 匹配特殊字符</strong></p>
<p>正则表达式中的特殊字符必须使用 <code>\\</code> 为前导进行匹配</p>
<ul>
<li>这就是所谓的转义（escaping）</li>
<li><code>\\</code> 也用来引用元字符（具有特殊含义的字符）</li>
<li>使用 <code>\\\</code> 匹配反斜杠</li>
</ul>
<p>空白元字符</p>
<table>
<thead>
<tr>
<th>元字符</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>\f</td>
<td>换页</td>
</tr>
<tr>
<td>\n</td>
<td>换行</td>
</tr>
<tr>
<td>\r</td>
<td>回车</td>
</tr>
<tr>
<td>\t</td>
<td>制表</td>
</tr>
<tr>
<td>\v</td>
<td>纵向制表</td>
</tr>
</tbody></table>
<p>例如，匹配 <code>.</code> 的正则表达式为 <code>\\.</code> ：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select vend_name</span><br><span class="line">    -&gt; from vendors</span><br><span class="line">    -&gt; where vend_name regexp &#39;\\.&#39;</span><br><span class="line">    -&gt; order by vend_name;</span><br><span class="line">+--------------+</span><br><span class="line">| vend_name    |</span><br><span class="line">+--------------+</span><br><span class="line">| Furball Inc. |</span><br><span class="line">+--------------+</span><br><span class="line">1 row in set (0.01 sec)</span><br></pre></td></tr></table></figure>

<p><strong>6. 匹配字符类</strong></p>
<p>预定义的字符集，称为字符类（character class）</p>
<table>
<thead>
<tr>
<th>Character Class Name</th>
<th>Meaning</th>
</tr>
</thead>
<tbody><tr>
<td>alnum</td>
<td>Alphanumeric characters</td>
</tr>
<tr>
<td>alpha</td>
<td>Alphabetic characters</td>
</tr>
<tr>
<td>blank</td>
<td>Whitespace characters</td>
</tr>
<tr>
<td>cntrl</td>
<td>Control characters</td>
</tr>
<tr>
<td>digit</td>
<td>Digit characters</td>
</tr>
<tr>
<td>graph</td>
<td>Graphic characters</td>
</tr>
<tr>
<td>lower</td>
<td>Lowercase alphabetic characters</td>
</tr>
<tr>
<td>print</td>
<td>Graphic or space characters</td>
</tr>
<tr>
<td>punct</td>
<td>Punctuation characters</td>
</tr>
<tr>
<td>space</td>
<td>Space, tab, newline, and carriage return</td>
</tr>
<tr>
<td>upper</td>
<td>Uppercase alphabetic characters</td>
</tr>
<tr>
<td>xdigit</td>
<td>Hexadecimal digit characters</td>
</tr>
</tbody></table>
<p>使用 <code>[:alnum:]</code> 匹配字母和数字：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT REGEXP_LIKE(&#39;justalnums&#39;, &#39;[[:alnum:]]+&#39;);</span><br><span class="line">+-------------------------------------------+</span><br><span class="line">| REGEXP_LIKE(&#39;justalnums&#39;, &#39;[[:alnum:]]+&#39;) |</span><br><span class="line">+-------------------------------------------+</span><br><span class="line">|                                         1 |</span><br><span class="line">+-------------------------------------------+</span><br><span class="line">1 row in set (0.01 sec)</span><br></pre></td></tr></table></figure>

<p><strong>7. 重复元字符</strong></p>
<p>使用重复元字符匹配多次出现的字符，<code>*</code> 表示任意次匹配，也可以是 0 次；<code>+</code> 匹配一次及以上；<code>?</code> 表示字符可选，0 次或 1 次匹配。直接影响前面的单个字符或几何，例如，以下语句匹配 <code>stick</code> 或 <code>sticks</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT REGEXP_LIKE(&#39;Ban&#39;, &#39;^Ba*n&#39;);</span><br><span class="line">+-----------------------------+</span><br><span class="line">| REGEXP_LIKE(&#39;Ban&#39;, &#39;^Ba*n&#39;) |</span><br><span class="line">+-----------------------------+</span><br><span class="line">|                           1 |</span><br><span class="line">+-----------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT REGEXP_LIKE(&#39;Baaan&#39;, &#39;^Ba*n&#39;); </span><br><span class="line">+-------------------------------+</span><br><span class="line">| REGEXP_LIKE(&#39;Baaan&#39;, &#39;^Ba*n&#39;) |</span><br><span class="line">+-------------------------------+</span><br><span class="line">|                             1 |</span><br><span class="line">+-------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT REGEXP_LIKE(&#39;Ban&#39;, &#39;^Ba+n&#39;);</span><br><span class="line">+-----------------------------+</span><br><span class="line">| REGEXP_LIKE(&#39;Ban&#39;, &#39;^Ba+n&#39;) |</span><br><span class="line">+-----------------------------+</span><br><span class="line">|                           1 |</span><br><span class="line">+-----------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT REGEXP_LIKE(&#39;Bn&#39;, &#39;^Ba+n&#39;);</span><br><span class="line">+----------------------------+</span><br><span class="line">| REGEXP_LIKE(&#39;Bn&#39;, &#39;^Ba+n&#39;) |</span><br><span class="line">+----------------------------+</span><br><span class="line">|                          0 |</span><br><span class="line">+----------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select prod_name</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where prod_name regexp &#39;\\([0-9] sticks?\\)&#39;</span><br><span class="line">    -&gt; order by prod_name;</span><br><span class="line">+----------------+</span><br><span class="line">| prod_name      |</span><br><span class="line">+----------------+</span><br><span class="line">| TNT (1 stick)  |</span><br><span class="line">| TNT (5 sticks) |</span><br><span class="line">+----------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><code>[[:digit:]]&#123;4&#125;</code> 表示匹配任意 4 位数字，等同于使用 <code>[0-9][0-9][0-9][0-9]</code> ：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_name</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where prod_name regexp &#39;[[:digit:]]&#123;4&#125;&#39;</span><br><span class="line">    -&gt; order by prod_name;</span><br><span class="line">+--------------+</span><br><span class="line">| prod_name    |</span><br><span class="line">+--------------+</span><br><span class="line">| JetPack 1000 |</span><br><span class="line">| JetPack 2000 |</span><br><span class="line">+--------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>8. 定位符</strong></p>
<p>使用定位符匹配特定位置的文本，<code>^</code> 匹配串的开始，用在集合中表示否定（<code>[]</code>）；<br><code>$</code> 匹配串结尾。例如，匹配任意以数字或 <code>.</code> 开头的字符串：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_name</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where prod_name regexp &#39;^[0-9\\.]&#39;</span><br><span class="line">    -&gt; order by prod_name;</span><br><span class="line">+--------------+</span><br><span class="line">| prod_name    |</span><br><span class="line">+--------------+</span><br><span class="line">| .5 ton anvil |</span><br><span class="line">| 1 ton anvil  |</span><br><span class="line">| 2 ton anvil  |</span><br><span class="line">+--------------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>9. SELECT 语句中测试</strong></p>
<p>使用 <code>SELECT</code> 测试正则表达式，<code>REGEXP</code> 检查总是返回 0 或 1 ：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select &#39;hello&#39; regexp &#39;[a-h]&#39;;</span><br><span class="line">+------------------------+</span><br><span class="line">| &#39;hello&#39; regexp &#39;[a-h]&#39; |</span><br><span class="line">+------------------------+</span><br><span class="line">|                      1 |</span><br><span class="line">+------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h2 id="计算字段"><a href="#计算字段" class="headerlink" title="计算字段"></a>计算字段</h2><p>计算字段是运行时在 <code>SELECT</code> 语句内创建的。</p>
<h3 id="拼接字段"><a href="#拼接字段" class="headerlink" title="拼接字段"></a>拼接字段</h3><p>拼接是指将值连接到一起构成单个值，MySQL 中可以使用 <code>Concat()</code> 函数来拼接两个列：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select Concat(vend_name, &#39;(&#39;, vend_country, &#39;)&#39;)</span><br><span class="line">    -&gt; from vendors</span><br><span class="line">    -&gt; order by vend_name;</span><br><span class="line">+-------------------------------------------+</span><br><span class="line">| Concat(vend_name, &#39;(&#39;, vend_country, &#39;)&#39;) |</span><br><span class="line">+-------------------------------------------+</span><br><span class="line">| ACME(USA)                                 |</span><br><span class="line">| Anvils R Us(USA)                          |</span><br><span class="line">| Furball Inc.(USA)                         |</span><br><span class="line">| Jet Set(England)                          |</span><br><span class="line">| Jouets Et Ours(France)                    |</span><br><span class="line">| LT Supplies(USA)                          |</span><br><span class="line">+-------------------------------------------+</span><br><span class="line">6 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>删除右侧多余的空格使用 <code>RTrim()</code> 函数：</p>
<ul>
<li><code>LTrim()</code> 去除右侧多余的空格</li>
<li><code>Trim()</code> 去除左右两侧的空格</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select Concat(RTrim(vend_name), &#39;(&#39;, RTrim(vend_country), &#39;)&#39;)</span><br><span class="line">    -&gt; from vendors</span><br><span class="line">    -&gt; order by vend_name;</span><br><span class="line">+---------------------------------------------------------+</span><br><span class="line">| Concat(RTrim(vend_name), &#39;(&#39;, RTrim(vend_country), &#39;)&#39;) |</span><br><span class="line">+---------------------------------------------------------+</span><br><span class="line">| ACME(USA)                                               |</span><br><span class="line">| Anvils R Us(USA)                                        |</span><br><span class="line">| Furball Inc.(USA)                                       |</span><br><span class="line">| Jet Set(England)                                        |</span><br><span class="line">| Jouets Et Ours(France)                                  |</span><br><span class="line">| LT Supplies(USA)                                        |</span><br><span class="line">+---------------------------------------------------------+</span><br><span class="line">6 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="使用别名"><a href="#使用别名" class="headerlink" title="使用别名"></a>使用别名</h3><p>别名（alias）是一个字段或值的替换名，别名使用 <code>AS</code> 关键字指定：</p>
<ul>
<li>当不同的表名容易混淆时，使用别名进行区分</li>
<li>别名也称为导出列（derived column）</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select Concat(RTrim(vend_name), &#39;(&#39;, RTrim(vend_country), &#39;)&#39;)</span><br><span class="line">    -&gt; as vend_title</span><br><span class="line">    -&gt; from vendors</span><br><span class="line">    -&gt; order by vend_name;</span><br><span class="line">+------------------------+</span><br><span class="line">| vend_title             |</span><br><span class="line">+------------------------+</span><br><span class="line">| ACME(USA)              |</span><br><span class="line">| Anvils R Us(USA)       |</span><br><span class="line">| Furball Inc.(USA)      |</span><br><span class="line">| Jet Set(England)       |</span><br><span class="line">| Jouets Et Ours(France) |</span><br><span class="line">| LT Supplies(USA)       |</span><br><span class="line">+------------------------+</span><br><span class="line">6 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="执行算数计算"><a href="#执行算数计算" class="headerlink" title="执行算数计算"></a>执行算数计算</h3><p>对检索出的数据进行算术计算，例如，以下语句汇总物品的价格，并起名为 expanded_price ，这就是一个计算字段：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_id,</span><br><span class="line">    -&gt; quantity,</span><br><span class="line">    -&gt; item_price, </span><br><span class="line">    -&gt; quantity*item_price as expanded_price</span><br><span class="line">    -&gt; from orderitems</span><br><span class="line">    -&gt; where order_num &#x3D; 20005;</span><br><span class="line">+---------+----------+------------+----------------+</span><br><span class="line">| prod_id | quantity | item_price | expanded_price |</span><br><span class="line">+---------+----------+------------+----------------+</span><br><span class="line">| ANV01   |       10 |       5.99 |          59.90 |</span><br><span class="line">| ANV02   |        3 |       9.99 |          29.97 |</span><br><span class="line">| TNT2    |        5 |      10.00 |          50.00 |</span><br><span class="line">| FB      |        1 |      10.00 |          10.00 |</span><br><span class="line">+---------+----------+------------+----------------+</span><br><span class="line">4 rows in set (0.01 sec)</span><br></pre></td></tr></table></figure>

<p>MySQL 支持的基本算术操作符：</p>
<table>
<thead>
<tr>
<th>操作符</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>+</td>
<td>加</td>
</tr>
<tr>
<td>-</td>
<td>减</td>
</tr>
<tr>
<td>*</td>
<td>乘</td>
</tr>
<tr>
<td>/</td>
<td>除</td>
</tr>
</tbody></table>
<p><strong>SELECT 语句中测试</strong></p>
<p>可以省略 <code>FROM</code> 语句在 <code>SELECT</code> 中测试表达式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"># 算术运算</span><br><span class="line">mysql&gt; select 3*2;</span><br><span class="line">+-----+</span><br><span class="line">| 3*2 |</span><br><span class="line">+-----+</span><br><span class="line">|   6 |</span><br><span class="line">+-----+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 去除左右的空格</span><br><span class="line">mysql&gt; select Trim(&#39; abc   &#39;);</span><br><span class="line">+-----------------+</span><br><span class="line">| Trim(&#39; abc   &#39;) |</span><br><span class="line">+-----------------+</span><br><span class="line">| abc             |</span><br><span class="line">+-----------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 返回当前日期和时间</span><br><span class="line">mysql&gt; select Now();</span><br><span class="line">+---------------------+</span><br><span class="line">| Now()               |</span><br><span class="line">+---------------------+</span><br><span class="line">| 2020-11-22 12:43:14 |</span><br><span class="line">+---------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h2 id="函数（Functions-and-Operators）"><a href="#函数（Functions-and-Operators）" class="headerlink" title="函数（Functions and Operators）"></a>函数（<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/functions.html">Functions and Operators</a>）</h2><h3 id="文本函数"><a href="#文本函数" class="headerlink" title="文本函数"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/string-functions.html">文本函数</a></h3><p><code>Upper()</code> 用于将文本转换为大写，例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select vend_name,</span><br><span class="line">    -&gt; Upper(vend_name) as vend_name_upcase</span><br><span class="line">    -&gt; from vendors</span><br><span class="line">    -&gt; order by vend_name;</span><br><span class="line">+----------------+------------------+</span><br><span class="line">| vend_name      | vend_name_upcase |</span><br><span class="line">+----------------+------------------+</span><br><span class="line">| ACME           | ACME             |</span><br><span class="line">| Anvils R Us    | ANVILS R US      |</span><br><span class="line">| Furball Inc.   | FURBALL INC.     |</span><br><span class="line">| Jet Set        | JET SET          |</span><br><span class="line">| Jouets Et Ours | JOUETS ET OURS   |</span><br><span class="line">| LT Supplies    | LT SUPPLIES      |</span><br><span class="line">+----------------+------------------+</span><br><span class="line">6 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><code>Soundex()</code> 函数将文本串转换为描述其语音表示的字母数字模式，可以根据发音字符和音节比较字符串。例如，<code>Y.Lee</code> 和 <code>Y.Lie</code> 的发音相似，因此匹配成功：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select cust_name, cust_contact</span><br><span class="line">    -&gt; from customers</span><br><span class="line">    -&gt; where Soundex(cust_contact) &#x3D; Soundex(&#39;Y Lie&#39;);</span><br><span class="line">+-------------+--------------+</span><br><span class="line">| cust_name   | cust_contact |</span><br><span class="line">+-------------+--------------+</span><br><span class="line">| Coyote Inc. | Y Lee        |</span><br><span class="line">+-------------+--------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="数学函数"><a href="#数学函数" class="headerlink" title="数学函数"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/numeric-functions.html">数学函数</a></h3><table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>ABS()</td>
<td>Return the absolute value</td>
</tr>
<tr>
<td>ACOS()</td>
<td>Return the arc cosine</td>
</tr>
<tr>
<td>ASIN()</td>
<td>Return the arc sine</td>
</tr>
<tr>
<td>ATAN()</td>
<td>Return the arc tangent</td>
</tr>
<tr>
<td>ATAN2(), ATAN()</td>
<td>Return the arc tangent of the two arguments</td>
</tr>
<tr>
<td>CEIL()</td>
<td>Return the smallest integer value not less than the argument</td>
</tr>
<tr>
<td>CEILING()</td>
<td>Return the smallest integer value not less than the argument</td>
</tr>
<tr>
<td>CONV()</td>
<td>Convert numbers between different number bases</td>
</tr>
<tr>
<td>COS()</td>
<td>Return the cosine</td>
</tr>
<tr>
<td>COT()</td>
<td>Return the cotangent</td>
</tr>
<tr>
<td>CRC32()</td>
<td>Compute a cyclic redundancy check value</td>
</tr>
<tr>
<td>DEGREES()</td>
<td>Convert radians to degrees</td>
</tr>
<tr>
<td>EXP()</td>
<td>Raise to the power of</td>
</tr>
<tr>
<td>FLOOR()</td>
<td>Return the largest integer value not greater than the argument</td>
</tr>
<tr>
<td>LN()</td>
<td>Return the natural logarithm of the argument</td>
</tr>
<tr>
<td>LOG()</td>
<td>Return the natural logarithm of the first argument</td>
</tr>
<tr>
<td>LOG10()</td>
<td>Return the base-10 logarithm of the argument</td>
</tr>
<tr>
<td>LOG2()</td>
<td>Return the base-2 logarithm of the argument</td>
</tr>
<tr>
<td>MOD()</td>
<td>Return the remainder</td>
</tr>
<tr>
<td>PI()</td>
<td>Return the value of pi</td>
</tr>
<tr>
<td>POW()</td>
<td>Return the argument raised to the specified power</td>
</tr>
<tr>
<td>POWER()</td>
<td>Return the argument raised to the specified power</td>
</tr>
<tr>
<td>RADIANS()</td>
<td>Return argument converted to radians</td>
</tr>
<tr>
<td>RAND()</td>
<td>Return a random floating-point value</td>
</tr>
<tr>
<td>ROUND()</td>
<td>Round the argument</td>
</tr>
<tr>
<td>SIGN()</td>
<td>Return the sign of the argument</td>
</tr>
<tr>
<td>SIN()</td>
<td>Return the sine of the argument</td>
</tr>
<tr>
<td>SQRT()</td>
<td>Return the square root of the argument</td>
</tr>
<tr>
<td>TAN()</td>
<td>Return the tangent of the argument</td>
</tr>
<tr>
<td>TRUNCATE()</td>
<td>Truncate to specified number of decimal places</td>
</tr>
</tbody></table>
<p>数学函数主要用于代数或几何运算，可以直接在 <code>SELECT</code> 语句中进行测试，例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"># 取整</span><br><span class="line">mysql&gt; SELECT CEILING(1.23);</span><br><span class="line">+---------------+</span><br><span class="line">| CEILING(1.23) |</span><br><span class="line">+---------------+</span><br><span class="line">|             2 |</span><br><span class="line">+---------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 取模</span><br><span class="line">mysql&gt; SELECT MOD(29,9);</span><br><span class="line">+-----------+</span><br><span class="line">| MOD(29,9) |</span><br><span class="line">+-----------+</span><br><span class="line">|         2 |</span><br><span class="line">+-----------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 取模</span><br><span class="line">mysql&gt; SELECT 29 MOD 9;</span><br><span class="line">+----------+</span><br><span class="line">| 29 MOD 9 |</span><br><span class="line">+----------+</span><br><span class="line">|        2 |</span><br><span class="line">+----------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="时间和日期函数"><a href="#时间和日期函数" class="headerlink" title="时间和日期函数"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/date-and-time-functions.html">时间和日期函数</a></h3><p>时间和日期采用相应的数据类型和特殊的格式存储，因此能够快速和有效地排序或过滤，并节省物理存储空间。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/date-and-time-types.html">时间和日期类型</a></li>
</ul>
<p>MySQL 中的日期格式必须为 <code>yyyy-mm-dd</code> ，基本的日期使用如下，但是这只能匹配 order_date 为 <code>2005-09-01</code> 的数据，而不能匹配 <code>2005-09-01 11:30:05</code> ：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select cust_id, order_num</span><br><span class="line">    -&gt; from orders</span><br><span class="line">    -&gt; where order_date &#x3D; &#39;2005-09-01&#39;;</span><br><span class="line">+---------+-----------+</span><br><span class="line">| cust_id | order_num |</span><br><span class="line">+---------+-----------+</span><br><span class="line">|   10001 |     20005 |</span><br><span class="line">+---------+-----------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>使用 <code>Date()</code> 函数可以提取日期部分，因此以下写法更为可靠：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select cust_id, order_num</span><br><span class="line">    -&gt; from orders</span><br><span class="line">    -&gt; where Date(order_date) &#x3D; &#39;2005-09-01&#39;;</span><br><span class="line">+---------+-----------+</span><br><span class="line">| cust_id | order_num |</span><br><span class="line">+---------+-----------+</span><br><span class="line">|   10001 |     20005 |</span><br><span class="line">+---------+-----------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>结合 <code>BETWEEN ... AND ...</code> 可以检索时间范围（需要记住每个月的天数和闰年 2 月）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select cust_id, order_num</span><br><span class="line">    -&gt; from orders</span><br><span class="line">    -&gt; where Date(order_date) between &#39;2005-09-01&#39; and &#39;2005-09-30&#39;;</span><br><span class="line">+---------+-----------+</span><br><span class="line">| cust_id | order_num |</span><br><span class="line">+---------+-----------+</span><br><span class="line">|   10001 |     20005 |</span><br><span class="line">|   10003 |     20006 |</span><br><span class="line">|   10004 |     20007 |</span><br><span class="line">+---------+-----------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>使用 <code>Year()</code> 和 <code>Month()</code> 函数可以指定年份和月份，这样就无需自己记住每个月的天数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select cust_id, order_num</span><br><span class="line">    -&gt; from orders</span><br><span class="line">    -&gt; where Year(order_date) &#x3D; 2005 and Month(order_date) &#x3D; 9;</span><br><span class="line">+---------+-----------+</span><br><span class="line">| cust_id | order_num |</span><br><span class="line">+---------+-----------+</span><br><span class="line">|   10001 |     20005 |</span><br><span class="line">|   10003 |     20006 |</span><br><span class="line">|   10004 |     20007 |</span><br><span class="line">+---------+-----------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h2 id="聚集函数"><a href="#聚集函数" class="headerlink" title="聚集函数"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/aggregate-functions.html">聚集函数</a></h2><p>聚集函数（aggregate function）用于对一组值进行操作，通常与 <code>GROUP BY</code> 子句一起使用，将值分组为子集。</p>
<h3 id="AVG"><a href="#AVG" class="headerlink" title="AVG()"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/aggregate-functions.html#function_avg">AVG()</a></h3><p><code>AVG()</code> 通过对表中的行数计数，并计算特定列值之和，以求得该列的平均值。<code>AVG()</code> 可以用来返回特定列的平均值，也可以返回所有列的平均值。</p>
<ul>
<li>只能用来计算数值列</li>
<li>忽略列值为 NULL 的行</li>
</ul>
<p>计算 products 表中 product_price 列的平均值：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select AVG(prod_price) AS avg_price</span><br><span class="line">    -&gt; FROM products;</span><br><span class="line">+-----------+</span><br><span class="line">| avg_price |</span><br><span class="line">+-----------+</span><br><span class="line">| 16.133571 |</span><br><span class="line">+-----------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>确定特定列或行的平均值：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select AVG(prod_price) AS avg_price</span><br><span class="line">    -&gt; FROM products</span><br><span class="line">    -&gt; WHERE vend_id &#x3D; 1003;</span><br><span class="line">+-----------+</span><br><span class="line">| avg_price |</span><br><span class="line">+-----------+</span><br><span class="line">| 13.212857 |</span><br><span class="line">+-----------+</span><br><span class="line">1 row in set (0.01 sec)</span><br></pre></td></tr></table></figure>

<h3 id="COUNT"><a href="#COUNT" class="headerlink" title="COUNT()"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/aggregate-functions.html#function_count">COUNT()</a></h3><p><code>COUNT()</code> 函数可以用来确定（符合条件的）行数。</p>
<ul>
<li><code>COUNT(*)</code> 对表中行的数目计数，无论空值还是 NULL 值</li>
<li><code>COUNT(cloumn)</code> 对特定列中具有值的行计数，忽略 NULL 值</li>
</ul>
<p>返回 customers 表中客户的总数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select count(*) as num_cust</span><br><span class="line">    -&gt; from customers;</span><br><span class="line">+----------+</span><br><span class="line">| num_cust |</span><br><span class="line">+----------+</span><br><span class="line">|        5 |</span><br><span class="line">+----------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>返回 customers 表中具有电子邮件的客户的总数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select count(cust_email) as num_cust</span><br><span class="line">    -&gt; from customers;</span><br><span class="line">+----------+</span><br><span class="line">| num_cust |</span><br><span class="line">+----------+</span><br><span class="line">|        3 |</span><br><span class="line">+----------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="MAX"><a href="#MAX" class="headerlink" title="MAX()"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/aggregate-functions.html#function_max">MAX()</a></h3><p><code>MAX()</code> 函数返回指定列中的最大值，忽略列值为 NULL 的行。例如，检索 products 表中最贵的物品的价格：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select max(prod_price) as max_price</span><br><span class="line">    -&gt; from products;</span><br><span class="line">+-----------+</span><br><span class="line">| max_price |</span><br><span class="line">+-----------+</span><br><span class="line">|     55.00 |</span><br><span class="line">+-----------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="MIN"><a href="#MIN" class="headerlink" title="MIN()"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/aggregate-functions.html#function_min">MIN()</a></h3><p><code>MIN()</code> 函数返回指定列中的最小值，忽略列值为 NULL 的行。例如，检索 products 表中最便宜的物品的价格：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select min(prod_price) as max_price</span><br><span class="line">    -&gt; from products;</span><br><span class="line">+-----------+</span><br><span class="line">| max_price |</span><br><span class="line">+-----------+</span><br><span class="line">|      2.50 |</span><br><span class="line">+-----------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="SUM"><a href="#SUM" class="headerlink" title="SUM()"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/aggregate-functions.html#function_sum">SUM()</a></h3><p><code>SUM()</code> 函数用来返回指定列值的总和，忽略列值为 NULL 的行。例如，检索订单号为 20005 的订单中所有物品数量之和：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select sum(quantity) as items_ordered</span><br><span class="line">    -&gt; from orderitems</span><br><span class="line">    -&gt; where order_num &#x3D; 20005;</span><br><span class="line">+---------------+</span><br><span class="line">| items_ordered |</span><br><span class="line">+---------------+</span><br><span class="line">|            19 |</span><br><span class="line">+---------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><code>SUM()</code> 也可以用来合计计算值，例如 <code>item_price*quantity</code> 表示统计总金额：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select sum(item_price*quantity) as total_price</span><br><span class="line">    -&gt; from orderitems</span><br><span class="line">    -&gt; where order_num &#x3D; 20005;</span><br><span class="line">+-------------+</span><br><span class="line">| total_price |</span><br><span class="line">+-------------+</span><br><span class="line">|      149.87 |</span><br><span class="line">+-------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="ALL-DISTINCT"><a href="#ALL-DISTINCT" class="headerlink" title="ALL | DISTINCT"></a>ALL | DISTINCT</h3><p>上一节中的 5 个聚集函数都可以结合 <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/all-subqueries.html"><code>ALL</code></a> 或 <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/distinct-optimization.html"><code>DISTINCT</code></a> 使用。</p>
<ul>
<li>默认对所有的行执行计算，<code>ALL</code> 参数可以不用显式指定</li>
<li>针对包含不同值的行计算，指定 <code>DISTINCT</code> 参数<ul>
<li>不能用于 <code>COUNT(*)</code> ，即不允许使用 <code>COUNT(DISTINCT)</code></li>
<li>必须指定列名，不能用于计算或表达式</li>
</ul>
</li>
</ul>
<p>例如，返回 products 表中 vend_id 为 1003 的供应商提供的产品的平均价格，只考虑不同价格的产品：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select avg(DISTINCT prod_price) as avg_price</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where vend_id &#x3D; 1003;</span><br><span class="line">+-----------+</span><br><span class="line">| avg_price |</span><br><span class="line">+-----------+</span><br><span class="line">| 15.998000 |</span><br><span class="line">+-----------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="组合聚集函数"><a href="#组合聚集函数" class="headerlink" title="组合聚集函数"></a>组合聚集函数</h3><p><code>SELECT</code> 语句可以包含多个聚集函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select count(*) as num_items,</span><br><span class="line">    -&gt; min(prod_price) as price_min,</span><br><span class="line">    -&gt; max(prod_price) as price_max,</span><br><span class="line">    -&gt; avg(prod_price) as price_avg</span><br><span class="line">    -&gt; from products;</span><br><span class="line">+-----------+-----------+-----------+-----------+</span><br><span class="line">| num_items | price_min | price_max | price_avg |</span><br><span class="line">+-----------+-----------+-----------+-----------+</span><br><span class="line">|        14 |      2.50 |     55.00 | 16.133571 |</span><br><span class="line">+-----------+-----------+-----------+-----------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h2 id="数据分组"><a href="#数据分组" class="headerlink" title="数据分组"></a>数据分组</h2><p>分组允许把数据分为多个逻辑组，以便能对每个组进行聚集计算。</p>
<h3 id="GROUP-BY"><a href="#GROUP-BY" class="headerlink" title="GROUP BY"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/group-by-modifiers.html">GROUP BY</a></h3><p>使用 <code>GROUP BY</code> 对数据进行分组，例如，针对 vend_id 进行分组并统计每组的数量：</p>
<ul>
<li>可以包含任意数目的列</li>
<li>嵌套分组将在最后规定的分组上进行汇总</li>
<li>每个列必须都是检索列或有效的表达式<ul>
<li>如果在 <code>SELECT</code> 语句中使用表达式，则必须在 <code>GROUP BY</code> 中指定相同的表达式（不能使用别名）</li>
</ul>
</li>
<li>除了聚集计算语句外，<code>SELECT</code> 语句中的每个列都必须在 <code>GROUP BY</code> 子句中给出</li>
<li>如果分组列中具有 NULL 值，则 NULL 作为一个分组返回</li>
<li><code>GROUP BY</code> 子句必须在 <code>WHERE</code> 子句之后，<code>ORDER BY</code> 子句之前</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select vend_id, count(*) as num_prods</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; group by vend_id;</span><br><span class="line">+---------+-----------+</span><br><span class="line">| vend_id | num_prods |</span><br><span class="line">+---------+-----------+</span><br><span class="line">|    1001 |         3 |</span><br><span class="line">|    1002 |         2 |</span><br><span class="line">|    1003 |         7 |</span><br><span class="line">|    1005 |         2 |</span><br><span class="line">+---------+-----------+</span><br><span class="line">4 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>1. WITH ROLLUP</strong></p>
<p>使用 <code>WITH ROLLUP</code> 关键字可以得到每个分组以及每个分组汇总的值，例如，显示产品数量的总值：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select vend_id, count(*) as num_prods</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; group by vend_id with rollup;</span><br><span class="line">+---------+-----------+</span><br><span class="line">| vend_id | num_prods |</span><br><span class="line">+---------+-----------+</span><br><span class="line">|    1001 |         3 |</span><br><span class="line">|    1002 |         2 |</span><br><span class="line">|    1003 |         7 |</span><br><span class="line">|    1005 |         2 |</span><br><span class="line">|    NULL |        14 |</span><br><span class="line">+---------+-----------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>2. HAVING</strong></p>
<p>使用 <code>HAVING</code> 关键字对分组进行过滤，在数据分组后进行过滤。</p>
<ul>
<li><code>WHERE</code> 关键字过滤行，在数据分组前进行过滤</li>
</ul>
<p>例如，检索 orders 表中拥有 2 个及以上订单的用户：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select cust_id, count(*) as orders</span><br><span class="line">    -&gt; from orders</span><br><span class="line">    -&gt; group by cust_id</span><br><span class="line">    -&gt; having count(*) &gt;&#x3D; 2;</span><br><span class="line">+---------+--------+</span><br><span class="line">| cust_id | orders |</span><br><span class="line">+---------+--------+</span><br><span class="line">|   10001 |      2 |</span><br><span class="line">+---------+--------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>同时使用 <code>WHERE</code> 和 <code>HAVING</code> 检索包含 2 个及以上价格大于等于 10 的产品的供应商：</p>
<ul>
<li>先检索价格大于等于 10 的产品</li>
<li>再分组聚集，根据条件返回</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select vend_id, count(*) as num_prods</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where prod_price &gt;&#x3D; 10</span><br><span class="line">    -&gt; group by vend_id</span><br><span class="line">    -&gt; having count(*) &gt;&#x3D; 2;</span><br><span class="line">+---------+-----------+</span><br><span class="line">| vend_id | num_prods |</span><br><span class="line">+---------+-----------+</span><br><span class="line">|    1003 |         4 |</span><br><span class="line">|    1005 |         2 |</span><br><span class="line">+---------+-----------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>3. ORDER BY</strong></p>
<p>一般在使用 <code>GROUP BY</code> 子句时会结合 <code>ORDER BY</code> ，以保证数据正确排序。</p>
<table>
<thead>
<tr>
<th>ORDER BY</th>
<th>GROUP BY</th>
</tr>
</thead>
<tbody><tr>
<td>排序产生的输出</td>
<td>分组行，输出可能不是分组的顺序</td>
</tr>
<tr>
<td>任意列都可以使用，没有选择的列也可以使用</td>
<td>只能使用选择列或表达式列，且必须使用每个选择列表达式</td>
</tr>
<tr>
<td>不一定需要使用</td>
<td>如果与聚集函数一起使用列（或表达式），则必须使用</td>
</tr>
</tbody></table>
<p>例如，检索订单价格大于等于 50 的订单及其总价：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select order_num, sum(quantity*item_price) as ordertotal</span><br><span class="line">    -&gt; from orderitems</span><br><span class="line">    -&gt; group by order_num</span><br><span class="line">    -&gt; having sum(quantity*item_price) &gt;&#x3D; 50;</span><br><span class="line">+-----------+------------+</span><br><span class="line">| order_num | ordertotal |</span><br><span class="line">+-----------+------------+</span><br><span class="line">|     20005 |     149.87 |</span><br><span class="line">|     20006 |      55.00 |</span><br><span class="line">|     20007 |    1000.00 |</span><br><span class="line">|     20008 |     125.00 |</span><br><span class="line">+-----------+------------+</span><br><span class="line">4 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>使用 <code>ORDER BY</code> 按订单总价排序：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select order_num, sum(quantity*item_price) as ordertotal</span><br><span class="line">    -&gt; from orderitems</span><br><span class="line">    -&gt; group by order_num</span><br><span class="line">    -&gt; having sum(quantity*item_price) &gt;&#x3D; 50</span><br><span class="line">    -&gt; order by ordertotal;</span><br><span class="line">+-----------+------------+</span><br><span class="line">| order_num | ordertotal |</span><br><span class="line">+-----------+------------+</span><br><span class="line">|     20006 |      55.00 |</span><br><span class="line">|     20008 |     125.00 |</span><br><span class="line">|     20005 |     149.87 |</span><br><span class="line">|     20007 |    1000.00 |</span><br><span class="line">+-----------+------------+</span><br><span class="line">4 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="SELECT-子句顺序"><a href="#SELECT-子句顺序" class="headerlink" title="SELECT 子句顺序"></a>SELECT 子句顺序</h3><table>
<thead>
<tr>
<th>子句</th>
<th>说明</th>
<th>是否必须使用</th>
</tr>
</thead>
<tbody><tr>
<td>select</td>
<td>要返回的列或表达式</td>
<td>是</td>
</tr>
<tr>
<td>from</td>
<td>从中检索的数据表</td>
<td>仅在从表中选择数据时使用</td>
</tr>
<tr>
<td>where</td>
<td>行级过滤</td>
<td>否</td>
</tr>
<tr>
<td>group by</td>
<td>分组说明</td>
<td>仅在按组计算聚集时使用</td>
</tr>
<tr>
<td>having</td>
<td>组级过滤</td>
<td>否</td>
</tr>
<tr>
<td>order by</td>
<td>输出排序顺序</td>
<td>否</td>
</tr>
<tr>
<td>limit</td>
<td>限制检索的行数</td>
<td>否</td>
</tr>
</tbody></table>
<h2 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/subqueries.html">子查询</a></h2><p>子查询（subquery）是指嵌套在其他语句中的查询语句。在 <code>SELECT</code> 语句中，子查询总是从内向外处理。</p>
<h3 id="过滤"><a href="#过滤" class="headerlink" title="过滤"></a>过滤</h3><p>可以把一条 <code>SELECT</code> 语句返回的结果用在另一条 <code>SELECT</code> 语句的 <code>WHERE</code> 子句中。例如，根据订单号检索购买了 TNT2 的客户：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select cust_id</span><br><span class="line">    -&gt; from orders</span><br><span class="line">    -&gt; where order_num in(</span><br><span class="line">    -&gt;   select order_num</span><br><span class="line">    -&gt;   from orderitems</span><br><span class="line">    -&gt;   where prod_id &#x3D; &#39;TNT2&#39;);</span><br><span class="line">+---------+</span><br><span class="line">| cust_id |</span><br><span class="line">+---------+</span><br><span class="line">|   10001 |</span><br><span class="line">|   10004 |</span><br><span class="line">+---------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>嵌套多个子查询，根据订单号检索购买了 TNT2 的客户，再根据客户 ID 检索客户的姓名：</p>
<ul>
<li>在 <code>WHERE</code> 子句中使用子查询，应该保证 <code>SELECT</code> 语句和 <code>WHERE</code> 子句具有相同数目的列</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select cust_name, cust_contact</span><br><span class="line">    -&gt; from customers</span><br><span class="line">    -&gt; where cust_id in(</span><br><span class="line">    -&gt;   select cust_id</span><br><span class="line">    -&gt;   from orders</span><br><span class="line">    -&gt;   where order_num in(</span><br><span class="line">    -&gt;     select order_num</span><br><span class="line">    -&gt;     from orderitems</span><br><span class="line">    -&gt;     where prod_id &#x3D; &#39;TNT2&#39;));</span><br><span class="line">+----------------+--------------+</span><br><span class="line">| cust_name      | cust_contact |</span><br><span class="line">+----------------+--------------+</span><br><span class="line">| Coyote Inc.    | Y Lee        |</span><br><span class="line">| Yosemite Place | Y Sam        |</span><br><span class="line">+----------------+--------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="作为计算字段"><a href="#作为计算字段" class="headerlink" title="作为计算字段"></a>作为计算字段</h3><p>对 customers 表中每个客户返回 3 列：cust_name, cust_state, orders：</p>
<ul>
<li><code>orders</code> 是由子查询建立的计算字段</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select cust_name, </span><br><span class="line">    -&gt; cust_state,</span><br><span class="line">    -&gt; (select count(*)</span><br><span class="line">    -&gt; from orders</span><br><span class="line">    -&gt; where orders.cust_id&#x3D;customers.cust_id) as orders</span><br><span class="line">    -&gt; from customers</span><br><span class="line">    -&gt; order by cust_name;</span><br><span class="line">+----------------+------------+--------+</span><br><span class="line">| cust_name      | cust_state | orders |</span><br><span class="line">+----------------+------------+--------+</span><br><span class="line">| Coyote Inc.    | MI         |      2 |</span><br><span class="line">| E Fudd         | IL         |      1 |</span><br><span class="line">| Mouse House    | OH         |      0 |</span><br><span class="line">| Wascals        | IN         |      1 |</span><br><span class="line">| Yosemite Place | AZ         |      1 |</span><br><span class="line">+----------------+------------+--------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>相关子查询（<a href="(https://dev.mysql.com/doc/refman/8.0/en/correlated-subqueries.html)">Correlated Subqueries</a>）是涉及外部查询的子查询。当列名具有多义性时，必须使用完全限定的名称（以 <code>.</code> 分隔）。</p>
<h2 id="连接（JOIN）"><a href="#连接（JOIN）" class="headerlink" title="连接（JOIN）"></a>连接（<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/join.html">JOIN</a>）</h2><p>关系表的设计就是要保证把信息分解成多个表，一类数据一张表，每个表通过关系（relation）关联。通常，关系数据库的可伸缩性比非关系数据库要好。</p>
<ul>
<li>主键（<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/primary-key-optimization.html">PRIMARY KEY</a>），唯一标识一行</li>
<li>外键（<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/create-table-foreign-keys.html">FOREIGN KEY</a>），某个表中包含另一个表的主键</li>
</ul>
<h3 id="等值连接（INNER-JOIN）"><a href="#等值连接（INNER-JOIN）" class="headerlink" title="等值连接（INNER JOIN）"></a>等值连接（INNER JOIN）</h3><p>等值连接基于两个表之间的相等测试，也称为内部连接，在 MySQL 中 <code>JOIN</code> ， <code>CROSS JOIN</code> ， <code>INNER JOIN</code> 在语法上是等价的，可以相互替换。使用 vend_id 匹配列，检索每个供应商生产的产品信息：</p>
<ul>
<li>不使用 <code>WHERE</code> 子句将会执行笛卡尔积（cartesian product），因此必须保证在联结中使用 <code>WHERE</code> 子句</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select vend_name, prod_name, prod_price</span><br><span class="line">    -&gt; from vendors, products</span><br><span class="line">    -&gt; where vendors.vend_id &#x3D; products.vend_id</span><br><span class="line">    -&gt; order by vend_name, prod_name;</span><br><span class="line">+-------------+----------------+------------+</span><br><span class="line">| vend_name   | prod_name      | prod_price |</span><br><span class="line">+-------------+----------------+------------+</span><br><span class="line">| ACME        | Bird seed      |      10.00 |</span><br><span class="line">| ACME        | Carrots        |       2.50 |</span><br><span class="line">| ACME        | Detonator      |      13.00 |</span><br><span class="line">| ACME        | Safe           |      50.00 |</span><br><span class="line">| ACME        | Sling          |       4.49 |</span><br><span class="line">| ACME        | TNT (1 stick)  |       2.50 |</span><br><span class="line">| ACME        | TNT (5 sticks) |      10.00 |</span><br><span class="line">| Anvils R Us | .5 ton anvil   |       5.99 |</span><br><span class="line">| Anvils R Us | 1 ton anvil    |       9.99 |</span><br><span class="line">| Anvils R Us | 2 ton anvil    |      14.99 |</span><br><span class="line">| Jet Set     | JetPack 1000   |      35.00 |</span><br><span class="line">| Jet Set     | JetPack 2000   |      55.00 |</span><br><span class="line">| LT Supplies | Fuses          |       3.42 |</span><br><span class="line">| LT Supplies | Oil can        |       8.99 |</span><br><span class="line">+-------------+----------------+------------+</span><br><span class="line">14 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>也可以使用 <code>ON</code> 指明连接条件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select vend_name, prod_name, prod_price</span><br><span class="line">    -&gt; from vendors inner join products</span><br><span class="line">    -&gt; on vendors.vend_id &#x3D; products.vend_id</span><br><span class="line">    -&gt; order by vend_name, prod_name;</span><br><span class="line">+-------------+----------------+------------+</span><br><span class="line">| vend_name   | prod_name      | prod_price |</span><br><span class="line">+-------------+----------------+------------+</span><br><span class="line">| ACME        | Bird seed      |      10.00 |</span><br><span class="line">| ACME        | Carrots        |       2.50 |</span><br><span class="line">| ACME        | Detonator      |      13.00 |</span><br><span class="line">| ACME        | Safe           |      50.00 |</span><br><span class="line">| ACME        | Sling          |       4.49 |</span><br><span class="line">| ACME        | TNT (1 stick)  |       2.50 |</span><br><span class="line">| ACME        | TNT (5 sticks) |      10.00 |</span><br><span class="line">| Anvils R Us | .5 ton anvil   |       5.99 |</span><br><span class="line">| Anvils R Us | 1 ton anvil    |       9.99 |</span><br><span class="line">| Anvils R Us | 2 ton anvil    |      14.99 |</span><br><span class="line">| Jet Set     | JetPack 1000   |      35.00 |</span><br><span class="line">| Jet Set     | JetPack 2000   |      55.00 |</span><br><span class="line">| LT Supplies | Fuses          |       3.42 |</span><br><span class="line">| LT Supplies | Oil can        |       8.99 |</span><br><span class="line">+-------------+----------------+------------+</span><br><span class="line">14 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>连接的表的数量没有限制，但是连接的表越多，性能越差。例如，检索订单号为 20005 的订单中的物品，用 <code>WHERE</code> 子句匹配表中的列：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select prod_name, vend_name, prod_price, quantity</span><br><span class="line">    -&gt; from orderitems, products, vendors</span><br><span class="line">    -&gt; where products.vend_id &#x3D; vendors.vend_id</span><br><span class="line">    -&gt; and orderitems.prod_id &#x3D; products.prod_id</span><br><span class="line">    -&gt; and order_num &#x3D; 20005;</span><br><span class="line">+----------------+-------------+------------+----------+</span><br><span class="line">| prod_name      | vend_name   | prod_price | quantity |</span><br><span class="line">+----------------+-------------+------------+----------+</span><br><span class="line">| .5 ton anvil   | Anvils R Us |       5.99 |       10 |</span><br><span class="line">| 1 ton anvil    | Anvils R Us |       9.99 |        3 |</span><br><span class="line">| TNT (5 sticks) | ACME        |      10.00 |        5 |</span><br><span class="line">| Bird seed      | ACME        |      10.00 |        1 |</span><br><span class="line">+----------------+-------------+------------+----------+</span><br><span class="line">4 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>将上一节中三层嵌套的子查询进行化简：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select cust_name, cust_contact</span><br><span class="line">    -&gt; from customers, orders, orderitems</span><br><span class="line">    -&gt; where customers.cust_id &#x3D; orders.cust_id</span><br><span class="line">    -&gt; and orderitems.order_num &#x3D; orders.order_num</span><br><span class="line">    -&gt; and prod_id &#x3D; &#39;TNT2&#39;;</span><br><span class="line">+----------------+--------------+</span><br><span class="line">| cust_name      | cust_contact |</span><br><span class="line">+----------------+--------------+</span><br><span class="line">| Coyote Inc.    | Y Lee        |</span><br><span class="line">| Yosemite Place | Y Sam        |</span><br><span class="line">+----------------+--------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="自连接"><a href="#自连接" class="headerlink" title="自连接"></a>自连接</h3><p>SQL 允许对表起别名。</p>
<ul>
<li>缩短 SQL 语句</li>
<li>允许在单条 <code>SELECT</code> 语句中多次使用相同的表</li>
</ul>
<p>自连接指对相同的表进行连接，通常作为外部语句用来替代从相同表中检索数据时使用的子查询语句，由于对表的引用具有二义性，因此需要使用别名。例如，检索制造物品 DTNTR 的厂商制造的其他物品：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select p1.prod_id, p1.prod_name</span><br><span class="line">    -&gt; from products as p1, products as p2</span><br><span class="line">    -&gt; where p1.vend_id &#x3D; p2.vend_id</span><br><span class="line">    -&gt; and p2.prod_id &#x3D; &#39;DTNTR&#39;;</span><br><span class="line">+---------+----------------+</span><br><span class="line">| prod_id | prod_name      |</span><br><span class="line">+---------+----------------+</span><br><span class="line">| DTNTR   | Detonator      |</span><br><span class="line">| FB      | Bird seed      |</span><br><span class="line">| FC      | Carrots        |</span><br><span class="line">| SAFE    | Safe           |</span><br><span class="line">| SLING   | Sling          |</span><br><span class="line">| TNT1    | TNT (1 stick)  |</span><br><span class="line">| TNT2    | TNT (5 sticks) |</span><br><span class="line">+---------+----------------+</span><br><span class="line">7 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="自然连接（NATURAL-JOIN）"><a href="#自然连接（NATURAL-JOIN）" class="headerlink" title="自然连接（NATURAL JOIN）"></a>自然连接（NATURAL JOIN）</h3><p>自然连接排除表连接中多次出现的行，默认为左连接（<code>NATURAL LEFT JOIN</code>），即保留左边表中的列，丢弃右边表中的同名的列。例如，对 customers 表使用通配符 <code>*</code> 表示检索出该表的所有列，其他列明确给出，因此不会出现重复的列：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select c.*, o.order_num, o.order_date,</span><br><span class="line">    -&gt; oi.prod_id, oi.quantity, oi.item_price</span><br><span class="line">    -&gt; from customers as c, orders as o, orderitems as oi</span><br><span class="line">    -&gt; where c.cust_id &#x3D; o.cust_id</span><br><span class="line">    -&gt; and oi.order_num &#x3D; o.order_num</span><br><span class="line">    -&gt; and prod_id &#x3D; &#39;FB&#39;;</span><br><span class="line">+---------+-------------+----------------+-----------+------------+----------+--------------+--------------+-----------------+-----------+---------------------+---------+----------+------------+</span><br><span class="line">| cust_id | cust_name   | cust_address   | cust_city | cust_state | cust_zip | cust_country | cust_contact | cust_email      | order_num | order_date          | prod_id | quantity | item_price |</span><br><span class="line">+---------+-------------+----------------+-----------+------------+----------+--------------+--------------+-----------------+-----------+---------------------+---------+----------+------------+</span><br><span class="line">|   10001 | Coyote Inc. | 200 Maple Lane | Detroit   | MI         | 44444    | USA          | Y Lee        | ylee@coyote.com |     20005 | 2005-09-01 00:00:00 | FB      |        1 |      10.00 |</span><br><span class="line">|   10001 | Coyote Inc. | 200 Maple Lane | Detroit   | MI         | 44444    | USA          | Y Lee        | ylee@coyote.com |     20009 | 2005-10-08 00:00:00 | FB      |        1 |      10.00 |</span><br><span class="line">+---------+-------------+----------------+-----------+------------+----------+--------------+--------------+-----------------+-----------+---------------------+---------+----------+------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="外部连接（OUTER-JOIN）"><a href="#外部连接（OUTER-JOIN）" class="headerlink" title="外部连接（OUTER JOIN）"></a>外部连接（OUTER JOIN）</h3><p>外部连接可以返回相关表中没有关联的行，必须使用 <code>LEFT</code> 或 <code>RIGHT</code> 指定包括其所有行的表。例如，以下语句使用内部连接检索所有客户及其订单：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select customers.cust_id, orders.order_num</span><br><span class="line">    -&gt; from customers INNER JOIN orders</span><br><span class="line">    -&gt; on customers.cust_id &#x3D; orders.cust_id;</span><br><span class="line">+---------+-----------+</span><br><span class="line">| cust_id | order_num |</span><br><span class="line">+---------+-----------+</span><br><span class="line">|   10001 |     20005 |</span><br><span class="line">|   10001 |     20009 |</span><br><span class="line">|   10003 |     20006 |</span><br><span class="line">|   10004 |     20007 |</span><br><span class="line">|   10005 |     20008 |</span><br><span class="line">+---------+-----------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>外部连接可以检索所有客户，包括没有订单的客户：</p>
<ul>
<li><code>LEFT OUTER JOIN</code> 保留左边表的所有列</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select customers.cust_id, orders.order_num</span><br><span class="line">    -&gt; from customers LEFT OUTER JOIN orders</span><br><span class="line">    -&gt; on customers.cust_id &#x3D; orders.cust_id;</span><br><span class="line">+---------+-----------+</span><br><span class="line">| cust_id | order_num |</span><br><span class="line">+---------+-----------+</span><br><span class="line">|   10001 |     20005 |</span><br><span class="line">|   10001 |     20009 |</span><br><span class="line">|   10002 |      NULL |</span><br><span class="line">|   10003 |     20006 |</span><br><span class="line">|   10004 |     20007 |</span><br><span class="line">|   10005 |     20008 |</span><br><span class="line">+---------+-----------+</span><br><span class="line">6 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="结合聚集函数"><a href="#结合聚集函数" class="headerlink" title="结合聚集函数"></a>结合聚集函数</h3><p>函数也可以与连接一起使用。例如，检索客户以及每个客户的订单数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select customers.cust_name,</span><br><span class="line">    -&gt; customers.cust_id,</span><br><span class="line">    -&gt; count(orders.order_num) as num_ord</span><br><span class="line">    -&gt; from customers INNER JOIN orders</span><br><span class="line">    -&gt; on customers.cust_id &#x3D; orders.cust_id</span><br><span class="line">    -&gt; group by customers.cust_id;</span><br><span class="line">+----------------+---------+---------+</span><br><span class="line">| cust_name      | cust_id | num_ord |</span><br><span class="line">+----------------+---------+---------+</span><br><span class="line">| Coyote Inc.    |   10001 |       2 |</span><br><span class="line">| Wascals        |   10003 |       1 |</span><br><span class="line">| Yosemite Place |   10004 |       1 |</span><br><span class="line">| E Fudd         |   10005 |       1 |</span><br><span class="line">+----------------+---------+---------+</span><br><span class="line">4 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>使用外部连接包含所有客户，包括没有订单的客户：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select customers.cust_name,</span><br><span class="line">    -&gt; customers.cust_id,</span><br><span class="line">    -&gt; count(orders.order_num) as num_ord</span><br><span class="line">    -&gt; from customers LEFT OUTER JOIN orders</span><br><span class="line">    -&gt; on customers.cust_id &#x3D; orders.cust_id</span><br><span class="line">    -&gt; group by customers.cust_id;</span><br><span class="line">+----------------+---------+---------+</span><br><span class="line">| cust_name      | cust_id | num_ord |</span><br><span class="line">+----------------+---------+---------+</span><br><span class="line">| Coyote Inc.    |   10001 |       2 |</span><br><span class="line">| Mouse House    |   10002 |       0 |</span><br><span class="line">| Wascals        |   10003 |       1 |</span><br><span class="line">| Yosemite Place |   10004 |       1 |</span><br><span class="line">| E Fudd         |   10005 |       1 |</span><br><span class="line">+----------------+---------+---------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h2 id="组合查询"><a href="#组合查询" class="headerlink" title="组合查询"></a>组合查询</h2><p>组合查询通常称为并（union）或复合查询（<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/sql-compound-statements.html">compound query</a>），指执行多个查询并将其结果作为单个集合返回。以下两种基本情况需要使用组合查询：</p>
<ul>
<li>在单个查询中从不同的表返回结构类似的数据</li>
<li>对单个表执行多个查询，按单个查询返回数据</li>
</ul>
<p>任何具有多个 <code>WHERE</code> 子句的 <code>SELECT</code> 语句都可以作为一个组合查询给出。</p>
<p>可以使用 <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/union.html">UNION</a> 子句将多个 <code>SELECT</code> 语句的结果组合成一个结果集。</p>
<ul>
<li>必须由两条或以上的 <code>SELECT</code> 语句组成</li>
<li>每个查询必须包含相同的列、表达式或聚集函数</li>
<li>列数据类型必须兼容（可以隐式转换）</li>
</ul>
<p>例如，同时检索价格小于等于 5 的物品以及供应商 1001 和 1002 制造的物品：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select vend_id, prod_id ,prod_price</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where prod_price &lt;&#x3D; 5</span><br><span class="line">    -&gt; union</span><br><span class="line">    -&gt; select vend_id, prod_id ,prod_price</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where vend_id in (1001, 1002);</span><br><span class="line">+---------+---------+------------+</span><br><span class="line">| vend_id | prod_id | prod_price |</span><br><span class="line">+---------+---------+------------+</span><br><span class="line">|    1003 | FC      |       2.50 |</span><br><span class="line">|    1002 | FU1     |       3.42 |</span><br><span class="line">|    1003 | SLING   |       4.49 |</span><br><span class="line">|    1003 | TNT1    |       2.50 |</span><br><span class="line">|    1001 | ANV01   |       5.99 |</span><br><span class="line">|    1001 | ANV02   |       9.99 |</span><br><span class="line">|    1001 | ANV03   |      14.99 |</span><br><span class="line">|    1002 | OL1     |       8.99 |</span><br><span class="line">+---------+---------+------------+</span><br><span class="line">8 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>也可以使用 <code>WHERE</code> 子句实现，更为简洁：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select vend_id, prod_id ,prod_price</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where prod_price &lt;&#x3D; 5</span><br><span class="line">    -&gt; or vend_id in (1001, 1002);</span><br><span class="line">+---------+---------+------------+</span><br><span class="line">| vend_id | prod_id | prod_price |</span><br><span class="line">+---------+---------+------------+</span><br><span class="line">|    1001 | ANV01   |       5.99 |</span><br><span class="line">|    1001 | ANV02   |       9.99 |</span><br><span class="line">|    1001 | ANV03   |      14.99 |</span><br><span class="line">|    1003 | FC      |       2.50 |</span><br><span class="line">|    1002 | FU1     |       3.42 |</span><br><span class="line">|    1002 | OL1     |       8.99 |</span><br><span class="line">|    1003 | SLING   |       4.49 |</span><br><span class="line">|    1003 | TNT1    |       2.50 |</span><br><span class="line">+---------+---------+------------+</span><br><span class="line">8 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><code>UNION</code> 子句从结果集中自动去除了重复的行，即与在单条 <code>SELECT</code> 语句中使用多个 <code>WHERE</code> 子句条件一样。如果想返回匹配的所有行，可以使用 <code>UNION ALL</code> ，<code>UNION ALL</code> 不排除重复的行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select vend_id, prod_id ,prod_price</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where prod_price &lt;&#x3D; 5</span><br><span class="line">    -&gt; union all</span><br><span class="line">    -&gt; select vend_id, prod_id ,prod_price</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where vend_id in (1001, 1002);</span><br><span class="line">+---------+---------+------------+</span><br><span class="line">| vend_id | prod_id | prod_price |</span><br><span class="line">+---------+---------+------------+</span><br><span class="line">|    1003 | FC      |       2.50 |</span><br><span class="line">|    1002 | FU1     |       3.42 |</span><br><span class="line">|    1003 | SLING   |       4.49 |</span><br><span class="line">|    1003 | TNT1    |       2.50 |</span><br><span class="line">|    1001 | ANV01   |       5.99 |</span><br><span class="line">|    1001 | ANV02   |       9.99 |</span><br><span class="line">|    1001 | ANV03   |      14.99 |</span><br><span class="line">|    1002 | FU1     |       3.42 |</span><br><span class="line">|    1002 | OL1     |       8.99 |</span><br><span class="line">+---------+---------+------------+</span><br><span class="line">9 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>使用 <code>UNION</code> 组合查询时可以使用 <code>ORDER BY</code> ，但只能用一条，且必须放在最后一条 <code>SELECT</code> 语句之后。MySQL 会按照 <code>ORDER BY</code> 指定的列对结果集进行排序。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select vend_id, prod_id ,prod_price</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where prod_price &lt;&#x3D; 5</span><br><span class="line">    -&gt; union</span><br><span class="line">    -&gt; select vend_id, prod_id ,prod_price</span><br><span class="line">    -&gt; from products</span><br><span class="line">    -&gt; where vend_id in (1001, 1002)</span><br><span class="line">    -&gt; order by vend_id, prod_price;</span><br><span class="line">+---------+---------+------------+</span><br><span class="line">| vend_id | prod_id | prod_price |</span><br><span class="line">+---------+---------+------------+</span><br><span class="line">|    1001 | ANV01   |       5.99 |</span><br><span class="line">|    1001 | ANV02   |       9.99 |</span><br><span class="line">|    1001 | ANV03   |      14.99 |</span><br><span class="line">|    1002 | FU1     |       3.42 |</span><br><span class="line">|    1002 | OL1     |       8.99 |</span><br><span class="line">|    1003 | FC      |       2.50 |</span><br><span class="line">|    1003 | TNT1    |       2.50 |</span><br><span class="line">|    1003 | SLING   |       4.49 |</span><br><span class="line">+---------+---------+------------+</span><br><span class="line">8 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h2 id="全文本搜索"><a href="#全文本搜索" class="headerlink" title="全文本搜索"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/fulltext-search.html">全文本搜索</a></h2><p>为了执行全文本搜索，必须索引被搜索的列，而且要随着数据的改变不断重新索引。索引之后 <code>SELECT</code> 语句可以和 <code>MATCH()</code> 和 <code>AGAINST()</code> 一起使用以执行搜索。</p>
<p>一般在创建表时启用全文本搜索，指定被索引列以及使用的存储引擎。<code>FULLTEXT()</code> 用于指定被索引的列，可以包含多个列，定义之后 MySQL 自动维护索引。</p>
<ul>
<li>MySQL 默认使用 InnoDB 引擎，也有其他的 <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/storage-engines.html">可选引擎</a></li>
<li>索引时短词被忽略，默认为 3 个或以下字符的词</li>
<li>MySQL 内置停用词表（stopword），索引时忽略这些词</li>
<li>50% 规则：如果一个词出现在 50% 以上的行中，则将其作为停用词忽略<ul>
<li>不用于布尔全文本检索</li>
</ul>
</li>
<li>如果行数少于 3 行，则全文本搜索不返回结果</li>
<li>忽略词中的单引号</li>
<li>不具有分隔符的语言（日语、汉语等）需要处理，默认处理不能恰当返回搜索结果</li>
</ul>
<p><code>MATCH()</code> 指定被搜索的列，必须和 <code>FULLTEXT()</code> 定义中的相同，如果指定多个列还必须按次序列出；<code>AGAINST()</code> 指定要使用的搜索表达式。全文本搜索默认不区分大小写。</p>
<p>例如，检索 note_text 列值包含 rabbit 的行，并且先返回 rabbit 出现位置靠前的行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select note_text</span><br><span class="line">    -&gt; from productnotes</span><br><span class="line">    -&gt; where MATCH(note_text) AGAINST(&#39;rabbit&#39;);</span><br><span class="line">+----------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| note_text                                                                                                            |</span><br><span class="line">+----------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| Customer complaint: rabbit has been able to detect trap, food apparently less effective now.                         |</span><br><span class="line">| Quantity varies, sold by the sack load.</span><br><span class="line">All guaranteed to be bright and orange, and suitable for use as rabbit bait. |</span><br><span class="line">+----------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>上面的语句也可以使用 <code>LIKE</code> 完成：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select note_text</span><br><span class="line">    -&gt; from productnotes</span><br><span class="line">    -&gt; where note_text LIKE &#39;%rabbit%&#39;;</span><br><span class="line">+----------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| note_text                                                                                                            |</span><br><span class="line">+----------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| Quantity varies, sold by the sack load.</span><br><span class="line">All guaranteed to be bright and orange, and suitable for use as rabbit bait. |</span><br><span class="line">| Customer complaint: rabbit has been able to detect trap, food apparently less effective now.                         |</span><br><span class="line">+----------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>全文本搜索对结果进行排序，先返回具有较高等级的行。等级由 MySQL 根据行中词的数目、唯一词的数目、整个索引中词的总数以及包含该次的行数计算得出。因此不包含 rabbit 的行的等级为 0 ，包含 rabbit 的行具有非零等级：</p>
<ul>
<li>如果指定多个搜索项，则包含多数匹配词的行将具有更高的等级</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select note_text, MATCH (note_text) AGAINST(&#39;rabbit&#39;)</span><br><span class="line">    -&gt; from productnotes;</span><br><span class="line">+-----------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------+</span><br><span class="line">| note_text                                                                                                                                                 | MATCH (note_text) AGAINST(&#39;rabbit&#39;) |</span><br><span class="line">+-----------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------+</span><br><span class="line">| Customer complaint:</span><br><span class="line">Sticks not individually wrapped, too easy to mistakenly detonate all at once.</span><br><span class="line">Recommend individual wrapping.                          |                                   0 |</span><br><span class="line">| Can shipped full, refills not available.</span><br><span class="line">Need to order new can if refill needed.                                                                          |                                   0 |</span><br><span class="line">| Safe is combination locked, combination not provided with safe.</span><br><span class="line">This is rarely a problem as safes are typically blown up or dropped by customers.         |                                   0 |</span><br><span class="line">| Quantity varies, sold by the sack load.</span><br><span class="line">All guaranteed to be bright and orange, and suitable for use as rabbit bait.                                      |                  1.5905543565750122 |</span><br><span class="line">| Included fuses are short and have been known to detonate too quickly for some customers.</span><br><span class="line">Longer fuses are available (item FU1) and should be recommended. |                                   0 |</span><br><span class="line">| Matches not included, recommend purchase of matches or detonator (item DTNTR).                                                                            |                                   0 |</span><br><span class="line">| Please note that no returns will be accepted if safe opened using explosives.                                                                             |                                   0 |</span><br><span class="line">| Multiple customer returns, anvils failing to drop fast enough or falling backwards on purchaser. Recommend that customer considers using heavier anvils.  |                                   0 |</span><br><span class="line">| Item is extremely heavy. Designed for dropping, not recommended for use with slings, ropes, pulleys, or tightropes.                                       |                                   0 |</span><br><span class="line">| Customer complaint: rabbit has been able to detect trap, food apparently less effective now.                                                              |                  1.6408053636550903 |</span><br><span class="line">| Shipped unassembled, requires common tools (including oversized hammer).                                                                                  |                                   0 |</span><br><span class="line">| Customer complaint:</span><br><span class="line">Circular hole in safe floor can apparently be easily cut with handsaw.                                                                |                                   0 |</span><br><span class="line">| Customer complaint:</span><br><span class="line">Not heavy enough to generate flying stars around head of victim. If being purchased for dropping, recommend ANV02 or ANV03 instead.   |                                   0 |</span><br><span class="line">| Call from individual trapped in safe plummeting to the ground, suggests an escape hatch be added.</span><br><span class="line">Comment forwarded to vendor.                            |                                   0 |</span><br><span class="line">+-----------------------------------------------------------------------------------------------------------------------------------------------------------+-------------------------------------+</span><br><span class="line">14 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/fulltext-query-expansion.html">WITH QUERY EXPANSION</a></strong></p>
<p>查询扩展（query expansion）用来放宽所返回的全文本搜索结果的范围。在使用查询扩展时，MySQL 对数据和索引进行两遍扫描来完成搜索：</p>
<ul>
<li>全文本搜索，找出与搜索条件匹配的所有行</li>
<li>检查匹配并选择有用的词</li>
<li>全文本搜索，找出与有用的词匹配的所有行</li>
</ul>
<p>例如，一个简单的全文本搜索：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select note_text</span><br><span class="line">    -&gt; from productnotes</span><br><span class="line">    -&gt; where MATCH(note_text) AGAINST(&#39;anvils&#39;);</span><br><span class="line">+----------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| note_text                                                                                                                                                |</span><br><span class="line">+----------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| Multiple customer returns, anvils failing to drop fast enough or falling backwards on purchaser. Recommend that customer considers using heavier anvils. |</span><br><span class="line">+----------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>使用 <code>WITH QUERY EXPANSION</code> 放宽搜索范围：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select note_text</span><br><span class="line">    -&gt; from productnotes</span><br><span class="line">    -&gt; where MATCH(note_text) AGAINST(&#39;anvils&#39; WITH QUERY EXPANSION);</span><br><span class="line">+----------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| note_text                                                                                                                                                |</span><br><span class="line">+----------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| Multiple customer returns, anvils failing to drop fast enough or falling backwards on purchaser. Recommend that customer considers using heavier anvils. |</span><br><span class="line">| Customer complaint:</span><br><span class="line">Sticks not individually wrapped, too easy to mistakenly detonate all at once.</span><br><span class="line">Recommend individual wrapping.                         |</span><br><span class="line">| Customer complaint:</span><br><span class="line">Not heavy enough to generate flying stars around head of victim. If being purchased for dropping, recommend ANV02 or ANV03 instead.  |</span><br><span class="line">| Please note that no returns will be accepted if safe opened using explosives.                                                                            |</span><br><span class="line">| Customer complaint: rabbit has been able to detect trap, food apparently less effective now.                                                             |</span><br><span class="line">| Customer complaint:</span><br><span class="line">Circular hole in safe floor can apparently be easily cut with handsaw.                                                               |</span><br><span class="line">| Matches not included, recommend purchase of matches or detonator (item DTNTR).                                                                           |</span><br><span class="line">+----------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">7 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>布尔全文本搜索（<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/fulltext-boolean.html">Boolean Full-Text Searches</a>）</strong></p>
<p>没有使用 <code>FULLTEXT()</code> 定义索引也可以使用布尔全文本搜索，但是相比建立索引的搜索性能较差。使用 <code>IN BOOLEAN MODE</code> 指定布尔全文本搜索，<code>-</code> 表示排除文本，<code>+</code> 表示必须包含文本，布尔全文本搜索排列但不排序。</p>
<p>下列语句表示检索包含 heavy 但不包含以 rope 开始的词的行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select note_text</span><br><span class="line">    -&gt; from productnotes</span><br><span class="line">    -&gt; where MATCH(note_text) AGAINST(&#39;heavy -rope*&#39; IN BOOLEAN MODE);</span><br><span class="line">+---------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| note_text                                                                                                                                               |</span><br><span class="line">+---------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| Customer complaint:</span><br><span class="line">Not heavy enough to generate flying stars around head of victim. If being purchased for dropping, recommend ANV02 or ANV03 instead. |</span><br><span class="line">+---------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<ol>
<li>匹配词 rabbit 和 bait ：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select note_text</span><br><span class="line">    -&gt; from productnotes</span><br><span class="line">    -&gt; where MATCH(note_text) AGAINST(&#39;+rabbit +bait&#39; IN BOOLEAN MODE);</span><br><span class="line">+----------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| note_text                                                                                                            |</span><br><span class="line">+----------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| Quantity varies, sold by the sack load.</span><br><span class="line">All guaranteed to be bright and orange, and suitable for use as rabbit bait. |</span><br><span class="line">+----------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>匹配词 rabbit 或 bait ：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select note_text</span><br><span class="line">    -&gt; from productnotes</span><br><span class="line">    -&gt; where MATCH(note_text) AGAINST(&#39;rabbit bait&#39; IN BOOLEAN MODE);</span><br><span class="line">+----------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| note_text                                                                                                            |</span><br><span class="line">+----------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| Quantity varies, sold by the sack load.</span><br><span class="line">All guaranteed to be bright and orange, and suitable for use as rabbit bait. |</span><br><span class="line">| Customer complaint: rabbit has been able to detect trap, food apparently less effective now.                         |</span><br><span class="line">+----------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>匹配短语 rabbit bait ：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select note_text</span><br><span class="line">    -&gt; from productnotes</span><br><span class="line">    -&gt; where MATCH(note_text) AGAINST(&#39;&quot;rabbit bait&quot;&#39; IN BOOLEAN MODE);</span><br><span class="line">+----------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| note_text                                                                                                            |</span><br><span class="line">+----------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| Quantity varies, sold by the sack load.</span><br><span class="line">All guaranteed to be bright and orange, and suitable for use as rabbit bait. |</span><br><span class="line">+----------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>增加前者的等级，降低后者的等级：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select note_text</span><br><span class="line">    -&gt; from productnotes</span><br><span class="line">    -&gt; where MATCH(note_text) AGAINST(&#39;&gt;rabbit &lt;carrot&#39; IN BOOLEAN MODE);</span><br><span class="line">+----------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| note_text                                                                                                            |</span><br><span class="line">+----------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| Quantity varies, sold by the sack load.</span><br><span class="line">All guaranteed to be bright and orange, and suitable for use as rabbit bait. |</span><br><span class="line">| Customer complaint: rabbit has been able to detect trap, food apparently less effective now.                         |</span><br><span class="line">+----------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>匹配词 safe 和 combination，降低后者的等级：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select note_text</span><br><span class="line">    -&gt; from productnotes</span><br><span class="line">    -&gt; where MATCH(note_text) AGAINST(&#39;+safe +(&lt;combination&gt;)&#39; IN BOOLEAN MODE);</span><br><span class="line">+---------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| note_text                                                                                                                                         |</span><br><span class="line">+---------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| Safe is combination locked, combination not provided with safe.</span><br><span class="line">This is rarely a problem as safes are typically blown up or dropped by customers. |</span><br><span class="line">+---------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h2 id="INSERT"><a href="#INSERT" class="headerlink" title="INSERT"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/insert.html">INSERT</a></h2><p><code>INSERT</code> 用来插入行到数据库表中，可以用以下几种方式使用：</p>
<h3 id="插入单行数据"><a href="#插入单行数据" class="headerlink" title="插入单行数据"></a>插入单行数据</h3><p>要求指定表名和被插入到新行中的值，如果不显式给出列名，必须给出所有列的值，且次序为表定义中的顺序。例如，往 customers 表中插入数据，第一个值为 MySQL 自动增量，因此指定为 NULL ：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; insert into customers</span><br><span class="line">    -&gt; values(</span><br><span class="line">    -&gt; NULL,</span><br><span class="line">    -&gt; &#39;Pep E. LaPew&#39;,</span><br><span class="line">    -&gt; &#39;100 Main Street&#39;,</span><br><span class="line">    -&gt; &#39;Los Angles&#39;,</span><br><span class="line">    -&gt; &#39;CA&#39;,</span><br><span class="line">    -&gt; &#39;90046&#39;,</span><br><span class="line">    -&gt; &#39;USA&#39;,</span><br><span class="line">    -&gt; NULL,</span><br><span class="line">    -&gt; NULL);</span><br><span class="line">Query OK, 1 row affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from customers</span><br><span class="line">    -&gt; where cust_name like &#39;%Pep%&#39;;</span><br><span class="line">+---------+--------------+-----------------+------------+------------+----------+--------------+--------------+------------+</span><br><span class="line">| cust_id | cust_name    | cust_address    | cust_city  | cust_state | cust_zip | cust_country | cust_contact | cust_email |</span><br><span class="line">+---------+--------------+-----------------+------------+------------+----------+--------------+--------------+------------+</span><br><span class="line">|   10006 | Pep E. LaPew | 100 Main Street | Los Angles | CA         | 90046    | USA          | NULL         | NULL       |</span><br><span class="line">+---------+--------------+-----------------+------------+------------+----------+--------------+--------------+------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>上面的写法很不安全，而且依赖于表定义，显式给出列名更好（还不用考虑次序），即使表结构改变，只要列还存在就不会出错：</p>
<ul>
<li>省略的列必须满足以下条件之一<ul>
<li>允许 NULL 值</li>
<li>设置了默认值</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; delete from customers where cust_name like &#39;%Pep%&#39;;</span><br><span class="line">Query OK, 1 row affected (0.02 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; insert into customers(</span><br><span class="line">    -&gt; cust_name,</span><br><span class="line">    -&gt; cust_address,</span><br><span class="line">    -&gt; cust_city,</span><br><span class="line">    -&gt; cust_state,</span><br><span class="line">    -&gt; cust_zip,</span><br><span class="line">    -&gt; cust_country,</span><br><span class="line">    -&gt; cust_contact,</span><br><span class="line">    -&gt; cust_email</span><br><span class="line">    -&gt; )</span><br><span class="line">    -&gt; values(</span><br><span class="line">    -&gt; &#39;Pep E. LaPew&#39;,</span><br><span class="line">    -&gt; &#39;100 Main Street&#39;,</span><br><span class="line">    -&gt; &#39;Los Angles&#39;,</span><br><span class="line">    -&gt; &#39;CA&#39;,</span><br><span class="line">    -&gt; &#39;90046&#39;,</span><br><span class="line">    -&gt; &#39;USA&#39;,</span><br><span class="line">    -&gt; NULL,</span><br><span class="line">    -&gt; NULL);</span><br><span class="line">Query OK, 1 row affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from customers where cust_name like &#39;%Pep%&#39;;</span><br><span class="line">+---------+--------------+-----------------+------------+------------+----------+--------------+--------------+------------+</span><br><span class="line">| cust_id | cust_name    | cust_address    | cust_city  | cust_state | cust_zip | cust_country | cust_contact | cust_email |</span><br><span class="line">+---------+--------------+-----------------+------------+------------+----------+--------------+--------------+------------+</span><br><span class="line">|   10007 | Pep E. LaPew | 100 Main Street | Los Angles | CA         | 90046    | USA          | NULL         | NULL       |</span><br><span class="line">+---------+--------------+-----------------+------------+------------+----------+--------------+--------------+------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>可以使用 <code>LOW_PRIORITY</code> 延迟插入的执行，直到没有其他客户端从表中读取数据时才会执行，该修饰符也可以用于 <code>UPDATE</code> 和 <code>DELETE</code> 语句。</p>
<h3 id="插入多行数据"><a href="#插入多行数据" class="headerlink" title="插入多行数据"></a>插入多行数据</h3><p>可以在一条 <code>INSERT</code> 语句中插入多行数据，每组值中列的次序相同，使用圆括号括起来，并用逗号分隔。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; delete from customers where cust_name like &#39;%Pep%&#39;;</span><br><span class="line">Query OK, 1 row affected (0.02 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; insert into customers(</span><br><span class="line">    -&gt;   cust_name,</span><br><span class="line">    -&gt;   cust_address,</span><br><span class="line">    -&gt;   cust_city,</span><br><span class="line">    -&gt;   cust_state,</span><br><span class="line">    -&gt;   cust_zip,</span><br><span class="line">    -&gt;   cust_country</span><br><span class="line">    -&gt; )</span><br><span class="line">    -&gt; values(</span><br><span class="line">    -&gt;   &#39;Pep E. LaPew&#39;,</span><br><span class="line">    -&gt;   &#39;100 Main Street&#39;,</span><br><span class="line">    -&gt;   &#39;Los Angles&#39;,</span><br><span class="line">    -&gt;   &#39;CA&#39;,</span><br><span class="line">    -&gt;   &#39;90046&#39;,</span><br><span class="line">    -&gt;   &#39;USA&#39;),</span><br><span class="line">    -&gt;   (</span><br><span class="line">    -&gt;     &#39;M. Martian&#39;,</span><br><span class="line">    -&gt;     &#39;42 Galaxy Way&#39;,</span><br><span class="line">    -&gt;     &#39;New York&#39;,</span><br><span class="line">    -&gt;     &#39;NY&#39;,</span><br><span class="line">    -&gt;     &#39;11213&#39;,</span><br><span class="line">    -&gt;     &#39;USA&#39;</span><br><span class="line">    -&gt;   );</span><br><span class="line">Query OK, 2 rows affected (0.01 sec)</span><br><span class="line">Records: 2  Duplicates: 0  Warnings: 0</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from customers where cust_country &#x3D; &#39;USA&#39;;</span><br><span class="line">+---------+----------------+---------------------+------------+------------+----------+--------------+--------------+---------------------+</span><br><span class="line">| cust_id | cust_name      | cust_address        | cust_city  | cust_state | cust_zip | cust_country | cust_contact | cust_email          |</span><br><span class="line">+---------+----------------+---------------------+------------+------------+----------+--------------+--------------+---------------------+</span><br><span class="line">|   10001 | Coyote Inc.    | 200 Maple Lane      | Detroit    | MI         | 44444    | USA          | Y Lee        | ylee@coyote.com     |</span><br><span class="line">|   10002 | Mouse House    | 333 Fromage Lane    | Columbus   | OH         | 43333    | USA          | Jerry Mouse  | NULL                |</span><br><span class="line">|   10003 | Wascals        | 1 Sunny Place       | Muncie     | IN         | 42222    | USA          | Jim Jones    | rabbit@wascally.com |</span><br><span class="line">|   10004 | Yosemite Place | 829 Riverside Drive | Phoenix    | AZ         | 88888    | USA          | Y Sam        | sam@yosemite.com    |</span><br><span class="line">|   10005 | E Fudd         | 4545 53rd Street    | Chicago    | IL         | 54545    | USA          | E Fudd       | NULL                |</span><br><span class="line">|   10008 | Pep E. LaPew   | 100 Main Street     | Los Angles | CA         | 90046    | USA          | NULL         | NULL                |</span><br><span class="line">|   10009 | M. Martian     | 42 Galaxy Way       | New York   | NY         | 11213    | USA          | NULL         | NULL                |</span><br><span class="line">+---------+----------------+---------------------+------------+------------+----------+--------------+--------------+---------------------+</span><br><span class="line">7 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="插入检索出的数据"><a href="#插入检索出的数据" class="headerlink" title="插入检索出的数据"></a>插入检索出的数据</h3><p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/insert-select.html">INSERT … SELECT</a> 语句用于将 <code>SELECT</code> 语句的结果插入表中。</p>
<p>检索 customers 表中的数据并插入 custnew 表，custnew 表的结构与 customers 表相同，省略自增列 cust_id ，MySQL 会自动生成。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; CREATE TABLE custnew</span><br><span class="line">    -&gt; (</span><br><span class="line">    -&gt;   cust_id      int       NOT NULL AUTO_INCREMENT,</span><br><span class="line">    -&gt;   cust_name    char(50)  NOT NULL ,</span><br><span class="line">    -&gt;   cust_address char(50)  NULL ,</span><br><span class="line">    -&gt;   cust_city    char(50)  NULL ,</span><br><span class="line">    -&gt;   cust_state   char(5)   NULL ,</span><br><span class="line">    -&gt;   cust_zip     char(10)  NULL ,</span><br><span class="line">    -&gt;   cust_country char(50)  NULL ,</span><br><span class="line">    -&gt;   cust_contact char(50)  NULL ,</span><br><span class="line">    -&gt;   cust_email   char(255) NULL ,</span><br><span class="line">    -&gt;   PRIMARY KEY (cust_id)</span><br><span class="line">    -&gt; ) ENGINE&#x3D;InnoDB;</span><br><span class="line">Query OK, 0 rows affected (0.03 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; insert into custnew</span><br><span class="line">    -&gt; select *</span><br><span class="line">    -&gt; from customers;</span><br><span class="line">Query OK, 7 rows affected (0.02 sec)</span><br><span class="line">Records: 7  Duplicates: 0  Warnings: 0</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from custnew;</span><br><span class="line">+---------+----------------+---------------------+------------+------------+----------+--------------+--------------+---------------------+</span><br><span class="line">| cust_id | cust_name      | cust_address        | cust_city  | cust_state | cust_zip | cust_country | cust_contact | cust_email          |</span><br><span class="line">+---------+----------------+---------------------+------------+------------+----------+--------------+--------------+---------------------+</span><br><span class="line">|   10001 | Coyote Inc.    | 200 Maple Lane      | Detroit    | MI         | 44444    | USA          | Y Lee        | ylee@coyote.com     |</span><br><span class="line">|   10002 | Mouse House    | 333 Fromage Lane    | Columbus   | OH         | 43333    | USA          | Jerry Mouse  | NULL                |</span><br><span class="line">|   10003 | Wascals        | 1 Sunny Place       | Muncie     | IN         | 42222    | USA          | Jim Jones    | rabbit@wascally.com |</span><br><span class="line">|   10004 | Yosemite Place | 829 Riverside Drive | Phoenix    | AZ         | 88888    | USA          | Y Sam        | sam@yosemite.com    |</span><br><span class="line">|   10005 | E Fudd         | 4545 53rd Street    | Chicago    | IL         | 54545    | USA          | E Fudd       | NULL                |</span><br><span class="line">|   10008 | Pep E. LaPew   | 100 Main Street     | Los Angles | CA         | 90046    | USA          | NULL         | NULL                |</span><br><span class="line">|   10009 | M. Martian     | 42 Galaxy Way       | New York   | NY         | 11213    | USA          | NULL         | NULL                |</span><br><span class="line">+---------+----------------+---------------------+------------+------------+----------+--------------+--------------+---------------------+</span><br><span class="line">7 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h2 id="UPDATE"><a href="#UPDATE" class="headerlink" title="UPDATE"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/update.html">UPDATE</a></h2><p>可以使用两种方式使用 <code>UPDATE</code> ：</p>
<ul>
<li>更新表中特定行（<code>WHERE</code> 子句、子查询）</li>
<li>更新表中所有行</li>
</ul>
<p><code>SET</code> 用来将新值赋给被更新的列。例如，更新 10005 客户的电子邮件地址：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; UPDATE customers</span><br><span class="line">    -&gt; SET cust_email &#x3D; &#39;elmer@fudd.com&#39;</span><br><span class="line">    -&gt; WHERE cust_id &#x3D; 10005;</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line">Rows matched: 1  Changed: 1  Warnings: 0</span><br></pre></td></tr></table></figure>

<p>更新多个列时，使用逗号分隔：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; UPDATE customers</span><br><span class="line">    -&gt; SET cust_name &#x3D; &#39;The Fudds&#39;,</span><br><span class="line">    -&gt; cust_email &#x3D; &#39;elmer@fudd.com&#39;</span><br><span class="line">    -&gt; WHERE cust_id &#x3D; 10005;</span><br><span class="line">Query OK, 1 row affected (0.01 sec)</span><br><span class="line">Rows matched: 1  Changed: 1  Warnings: 0</span><br></pre></td></tr></table></figure>

<p>使用 <code>IGNORE</code> 修饰符，即使在更新过程中出现错误，<code>UPDATE</code> 语句也不会中止。例如，<code>UPDATE IGNORE customers</code> 。</p>
<p>为了删除某个列的值，可以将其设置为 NULL （如果表定义允许 NULL 值）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; UPDATE customers</span><br><span class="line">    -&gt; SET cust_email &#x3D; NULL</span><br><span class="line">    -&gt; WHERE cust_id &#x3D; 10005;</span><br><span class="line">Query OK, 1 row affected (0.01 sec)</span><br><span class="line">Rows matched: 1  Changed: 1  Warnings: 0</span><br></pre></td></tr></table></figure>

<h2 id="DELETE"><a href="#DELETE" class="headerlink" title="DELETE"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/delete.html">DELETE</a></h2><p>和 <code>UPDATE</code> 相同，可以使用两种方式使用 <code>DELETE</code> ：</p>
<ul>
<li>删除表中特定行（<code>WHERE</code> 子句、子查询）</li>
<li>删除表中所有行</li>
</ul>
<p><code>DELETE</code> 删除整行数据，用 <code>FROM</code> 指定待删除数据所在的表：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; DELETE FROM customers</span><br><span class="line">    -&gt; WHERE cust_id &#x3D; 10006;</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>删除表中所有行可以使用 <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/truncate-table.html"><code>TRUNCATE TABLE</code></a> 语句，删除原来的表并重新创建；而 <code>DELETE</code> 语句执行逐行删除。</p>
<h2 id="CREATE-TABLE"><a href="#CREATE-TABLE" class="headerlink" title="CREATE TABLE"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/create-table.html">CREATE TABLE</a></h2><p>使用 <code>CREATE TABLE</code> 创建表，必须给出表名和列（名字和定义）。例如，customers 表的创建：</p>
<ul>
<li>表名紧跟在 <code>CREATE TABLE</code> 关键字后</li>
<li>表定义（所有列）都在圆括号中</li>
<li>每个列之间用逗号分隔</li>
<li>每列的定义以列名开始，后跟数据类型<ul>
<li>列名唯一</li>
</ul>
</li>
<li>使用 <code>PRIMARY KEY</code> 指定关键字</li>
<li><code>AUTO_INCREMENT</code> 表示自动增量</li>
<li><code>ENGINE</code> 表示选择使用的引擎</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> customers</span><br><span class="line">(</span><br><span class="line">  cust_id      <span class="built_in">int</span>       <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  cust_name    <span class="built_in">char</span>(<span class="number">50</span>)  <span class="keyword">NOT</span> <span class="literal">NULL</span> ,</span><br><span class="line">  cust_address <span class="built_in">char</span>(<span class="number">50</span>)  <span class="literal">NULL</span> ,</span><br><span class="line">  cust_city    <span class="built_in">char</span>(<span class="number">50</span>)  <span class="literal">NULL</span> ,</span><br><span class="line">  cust_state   <span class="built_in">char</span>(<span class="number">5</span>)   <span class="literal">NULL</span> ,</span><br><span class="line">  cust_zip     <span class="built_in">char</span>(<span class="number">10</span>)  <span class="literal">NULL</span> ,</span><br><span class="line">  cust_country <span class="built_in">char</span>(<span class="number">50</span>)  <span class="literal">NULL</span> ,</span><br><span class="line">  cust_contact <span class="built_in">char</span>(<span class="number">50</span>)  <span class="literal">NULL</span> ,</span><br><span class="line">  cust_email   <span class="built_in">char</span>(<span class="number">255</span>) <span class="literal">NULL</span> ,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (cust_id)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span>;</span><br></pre></td></tr></table></figure>

<h3 id="NULL"><a href="#NULL" class="headerlink" title="NULL"></a>NULL</h3><p>NULL 表示没有值或缺值，允许 NULL 值的列允许在插入行时不给出该列的值，不允许 NULL 值的列在插入或更新时必须有值。</p>
<p>orders 表的每个列都必须有值，因此每个列都使用关键字 <code>NOT NULL</code> ：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> orders</span><br><span class="line">(</span><br><span class="line">  order_num  <span class="built_in">int</span>      <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  order_date datetime <span class="keyword">NOT</span> <span class="literal">NULL</span> ,</span><br><span class="line">  cust_id    <span class="built_in">int</span>      <span class="keyword">NOT</span> <span class="literal">NULL</span> ,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (order_num)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span>;</span><br></pre></td></tr></table></figure>

<p>vendors 表拥有 NULL 和 NOT NULL 的列：</p>
<ul>
<li>NULL 为默认设置</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> vendors</span><br><span class="line">(</span><br><span class="line">  vend_id      <span class="built_in">int</span>      <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  vend_name    <span class="built_in">char</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> ,</span><br><span class="line">  vend_address <span class="built_in">char</span>(<span class="number">50</span>) <span class="literal">NULL</span> ,</span><br><span class="line">  vend_city    <span class="built_in">char</span>(<span class="number">50</span>) <span class="literal">NULL</span> ,</span><br><span class="line">  vend_state   <span class="built_in">char</span>(<span class="number">5</span>)  <span class="literal">NULL</span> ,</span><br><span class="line">  vend_zip     <span class="built_in">char</span>(<span class="number">10</span>) <span class="literal">NULL</span> ,</span><br><span class="line">  vend_country <span class="built_in">char</span>(<span class="number">50</span>) <span class="literal">NULL</span> ,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (vend_id)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span>;</span><br></pre></td></tr></table></figure>

<h3 id="PRIMARY-KEY"><a href="#PRIMARY-KEY" class="headerlink" title="PRIMARY KEY"></a>PRIMARY KEY</h3><p>一个表只能有一个主键，主键的名称始终是 <code>PRIMARY KEY</code> ，且必须定义为 <code>NOT NULL</code> 如果没有将主键显式声明为 <code>NOT NULL</code> 则 MySQL 将自动进行设置。</p>
<ul>
<li>如果主键使用单个列，则它的值必须唯一；如果使用多个列，则组合必须唯一。</li>
</ul>
<p>orderitems 表，每个订单中的每种物品只会出现一次（数量不同），因此可以组合作为主键：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> orderitems</span><br><span class="line">(</span><br><span class="line">  order_num  <span class="built_in">int</span>          <span class="keyword">NOT</span> <span class="literal">NULL</span> ,</span><br><span class="line">  order_item <span class="built_in">int</span>          <span class="keyword">NOT</span> <span class="literal">NULL</span> ,</span><br><span class="line">  prod_id    <span class="built_in">char</span>(<span class="number">10</span>)     <span class="keyword">NOT</span> <span class="literal">NULL</span> ,</span><br><span class="line">  quantity   <span class="built_in">int</span>          <span class="keyword">NOT</span> <span class="literal">NULL</span> ,</span><br><span class="line">  item_price <span class="built_in">decimal</span>(<span class="number">8</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> ,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (order_num, order_item)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span>;</span><br></pre></td></tr></table></figure>

<h3 id="AUTO-INCREMENT"><a href="#AUTO-INCREMENT" class="headerlink" title="AUTO_INCREMENT"></a>AUTO_INCREMENT</h3><p><code>AUTO_INCREMENT</code> 指示当该列增加一行时自动增量。每个表只允许一个自增列，而且必须被索引。</p>
<p>如果手动插入自增列的值，则后续增量将使用手动插入的值。</p>
<p>使用 <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/information-functions.html#function_last-insert-id"><code>LAST_INSERT_ID()</code></a> 可以查询最后一个增量值：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select last_insert_id();</span><br><span class="line">+------------------+</span><br><span class="line">| last_insert_id() |</span><br><span class="line">+------------------+</span><br><span class="line">|            10008 |</span><br><span class="line">+------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="DEFAULT"><a href="#DEFAULT" class="headerlink" title="DEFAULT"></a>DEFAULT</h3><p>创建表时可以使用 <code>DEFAULT</code> 指定默认值。</p>
<p>例如，orderitems 表设置在未给出 quantity 列值时使用默认值 1 ：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> orderitems</span><br><span class="line">(</span><br><span class="line">  order_num  <span class="built_in">int</span>          <span class="keyword">NOT</span> <span class="literal">NULL</span> ,</span><br><span class="line">  order_item <span class="built_in">int</span>          <span class="keyword">NOT</span> <span class="literal">NULL</span> ,</span><br><span class="line">  prod_id    <span class="built_in">char</span>(<span class="number">10</span>)     <span class="keyword">NOT</span> <span class="literal">NULL</span> ,</span><br><span class="line">  quantity   <span class="built_in">int</span>          <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">1</span>,</span><br><span class="line">  item_price <span class="built_in">decimal</span>(<span class="number">8</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> ,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (order_num, order_item)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span>;</span><br></pre></td></tr></table></figure>

<h3 id="ENGINE"><a href="#ENGINE" class="headerlink" title="ENGINE"></a>ENGINE</h3><p>使用 <code>ENGINE</code> 指定表的存储引擎，默认使用 InnoDB 引擎，目前 MySQL 支持下列引擎：</p>
<ul>
<li>InnoDB</li>
<li>MyISAM</li>
<li>MEMORY</li>
<li>CSV</li>
<li>ARCHIVE</li>
<li>EXAMPLE</li>
<li>FEDERATED</li>
<li>HEAP</li>
<li>MERGE</li>
<li>NDB</li>
</ul>
<p>数据库中的表可以使用不同的存储引擎，需要注意的是外键不能跨引擎，即使用一个引擎的表不能引用使用不同引擎的表的外键。</p>
<h2 id="ALTER-TABLE"><a href="#ALTER-TABLE" class="headerlink" title="ALTER TABLE"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/alter-table.html">ALTER TABLE</a></h2><p>可以使用 <code>ALTER TABLE</code> 语句更新表，常用于定义外键。</p>
<p>使用 <code>ADD</code> 为 vendors 表添加 vend_phone 列：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; ALTER TABLE vendors</span><br><span class="line">    -&gt; ADD vend_phone CHAR(20);</span><br><span class="line">Query OK, 0 rows affected (0.03 sec)</span><br><span class="line">Records: 0  Duplicates: 0  Warnings: 0</span><br></pre></td></tr></table></figure>

<p>使用 <code>DROP COLUMN</code> 删除 vendors 表中 vend_phone 列：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; ALTER TABLE vendors</span><br><span class="line">    -&gt; DROP COLUMN vend_phone;</span><br><span class="line">Query OK, 0 rows affected (0.04 sec)</span><br><span class="line">Records: 0  Duplicates: 0  Warnings: 0</span><br></pre></td></tr></table></figure>

<p><code>ADD CONSTRAINT ... FOREIGN KEY ... REFERENCES ...</code> 用于定义外键：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> orderitems <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_orderitems_orders <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (order_num) <span class="keyword">REFERENCES</span> orders (order_num);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> orderitems <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_orderitems_products <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (prod_id) <span class="keyword">REFERENCES</span> products (prod_id);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> orders <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_orders_customers <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (cust_id) <span class="keyword">REFERENCES</span> customers (cust_id);</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> products <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_products_vendors <span class="keyword">FOREIGN</span> <span class="keyword">KEY</span> (vend_id) <span class="keyword">REFERENCES</span> vendors (vend_id);</span><br></pre></td></tr></table></figure>

<h2 id="RENAME-TABLE"><a href="#RENAME-TABLE" class="headerlink" title="RENAME TABLE"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/rename-table.html">RENAME TABLE</a></h2><p>使用 <code>RENAME TABLE</code> 可以重命名一个表：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show tables;</span><br><span class="line">+----------------+</span><br><span class="line">| Tables_in_test |</span><br><span class="line">+----------------+</span><br><span class="line">| custnew        |</span><br><span class="line">| customers      |</span><br><span class="line">| orderitems     |</span><br><span class="line">| orders         |</span><br><span class="line">| productnotes   |</span><br><span class="line">| products       |</span><br><span class="line">| vendors        |</span><br><span class="line">+----------------+</span><br><span class="line">7 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; RENAME TABLE custnew TO customers2;</span><br><span class="line">Query OK, 0 rows affected (0.02 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; show tables;</span><br><span class="line">+----------------+</span><br><span class="line">| Tables_in_test |</span><br><span class="line">+----------------+</span><br><span class="line">| customers      |</span><br><span class="line">| customers2     |</span><br><span class="line">| orderitems     |</span><br><span class="line">| orders         |</span><br><span class="line">| productnotes   |</span><br><span class="line">| products       |</span><br><span class="line">| vendors        |</span><br><span class="line">+----------------+</span><br><span class="line">7 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>可以在一条语句中对多个表重命名：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">RENAME</span> <span class="keyword">TABLE</span> backup_customers <span class="keyword">TO</span> customers,</span><br><span class="line">backup_vendors <span class="keyword">TO</span> vendors,</span><br><span class="line">backup_products <span class="keyword">TO</span> products</span><br></pre></td></tr></table></figure>

<h2 id="DROP-TABLE"><a href="#DROP-TABLE" class="headerlink" title="DROP TABLE"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/drop-table.html">DROP TABLE</a></h2><p>删除表使用 <code>DROP TABLE</code> ：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; DROP TABLE customers2;</span><br><span class="line">Query OK, 0 rows affected (0.02 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; show tables;</span><br><span class="line">+----------------+</span><br><span class="line">| Tables_in_test |</span><br><span class="line">+----------------+</span><br><span class="line">| customers      |</span><br><span class="line">| orderitems     |</span><br><span class="line">| orders         |</span><br><span class="line">| productnotes   |</span><br><span class="line">| products       |</span><br><span class="line">| vendors        |</span><br><span class="line">+----------------+</span><br><span class="line">6 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h2 id="视图（View）"><a href="#视图（View）" class="headerlink" title="视图（View）"></a>视图（<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/views.html">View</a>）</h2><p>视图是虚拟的表，只包含使用时动态检索数据的查询。视图不包含表中的数据，只是一个 SQL 查询。</p>
<p>视图的常见应用</p>
<ul>
<li>重用 SQL 语句</li>
<li>简化复杂的 SQL 操作</li>
<li>使用表的组成部分（而不是整个表）</li>
<li>保护数据</li>
<li>更改数据格式和表示</li>
</ul>
<p>使用视图的规则与限制</p>
<ul>
<li>视图名必须唯一</li>
<li>视图数量没有限制</li>
<li>需要具有一定的访问权限才可以创建视图</li>
<li>视图可以嵌套</li>
<li>视图检索数据的 <code>SELECT</code> 语句的 <code>ORDER BY</code> 将会覆盖视图的 <code>ORDER BY</code></li>
<li>视图不能索引，也不能有关联的触发器或默认值</li>
<li>视图可以和表一起使用</li>
<li>检索视图使用的 <code>WHERE</code> 子句和创建视图使用的 <code>WHERE</code> 子句会自动合并</li>
</ul>
<p>相关语句</p>
<ul>
<li>创建视图：<code>CREATE VIEW</code></li>
<li>查看创建语句：<code>SHOW CREATE VIEW viewname</code></li>
<li>更新视图：<ul>
<li>先 <code>DROP</code> 再 <code>CREATE</code></li>
<li><code>CREATE OR REPLACE VIEW</code></li>
</ul>
</li>
</ul>
<h3 id="简化复杂的-SQL操作"><a href="#简化复杂的-SQL操作" class="headerlink" title="简化复杂的 SQL操作"></a>简化复杂的 SQL操作</h3><p>创建一个名为 productcustomers 的视图，连接三个表，返回订购了任意产品的客户：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; CREATE VIEW productcustomers AS</span><br><span class="line">    -&gt; SELECT cust_name, cust_contact, prod_id</span><br><span class="line">    -&gt; FROM customers, orders, orderitems</span><br><span class="line">    -&gt; WHERE customers.cust_id &#x3D; orders.cust_id</span><br><span class="line">    -&gt; AND orderitems.order_num &#x3D; orders.order_num;</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br></pre></td></tr></table></figure>

<p>用视图检索购买了 TNT2 的客户：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select cust_name, cust_contact</span><br><span class="line">    -&gt; from productcustomers</span><br><span class="line">    -&gt; where prod_id &#x3D; &#39;TNT2&#39;;</span><br><span class="line">+----------------+--------------+</span><br><span class="line">| cust_name      | cust_contact |</span><br><span class="line">+----------------+--------------+</span><br><span class="line">| Coyote Inc.    | Y Lee        |</span><br><span class="line">| Yosemite Place | Y Sam        |</span><br><span class="line">+----------------+--------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="格式化数据"><a href="#格式化数据" class="headerlink" title="格式化数据"></a>格式化数据</h3><p>检索供应商和位置的格式化数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; CREATE VIEW vendorlocation AS</span><br><span class="line">    -&gt; SELECT CONCAT(RTRIM(vend_name), &#39;(&#39;, RTrim(vend_country), &#39;)&#39;)</span><br><span class="line">    -&gt; AS vend_title</span><br><span class="line">    -&gt; FROM vendors</span><br><span class="line">    -&gt; ORDER BY vend_name;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>从视图中检索格式化的数据：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from vendorlocation;</span><br><span class="line">+------------------------+</span><br><span class="line">| vend_title             |</span><br><span class="line">+------------------------+</span><br><span class="line">| ACME(USA)              |</span><br><span class="line">| Anvils R Us(USA)       |</span><br><span class="line">| Furball Inc.(USA)      |</span><br><span class="line">| Jet Set(England)       |</span><br><span class="line">| Jouets Et Ours(France) |</span><br><span class="line">| LT Supplies(USA)       |</span><br><span class="line">+------------------------+</span><br><span class="line">6 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="过滤数据"><a href="#过滤数据" class="headerlink" title="过滤数据"></a>过滤数据</h3><p>创建过滤没有邮件地址的客户的视图：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; CREATE VIEW customeremaillist AS</span><br><span class="line">    -&gt; SELECT cust_id, cust_name, cust_email</span><br><span class="line">    -&gt; FROM customers</span><br><span class="line">    -&gt; WHERE cust_email IS NOT NULL;</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br></pre></td></tr></table></figure>

<p>从视图中检索拥有邮件地址的客户：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from customeremaillist;</span><br><span class="line">+---------+----------------+---------------------+</span><br><span class="line">| cust_id | cust_name      | cust_email          |</span><br><span class="line">+---------+----------------+---------------------+</span><br><span class="line">|   10001 | Coyote Inc.    | ylee@coyote.com     |</span><br><span class="line">|   10003 | Wascals        | rabbit@wascally.com |</span><br><span class="line">|   10004 | Yosemite Place | sam@yosemite.com    |</span><br><span class="line">+---------+----------------+---------------------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="计算字段-1"><a href="#计算字段-1" class="headerlink" title="计算字段"></a>计算字段</h3><p>创建视图计算每种物品的总和：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; CREATE VIEW orderitemsexpanded AS</span><br><span class="line">    -&gt; SELECT order_num,</span><br><span class="line">    -&gt; prod_id,</span><br><span class="line">    -&gt; quantity,</span><br><span class="line">    -&gt; item_price,</span><br><span class="line">    -&gt; quantity*item_price AS expanded_price</span><br><span class="line">    -&gt; FROM orderitems;</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br></pre></td></tr></table></figure>

<p>直接检索视图就可以获得总和：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM orderitemsexpanded</span><br><span class="line">    -&gt; WHERE order_num &#x3D; 20005;</span><br><span class="line">+-----------+---------+----------+------------+----------------+</span><br><span class="line">| order_num | prod_id | quantity | item_price | expanded_price |</span><br><span class="line">+-----------+---------+----------+------------+----------------+</span><br><span class="line">|     20005 | ANV01   |       10 |       5.99 |          59.90 |</span><br><span class="line">|     20005 | ANV02   |        3 |       9.99 |          29.97 |</span><br><span class="line">|     20005 | TNT2    |        5 |      10.00 |          50.00 |</span><br><span class="line">|     20005 | FB      |        1 |      10.00 |          10.00 |</span><br><span class="line">+-----------+---------+----------+------------+----------------+</span><br><span class="line">4 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="更新视图"><a href="#更新视图" class="headerlink" title="更新视图"></a>更新视图</h3><p>通常，视图是可以更新的，更新一个视图将更新其基表。但如果视图定义中有以下操作，则不能更新视图：</p>
<ul>
<li>分组（<code>GROUP BY</code>、<code>HAVING</code>）</li>
<li>连接</li>
<li>子查询</li>
<li>并</li>
<li>聚集函数</li>
<li>DISTINCT</li>
<li>计算列</li>
</ul>
<h2 id="存储过程（stored-procedure）"><a href="#存储过程（stored-procedure）" class="headerlink" title="存储过程（stored procedure）"></a>存储过程（stored procedure）</h2><p>使用存储过程的理由：简单、安全、高性能</p>
<ul>
<li>简化复杂的操作</li>
<li>保证数据的完整性<ul>
<li>防止错误，保证数据的一致性</li>
</ul>
</li>
<li>简化对变动的管理<ul>
<li>安全性</li>
</ul>
</li>
<li>提高性能</li>
<li>功能更强更灵活</li>
</ul>
<p>缺陷</p>
<ul>
<li>复杂</li>
<li>权限<ul>
<li>编写权限和执行权限分离，不能编写但可以执行</li>
</ul>
</li>
</ul>
<h3 id="CREATE-PROCEDURE"><a href="#CREATE-PROCEDURE" class="headerlink" title="CREATE PROCEDURE"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/create-procedure.html">CREATE PROCEDURE</a></h3><p>使用 <code>CREATE PROCEDIRE</code> 创建一个返回平均值 priceaverage 的存储过程，不接受参数。<code>BEGIN</code> 和 <code>END</code> 用来限定存储过程体。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> productpricing()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">SELECT</span> <span class="keyword">AVG</span>(prod_price) <span class="keyword">AS</span> priceaverage</span><br><span class="line">  <span class="keyword">FROM</span> products;</span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure>

<p>使用 <code>DELIMITER</code> 临时更改语句分隔符，使用 <code>//</code> 作为新的语句结束分隔符：</p>
<ul>
<li>除了 <code>\</code> 之外，任何字符都可以用作语句分隔符</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; DELIMITER &#x2F;&#x2F;</span><br><span class="line">mysql&gt; CREATE PROCEDURE productpricing()</span><br><span class="line">    -&gt; BEGIN</span><br><span class="line">    -&gt;   SELECT AVG(prod_price) AS priceaverage</span><br><span class="line">    -&gt;   FROM products;</span><br><span class="line">    -&gt; END&#x2F;&#x2F;</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br></pre></td></tr></table></figure>

<p>一般，存储过程将结果返回给指定变量。每个参数必须指定数据类型，<code>OUT</code> 表示用于从存储过程传出的值，<code>IN</code> 表示用户传入存储过程的值。</p>
<ul>
<li>存储过程的参数允许的数据类型与表中使用的数据类型相同</li>
<li>无法通过一个参数返回多个行和列</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; DROP PROCEDURE productpricing&#x2F;&#x2F;</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; CREATE PROCEDURE productpricing(</span><br><span class="line">    -&gt; OUT pl DECIMAL(8,2),</span><br><span class="line">    -&gt; OUT ph DECIMAL(8,2),</span><br><span class="line">    -&gt; OUT pa DECIMAL(8,2)</span><br><span class="line">    -&gt; )</span><br><span class="line">    -&gt; BEGIN</span><br><span class="line">    -&gt;   SELECT MIN(prod_price)</span><br><span class="line">    -&gt;   INTO pl</span><br><span class="line">    -&gt;   FROM products;</span><br><span class="line">    -&gt;   SELECT MAX(prod_price)</span><br><span class="line">    -&gt;   INTO ph</span><br><span class="line">    -&gt;   FROM products;</span><br><span class="line">    -&gt;   SELECT AVG(prod_price)</span><br><span class="line">    -&gt;   INTO pa</span><br><span class="line">    -&gt;   FROM products;</span><br><span class="line">    -&gt; END&#x2F;&#x2F;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>接受订单号并返回该订单的合计：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; CREATE PROCEDURE ordertotal(</span><br><span class="line">    -&gt; IN onumber INT,</span><br><span class="line">    -&gt; OUT ototal DECIMAL(8,2)</span><br><span class="line">    -&gt; )</span><br><span class="line">    -&gt; BEGIN</span><br><span class="line">    -&gt;   SELECT SUM(item_price*quantity)</span><br><span class="line">    -&gt;   FROM orderitems</span><br><span class="line">    -&gt;   WHERE order_num &#x3D; onumber</span><br><span class="line">    -&gt;   INTO ototal;</span><br><span class="line">    -&gt; END&#x2F;&#x2F;</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br></pre></td></tr></table></figure>

<h3 id="CALL"><a href="#CALL" class="headerlink" title="CALL"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/call.html">CALL</a></h3><p>MySQL 称存储过程的执行为调用，因此使用 <code>CALL</code> 调用存储过程，接受存储过程的名字以及参数。调用上一小节创建的第一个存储过程：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; CALL productpricing();</span><br><span class="line">+--------------+</span><br><span class="line">| priceaverage |</span><br><span class="line">+--------------+</span><br><span class="line">|    16.133571 |</span><br><span class="line">+--------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>调用需要传递参数的存储过程：</p>
<ul>
<li>用户变量（<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/user-variables.html">User-Defined Variables</a>） 以 <code>@</code> 开头，由字母和 <code>._$</code> 构成。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; DELIMITER ;</span><br><span class="line">mysql&gt; CALL productpricing(@pricelow,</span><br><span class="line">    -&gt;                     @pricehigh,</span><br><span class="line">    -&gt;                     @priceaverage);</span><br><span class="line">Query OK, 1 row affected, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select @pricelow, @pricehigh, @priceaverage;</span><br><span class="line">+<span class="comment">-----------+------------+---------------+</span></span><br><span class="line">| @pricelow | @pricehigh | @priceaverage |</span><br><span class="line">+<span class="comment">-----------+------------+---------------+</span></span><br><span class="line">|      2.50 |      55.00 |         16.13 |</span><br><span class="line">+<span class="comment">-----------+------------+---------------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<p>调用具有输入值的函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; CALL ordertotal(20005, @total);</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select @total;</span><br><span class="line">+--------+</span><br><span class="line">| @total |</span><br><span class="line">+--------+</span><br><span class="line">| 149.87 |</span><br><span class="line">+--------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="DROP-PROCEDURE"><a href="#DROP-PROCEDURE" class="headerlink" title="DROP PROCEDURE"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/drop-procedure.html">DROP PROCEDURE</a></h3><p>删除存储过程使用 <code>DROP PROCEDURE</code>，给出存储过程名即可，例如：</p>
<ul>
<li>如果存储过程不存在，则会产生一个错误</li>
<li>仅当存在时删除使用 <code>DROP PROCEDURE IF EXISTS</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; DROP PROCEDURE productpricing;</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br></pre></td></tr></table></figure>

<h3 id="SHOW-CREATE-PROCEDURE"><a href="#SHOW-CREATE-PROCEDURE" class="headerlink" title="SHOW CREATE PROCEDURE"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/show-create-procedure.html">SHOW CREATE PROCEDURE</a></h3><p>显示创建存储过程的 <code>CREATE</code> 语句：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SHOW CREATE PROCEDURE ordertotal;</span><br><span class="line">+------------+-----------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+----------------------+--------------------+</span><br><span class="line">| Procedure  | sql_mode                                                                                                              | Create Procedure                                                                                                                                                                                             | character_set_client | collation_connection | Database Collation |</span><br><span class="line">+------------+-----------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+----------------------+--------------------+</span><br><span class="line">| ordertotal | ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION | CREATE DEFINER&#x3D;&#96;root&#96;@&#96;localhost&#96; PROCEDURE &#96;ordertotal&#96;(</span><br><span class="line">IN onumber INT,</span><br><span class="line">OUT ototal DECIMAL(8,2)</span><br><span class="line">)</span><br><span class="line">BEGIN</span><br><span class="line">  SELECT SUM(item_price*quantity)</span><br><span class="line">  FROM orderitems</span><br><span class="line">  WHERE order_num &#x3D; onumber</span><br><span class="line">  INTO ototal;</span><br><span class="line">END | latin1               | latin1_swedish_ci    | utf8mb4_0900_ai_ci |</span><br><span class="line">+------------+-----------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------+----------------------+--------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="SHOW-PROCEDURE-STATUS"><a href="#SHOW-PROCEDURE-STATUS" class="headerlink" title="SHOW PROCEDURE STATUS"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/show-procedure-status.html">SHOW PROCEDURE STATUS</a></h3><p><code>SHOW PROCEDURE STATUS</code> 显示所有存储过程的详细信息，可以使用 <code>LIKE</code> 过滤</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SHOW PROCEDURE STATUS LIKE &#39;ordertotal&#39;;</span><br><span class="line">+------+------------+-----------+----------------+---------------------+---------------------+---------------+---------+----------------------+----------------------+--------------------+</span><br><span class="line">| Db   | Name       | Type      | Definer        | Modified            | Created             | Security_type | Comment | character_set_client | collation_connection | Database Collation |</span><br><span class="line">+------+------------+-----------+----------------+---------------------+---------------------+---------------+---------+----------------------+----------------------+--------------------+</span><br><span class="line">| test | ordertotal | PROCEDURE | root@localhost | 2020-11-22 13:29:10 | 2020-11-22 13:29:10 | DEFINER       |         | latin1               | latin1_swedish_ci    | utf8mb4_0900_ai_ci |</span><br><span class="line">+------+------------+-----------+----------------+---------------------+---------------------+---------------+---------+----------------------+----------------------+--------------------+</span><br><span class="line">1 row in set (0.01 sec)</span><br></pre></td></tr></table></figure>

<h3 id="智能存储过程"><a href="#智能存储过程" class="headerlink" title="智能存储过程"></a>智能存储过程</h3><ul>
<li>获得合计</li>
<li>添加营业税</li>
<li>返回合计（带税或不带税）</li>
</ul>
<p>其中，<code>--</code> 表示注释，<code>DECLARE</code> 定义局部变量（及其数据类型，支持默认值），<code>COMMENT</code> 值将在 <code>SHOW PROCEDURE STATUS</code> 的结果中显示。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- Name: ordertotal</span></span><br><span class="line"><span class="comment">-- Parameters: onumber = order number</span></span><br><span class="line"><span class="comment">--             taxable = 0 if not taxable, 1 if taxable</span></span><br><span class="line"><span class="comment">--             ototal = order total variable</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> ordertotal(</span><br><span class="line"><span class="keyword">IN</span> onumber <span class="built_in">INT</span>,</span><br><span class="line"><span class="keyword">IN</span> taxable <span class="built_in">BOOLEAN</span>,</span><br><span class="line"><span class="keyword">OUT</span> ototal <span class="built_in">DECIMAL</span>(<span class="number">8</span>,<span class="number">2</span>)</span><br><span class="line">) <span class="keyword">COMMENT</span> <span class="string">&#x27;Obtain order total, optionally adding tax&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">-- Declare variable for total</span></span><br><span class="line">  <span class="keyword">DECLARE</span> total <span class="built_in">DECIMAL</span>(<span class="number">8</span>,<span class="number">2</span>);</span><br><span class="line">  <span class="comment">-- Declare tax percentage</span></span><br><span class="line">  <span class="keyword">DECLARE</span> taxrate <span class="built_in">INT</span> <span class="keyword">DEFAULT</span> <span class="number">6</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">-- Get te order total</span></span><br><span class="line">  <span class="keyword">SELECT</span> <span class="keyword">SUM</span>(item_price*quantity)</span><br><span class="line">  <span class="keyword">FROM</span> orderitems</span><br><span class="line">  <span class="keyword">WHERE</span> order_num = onumber</span><br><span class="line">  <span class="keyword">INTO</span> total;</span><br><span class="line"></span><br><span class="line">  <span class="comment">-- Is this taxable?</span></span><br><span class="line">  IF taxable THEN</span><br><span class="line">    <span class="comment">-- Yes, so add taxrate to the total</span></span><br><span class="line">    <span class="keyword">SELECT</span> total+(total/<span class="number">100</span>*taxrate) <span class="keyword">INTO</span> total;</span><br><span class="line">  <span class="keyword">END</span> <span class="keyword">IF</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">-- And finally, save to out variable</span></span><br><span class="line">  <span class="keyword">SELECT</span> total <span class="keyword">INTO</span> ototal;</span><br><span class="line"></span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<p>先删除再创建 ordertotal 存储过程，注意设置分隔符。不添加营业税：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; CALL ordertotal(20005, 0, @total);</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select @total;</span><br><span class="line">+--------+</span><br><span class="line">| @total |</span><br><span class="line">+--------+</span><br><span class="line">| 149.87 |</span><br><span class="line">+--------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>添加营业税：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; CALL ordertotal(20005, 1, @total);</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select @total;</span><br><span class="line">+--------+</span><br><span class="line">| @total |</span><br><span class="line">+--------+</span><br><span class="line">| 158.86 |</span><br><span class="line">+--------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h2 id="游标"><a href="#游标" class="headerlink" title="游标"></a>游标</h2><p>MySQL 检索返回一组称为结果集的行，使用游标（<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/cursors.html">Cursor</a>）可以在检索出的行中前进或后退。游标是存储在 MySQL 服务器上的数据库查询，在存储了游标之后就可以根据需要滚动浏览其中的数据。</p>
<p>MySQL 的游标只能用于存储过程和函数。</p>
<h3 id="创建"><a href="#创建" class="headerlink" title="创建"></a>创建</h3><p>使用 <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/declare-cursor.html"><code>DECLARE</code></a> 命名游标，并定义相应的 <code>SELECT</code> 语句，存储过程处理完成后，游标就消失（仅限于存储过程）。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> processorders()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">DECLARE</span> ordernumbers <span class="keyword">CURSOR</span></span><br><span class="line">  <span class="keyword">FOR</span></span><br><span class="line">  <span class="keyword">SELECT</span> order_num <span class="keyword">FROM</span> orders;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<h3 id="打开和关闭"><a href="#打开和关闭" class="headerlink" title="打开和关闭"></a>打开和关闭</h3><p>使用 <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/open.html"><code>OPEN</code></a> 打开游标：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">OPEN ordernumbers;</span><br></pre></td></tr></table></figure>

<p>游标处理完毕后，使用 <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/close.html"><code>CLOSE</code></a> 关闭游标：</p>
<ul>
<li>释放游标使用的所有内部内存和资源</li>
<li>MySQL 会在存储过程到达 <code>END</code> 语句时自动关闭游标</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CLOSE ordernumbers;</span><br></pre></td></tr></table></figure>

<h3 id="使用游标"><a href="#使用游标" class="headerlink" title="使用游标"></a>使用游标</h3><p>使用 <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/fetch.html"><code>FETCH</code></a> 指定检索的数据和存储的位置。</p>
<p><code>DECLARE</code> 语句的次序</p>
<ul>
<li>局部变量</li>
<li>游标</li>
<li>句柄</li>
</ul>
<p>使用游标循环检索数据，指定另一个存储过程计算每个订单的带税合计，并存储到 ordertotals 表中</p>
<ul>
<li><code>CONTINUE HANDLER</code> 是满足条件时被执行的代码</li>
<li><code>&#39;02000&#39;</code> 是一个未找到条件，当 <code>REPEAT</code> 由于没有更多的行循环而抛出</li>
<li><code>UNTIL done END REPEAT</code> 规定循环结束条件</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> processorders()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">-- Declare local variables</span></span><br><span class="line">  <span class="keyword">DECLARE</span> done <span class="built_in">BOOLEAN</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">DECLARE</span> o <span class="built_in">INT</span>;</span><br><span class="line">  <span class="keyword">DECLARE</span> t <span class="built_in">DECIMAL</span>(<span class="number">8</span>,<span class="number">2</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">-- Declare the cursor</span></span><br><span class="line">  <span class="keyword">DECLARE</span> ordernumbers <span class="keyword">CURSOR</span></span><br><span class="line">  <span class="keyword">FOR</span></span><br><span class="line">  <span class="keyword">SELECT</span> order_num <span class="keyword">FROM</span> orders;</span><br><span class="line"></span><br><span class="line">  <span class="comment">-- Declare continue handler</span></span><br><span class="line">  <span class="keyword">DECLARE</span> CONTINUE <span class="keyword">HANDLER</span> <span class="keyword">FOR</span> <span class="keyword">SQLSTATE</span> <span class="string">&#x27;02000&#x27;</span> <span class="keyword">SET</span> done=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">-- Open the cursor</span></span><br><span class="line">  OPEN ordernumbers;</span><br><span class="line"></span><br><span class="line">  <span class="comment">-- Loop through all rows</span></span><br><span class="line">  REPEAT</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- Get order number</span></span><br><span class="line">    FETCH ordernumbers INTO o;</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- Get the total for this order</span></span><br><span class="line">    <span class="keyword">CALL</span> ordertotal(o, <span class="number">1</span>, t);</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- Insert order and total into ordertotals</span></span><br><span class="line">    <span class="keyword">INSERT</span> <span class="keyword">INTO</span> ordertotals(order_num, total)</span><br><span class="line">    <span class="keyword">VALUES</span>(o, t);</span><br><span class="line"></span><br><span class="line">  <span class="comment">-- End of loop</span></span><br><span class="line">  UNTIL done <span class="keyword">END</span> <span class="keyword">REPEAT</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">-- Close the cursor</span></span><br><span class="line">  CLOSE ordernumbers;</span><br><span class="line"></span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<p>创建 ordertotals 表，执行存储过程并查看结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; CREATE TABLE ordertotals(</span><br><span class="line">    -&gt;   id int NOT NULL AUTO_INCREMENT,</span><br><span class="line">    -&gt;   order_num int NOT NULL,</span><br><span class="line">    -&gt;   total int NOT NULL,</span><br><span class="line">    -&gt;   PRIMARY KEY (id)</span><br><span class="line">    -&gt; );</span><br><span class="line">Query OK, 0 rows affected (0.02 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; CALL processorders();</span><br><span class="line">Query OK, 1 row affected (0.02 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT * FROM ordertotals;</span><br><span class="line">+----+-----------+-------+</span><br><span class="line">| id | order_num | total |</span><br><span class="line">+----+-----------+-------+</span><br><span class="line">|  1 |     20005 |   159 |</span><br><span class="line">|  2 |     20009 |    41 |</span><br><span class="line">|  3 |     20006 |    58 |</span><br><span class="line">|  4 |     20007 |  1060 |</span><br><span class="line">|  5 |     20008 |   133 |</span><br><span class="line">|  6 |     20008 |   133 |</span><br><span class="line">+----+-----------+-------+</span><br><span class="line">6 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h2 id="触发器（Triggers）"><a href="#触发器（Triggers）" class="headerlink" title="触发器（Triggers）"></a>触发器（<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/triggers.html">Triggers</a>）</h2><p>触发器是 MySQL 响应以下任意语句而自动执行的一条或一组 MySQL 语句：</p>
<ul>
<li><code>INSERT</code></li>
<li><code>UPDATE</code></li>
<li><code>DELETE</code></li>
</ul>
<p>只有表支持触发器，视图和临时表都不支持。触发器按每个表每个事件每次定义，相同事件次序的触发器默认按照创建时间顺序执行。</p>
<p>使用触发器保证数据的一致性（大小写、格式等），可以用于创建审计跟踪。</p>
<h3 id="创建-1"><a href="#创建-1" class="headerlink" title="创建"></a>创建</h3><p>创建触发器时，需要给出 4 条信息：</p>
<ul>
<li>唯一的触发器名<ul>
<li>每个表中唯一</li>
</ul>
</li>
<li>关联的表</li>
<li>响应的活动</li>
<li>何时执行（活动前或活动后）</li>
</ul>
<p>使用 <code>CREATE TRIGGER</code> 创建触发器。例如，对 products 表创建一个响应插入的触发器，<code>FOR EACH ROW</code> 表示对每个插入执行：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> newproduct <span class="keyword">AFTER</span> <span class="keyword">INSERT</span> <span class="keyword">ON</span> products</span><br><span class="line"><span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="keyword">ROW</span> <span class="keyword">SELECT</span> <span class="string">&#x27;Product added&#x27;</span> <span class="keyword">INTO</span> @tmp;</span><br></pre></td></tr></table></figure>

<h3 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h3><p>使用 <code>DROP TRIGGER</code> 删除触发器：</p>
<ul>
<li>触发器不能更新或覆盖，为了修改，只能删除后重新创建</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TRIGGER</span> newproduct;</span><br></pre></td></tr></table></figure>

<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><p><strong>INSERT</strong></p>
<ul>
<li>在 INSERT 触发器内，可以引用一个名为 NEW 的虚拟表，访问被插入的行</li>
<li>在 BEFORE INSERT 出发其中，NEW 中的值也可以被更新（允许更改被插入的值）<ul>
<li>通常用于数据验证和净化</li>
</ul>
</li>
<li>对于 <code>AUTO_INCREMENT</code> 列，NEW 在 INSERT 执行前包含 0 ，在 INSERT 执行后包含新的自动生成值</li>
</ul>
<p>获得自增量 order_num ：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; CREATE TRIGGER neworder AFTER INSERT ON orders</span><br><span class="line">    -&gt; FOR EACH ROW SELECT NEW.order_num INTO @tmp;</span><br><span class="line">Query OK, 0 rows affected (0.02 sec)</span><br></pre></td></tr></table></figure>

<p>插入数据进行测试：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; INSERT INTO orders(order_date, cust_id)</span><br><span class="line">    -&gt; VALUES(NOW(), 10001);</span><br><span class="line">Query OK, 1 row affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select @tmp;</span><br><span class="line">+-------+</span><br><span class="line">| @tmp  |</span><br><span class="line">+-------+</span><br><span class="line">| 20010 |</span><br><span class="line">+-------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>DELETE</strong></p>
<ul>
<li>在 DELETE 触发器内，可以引用一个名为 OLD 的虚拟表，访问被删除的行</li>
<li>OLD 中的值全部是只读的</li>
</ul>
<p>将被删除的订单保存到存档表 archive_orders 中，使用 <code>DEFORE DELETE</code> 保证订单无法存档时，就不执行 <code>DELETE</code> 操作：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> deleteorder <span class="keyword">BEFORE</span> <span class="keyword">DELETE</span> <span class="keyword">ON</span> orders</span><br><span class="line"><span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="keyword">ROW</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">INSERT</span> <span class="keyword">INTO</span> archive_orders(order_num, order_date, cust_id)</span><br><span class="line">  <span class="keyword">VALUES</span>(OLD.order_num, OLD.order_date, OLD.cust_id);</span><br><span class="line"><span class="keyword">END</span></span><br></pre></td></tr></table></figure>

<p><strong>UPDATE</strong></p>
<ul>
<li>在 UPDATE 触发器内，可以引用一个名为 OLD 的虚拟表，访问旧值，引用一个名为 NEW 的虚拟表，访问新值</li>
<li>在 BEFORE UPDATE 出发其中，NEW 中的值也可以被更新（允许更改被更新的值）</li>
<li>OLD 中的值全部是只读的</li>
</ul>
<p>保证州名缩写总是大写：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> updatevendor <span class="keyword">BEFORE</span> <span class="keyword">UPDATE</span> <span class="keyword">ON</span> vendors</span><br><span class="line"><span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="keyword">ROW</span> <span class="keyword">SET</span> NEW.vend_state = <span class="keyword">Upper</span>(NEW.vend_state);</span><br></pre></td></tr></table></figure>

<h2 id="事务（TRANSACTION）"><a href="#事务（TRANSACTION）" class="headerlink" title="事务（TRANSACTION）"></a>事务（<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/sql-transactional-statements.html">TRANSACTION</a>）</h2><p>事务处理（transaction processing）可以用来维护数据库的完整性，保证成批的 MySQL 语句要么全部执行，要么完全不执行，数据库不会包含不完整的操作结果。事务用来管理 <code>INSERT</code>、<code>UPDATE</code>、 <code>DELETE</code> 语句</p>
<p>相关术语</p>
<ul>
<li>事务（transaction）：一组 SQL 语句</li>
<li>回退（rollback）：撤销指定 SQL 语句的过程</li>
<li>提交（commit）：将未存储的 SQL 语句结果写入数据库表</li>
<li>保留点（savepoint）：指事务处理中设置的临时占位符（placeholder），可以对其发布回退</li>
</ul>
<p>默认的 MySQL 行为是自动提交所有更改，<code>SET autocommit=0</code> 设置不自动提交更改，针对每个连接（而不是服务器）。</p>
<h3 id="控制事务处理"><a href="#控制事务处理" class="headerlink" title="控制事务处理"></a>控制事务处理</h3><p>管理事务处理的关键在于将 SQL 语句组分解为逻辑块，并明确规定数据何时应该回退，何时不应该回退。</p>
<p><strong>ROLLBACK</strong></p>
<p>使用 <code>START TRANSACTION</code> 标识事务的开始，<code>ROLLBACK</code> 用来回退（撤销） MySQL 语句</p>
<ul>
<li><code>ROLLBACK</code> 只能在一个事务处理内使用，即执行一条 <code>START TRANSACTION</code> 语句之后</li>
<li>不能回退 <code>SELECT</code>、<code>CREATE</code>、 <code>DROP</code></li>
</ul>
<p>删除所有行，然后回退：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM ordertotals;</span><br><span class="line">+----+-----------+-------+</span><br><span class="line">| id | order_num | total |</span><br><span class="line">+----+-----------+-------+</span><br><span class="line">|  1 |     20005 |   159 |</span><br><span class="line">|  2 |     20009 |    41 |</span><br><span class="line">|  3 |     20006 |    58 |</span><br><span class="line">|  4 |     20007 |  1060 |</span><br><span class="line">|  5 |     20008 |   133 |</span><br><span class="line">|  6 |     20008 |   133 |</span><br><span class="line">+----+-----------+-------+</span><br><span class="line">6 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; START TRANSACTION;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; DELETE FROM ordertotals;</span><br><span class="line">Query OK, 6 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT * FROM ordertotals;</span><br><span class="line">Empty set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; ROLLBACK;</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT * FROM ordertotals;</span><br><span class="line">+----+-----------+-------+</span><br><span class="line">| id | order_num | total |</span><br><span class="line">+----+-----------+-------+</span><br><span class="line">|  1 |     20005 |   159 |</span><br><span class="line">|  2 |     20009 |    41 |</span><br><span class="line">|  3 |     20006 |    58 |</span><br><span class="line">|  4 |     20007 |  1060 |</span><br><span class="line">|  5 |     20008 |   133 |</span><br><span class="line">|  6 |     20008 |   133 |</span><br><span class="line">+----+-----------+-------+</span><br><span class="line">6 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>COMMIT</strong></p>
<p>隐含提交（implicit commit），即提交（写或保存）操作是自动进行的。在事务处理块中，必须使用 <code>COMMIT</code> 语句显式提交。</p>
<p>隐含事务关闭，当 <code>COMMIT</code> 或 <code>ROLLBACK</code> 语句执行后，事务会自动关闭</p>
<p>从数据库中完全删除订单 20010 ，涉及两张表，如果有一条 <code>DELETE</code> 语句失败则不会删除：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; START TRANSACTION;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; DELETE FROM orderitems WHERE order_num&#x3D; 20010;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; DELETE FROM orders WHERE order_num&#x3D; 20010;</span><br><span class="line">Query OK, 1 row affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; COMMIT;</span><br><span class="line">Query OK, 0 rows affected (0.07 sec)</span><br></pre></td></tr></table></figure>

<p><strong>SAVEPOINT</strong></p>
<p>保留点用于支持事务的部分回退，使用 <code>SAVEPOINT</code> 创建占位符（保留点），并且名字唯一：</p>
<ul>
<li>保留点在事务处理完成（执行一条 <code>ROLLBACK</code> 或 <code>COMMIT</code>）后自动释放</li>
<li>可使用 <code>RELEASE SAVEPOINT</code> 显式释放</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SAVEPOINT</span> delete1</span><br></pre></td></tr></table></figure>

<p>回退到保留点：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ROLLBACK</span> <span class="keyword">TO</span> delete1</span><br></pre></td></tr></table></figure>

<h2 id="字符集和校对"><a href="#字符集和校对" class="headerlink" title="字符集和校对"></a><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/charset.html">字符集和校对</a></h2><p>相关术语</p>
<ul>
<li>字符集：字母和符号的集合</li>
<li>编码：某个字符集成员的内部表示</li>
<li>校对：规定字符如何比较</li>
</ul>
<p>MySQL 按照以下顺序使用字符集合校对</p>
<ul>
<li>指定 CHARACTER SET 和 COLLATION</li>
<li>只指定 CHARACTER SET ，使用默认 COLLATION</li>
<li>二者都没指定，使用数据库默认值</li>
</ul>
<p><code>SHOW CHARACTER SET</code> 显示所有可用的字符集以及每个字符集的描述和默认校对：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SHOW CHARACTER_SET;</span><br><span class="line">ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#39;CHARACTER_SET&#39; at line 1</span><br><span class="line">mysql&gt; SHOW CHARACTER SET;</span><br><span class="line">+----------+---------------------------------+---------------------+--------+</span><br><span class="line">| Charset  | Description                     | Default collation   | Maxlen |</span><br><span class="line">+----------+---------------------------------+---------------------+--------+</span><br><span class="line">| armscii8 | ARMSCII-8 Armenian              | armscii8_general_ci |      1 |</span><br><span class="line">| ascii    | US ASCII                        | ascii_general_ci    |      1 |</span><br><span class="line">| big5     | Big5 Traditional Chinese        | big5_chinese_ci     |      2 |</span><br><span class="line">| binary   | Binary pseudo charset           | binary              |      1 |</span><br><span class="line">| cp1250   | Windows Central European        | cp1250_general_ci   |      1 |</span><br><span class="line">| cp1251   | Windows Cyrillic                | cp1251_general_ci   |      1 |</span><br><span class="line">| cp1256   | Windows Arabic                  | cp1256_general_ci   |      1 |</span><br><span class="line">| cp1257   | Windows Baltic                  | cp1257_general_ci   |      1 |</span><br><span class="line">| cp850    | DOS West European               | cp850_general_ci    |      1 |</span><br><span class="line">| cp852    | DOS Central European            | cp852_general_ci    |      1 |</span><br><span class="line">| cp866    | DOS Russian                     | cp866_general_ci    |      1 |</span><br><span class="line">| cp932    | SJIS for Windows Japanese       | cp932_japanese_ci   |      2 |</span><br><span class="line">| dec8     | DEC West European               | dec8_swedish_ci     |      1 |</span><br><span class="line">| eucjpms  | UJIS for Windows Japanese       | eucjpms_japanese_ci |      3 |</span><br><span class="line">| euckr    | EUC-KR Korean                   | euckr_korean_ci     |      2 |</span><br><span class="line">| gb18030  | China National Standard GB18030 | gb18030_chinese_ci  |      4 |</span><br><span class="line">| gb2312   | GB2312 Simplified Chinese       | gb2312_chinese_ci   |      2 |</span><br><span class="line">| gbk      | GBK Simplified Chinese          | gbk_chinese_ci      |      2 |</span><br><span class="line">| geostd8  | GEOSTD8 Georgian                | geostd8_general_ci  |      1 |</span><br><span class="line">| greek    | ISO 8859-7 Greek                | greek_general_ci    |      1 |</span><br><span class="line">| hebrew   | ISO 8859-8 Hebrew               | hebrew_general_ci   |      1 |</span><br><span class="line">| hp8      | HP West European                | hp8_english_ci      |      1 |</span><br><span class="line">| keybcs2  | DOS Kamenicky Czech-Slovak      | keybcs2_general_ci  |      1 |</span><br><span class="line">| koi8r    | KOI8-R Relcom Russian           | koi8r_general_ci    |      1 |</span><br><span class="line">| koi8u    | KOI8-U Ukrainian                | koi8u_general_ci    |      1 |</span><br><span class="line">| latin1   | cp1252 West European            | latin1_swedish_ci   |      1 |</span><br><span class="line">| latin2   | ISO 8859-2 Central European     | latin2_general_ci   |      1 |</span><br><span class="line">| latin5   | ISO 8859-9 Turkish              | latin5_turkish_ci   |      1 |</span><br><span class="line">| latin7   | ISO 8859-13 Baltic              | latin7_general_ci   |      1 |</span><br><span class="line">| macce    | Mac Central European            | macce_general_ci    |      1 |</span><br><span class="line">| macroman | Mac West European               | macroman_general_ci |      1 |</span><br><span class="line">| sjis     | Shift-JIS Japanese              | sjis_japanese_ci    |      2 |</span><br><span class="line">| swe7     | 7bit Swedish                    | swe7_swedish_ci     |      1 |</span><br><span class="line">| tis620   | TIS620 Thai                     | tis620_thai_ci      |      1 |</span><br><span class="line">| ucs2     | UCS-2 Unicode                   | ucs2_general_ci     |      2 |</span><br><span class="line">| ujis     | EUC-JP Japanese                 | ujis_japanese_ci    |      3 |</span><br><span class="line">| utf16    | UTF-16 Unicode                  | utf16_general_ci    |      4 |</span><br><span class="line">| utf16le  | UTF-16LE Unicode                | utf16le_general_ci  |      4 |</span><br><span class="line">| utf32    | UTF-32 Unicode                  | utf32_general_ci    |      4 |</span><br><span class="line">| utf8     | UTF-8 Unicode                   | utf8_general_ci     |      3 |</span><br><span class="line">| utf8mb4  | UTF-8 Unicode                   | utf8mb4_0900_ai_ci  |      4 |</span><br><span class="line">+----------+---------------------------------+---------------------+--------+</span><br><span class="line">41 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><code>SHOW COLLATION</code> 显示所支持校对的完整列表，显示所有可用的校对，以及适用的字符集：</p>
<ul>
<li>有的字符集不止一种校对</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SHOW COLLATION;</span><br><span class="line">+<span class="comment">----------------------------+----------+-----+---------+----------+---------+---------------+</span></span><br><span class="line">| Collation                  | Charset  | Id  | Default | Compiled | Sortlen | Pad_attribute |</span><br><span class="line">+<span class="comment">----------------------------+----------+-----+---------+----------+---------+---------------+</span></span><br><span class="line">| armscii8_bin               | armscii8 |  64 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| armscii8_general_ci        | armscii8 |  32 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| ascii_bin                  | ascii    |  65 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| ascii_general_ci           | ascii    |  11 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| big5_bin                   | big5     |  84 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| big5_chinese_ci            | big5     |   1 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| binary                     | binary   |  63 | Yes     | Yes      |       1 | NO PAD        |</span><br><span class="line">| cp1250_bin                 | cp1250   |  66 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| cp1250_croatian_ci         | cp1250   |  44 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| cp1250_czech_cs            | cp1250   |  34 |         | Yes      |       2 | PAD SPACE     |</span><br><span class="line">| cp1250_general_ci          | cp1250   |  26 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| cp1250_polish_ci           | cp1250   |  99 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| cp1251_bin                 | cp1251   |  50 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| cp1251_bulgarian_ci        | cp1251   |  14 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| cp1251_general_ci          | cp1251   |  51 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| cp1251_general_cs          | cp1251   |  52 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| cp1251_ukrainian_ci        | cp1251   |  23 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| cp1256_bin                 | cp1256   |  67 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| cp1256_general_ci          | cp1256   |  57 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| cp1257_bin                 | cp1257   |  58 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| cp1257_general_ci          | cp1257   |  59 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| cp1257_lithuanian_ci       | cp1257   |  29 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| cp850_bin                  | cp850    |  80 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| cp850_general_ci           | cp850    |   4 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| cp852_bin                  | cp852    |  81 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| cp852_general_ci           | cp852    |  40 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| cp866_bin                  | cp866    |  68 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| cp866_general_ci           | cp866    |  36 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| cp932_bin                  | cp932    |  96 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| cp932_japanese_ci          | cp932    |  95 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| dec8_bin                   | dec8     |  69 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| dec8_swedish_ci            | dec8     |   3 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| eucjpms_bin                | eucjpms  |  98 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| eucjpms_japanese_ci        | eucjpms  |  97 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| euckr_bin                  | euckr    |  85 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| euckr_korean_ci            | euckr    |  19 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| gb18030_bin                | gb18030  | 249 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| gb18030_chinese_ci         | gb18030  | 248 | Yes     | Yes      |       2 | PAD SPACE     |</span><br><span class="line">| gb18030_unicode_520_ci     | gb18030  | 250 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| gb2312_bin                 | gb2312   |  86 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| gb2312_chinese_ci          | gb2312   |  24 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| gbk_bin                    | gbk      |  87 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| gbk_chinese_ci             | gbk      |  28 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| geostd8_bin                | geostd8  |  93 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| geostd8_general_ci         | geostd8  |  92 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| greek_bin                  | greek    |  70 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| greek_general_ci           | greek    |  25 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| hebrew_bin                 | hebrew   |  71 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| hebrew_general_ci          | hebrew   |  16 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| hp8_bin                    | hp8      |  72 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| hp8_english_ci             | hp8      |   6 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| keybcs2_bin                | keybcs2  |  73 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| keybcs2_general_ci         | keybcs2  |  37 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| koi8r_bin                  | koi8r    |  74 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| koi8r_general_ci           | koi8r    |   7 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| koi8u_bin                  | koi8u    |  75 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| koi8u_general_ci           | koi8u    |  22 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| latin1_bin                 | latin1   |  47 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| latin1_danish_ci           | latin1   |  15 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| latin1_general_ci          | latin1   |  48 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| latin1_general_cs          | latin1   |  49 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| latin1_german1_ci          | latin1   |   5 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| latin1_german2_ci          | latin1   |  31 |         | Yes      |       2 | PAD SPACE     |</span><br><span class="line">| latin1_spanish_ci          | latin1   |  94 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| latin1_swedish_ci          | latin1   |   8 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| latin2_bin                 | latin2   |  77 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| latin2_croatian_ci         | latin2   |  27 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| latin2_czech_cs            | latin2   |   2 |         | Yes      |       4 | PAD SPACE     |</span><br><span class="line">| latin2_general_ci          | latin2   |   9 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| latin2_hungarian_ci        | latin2   |  21 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| latin5_bin                 | latin5   |  78 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| latin5_turkish_ci          | latin5   |  30 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| latin7_bin                 | latin7   |  79 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| latin7_estonian_cs         | latin7   |  20 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| latin7_general_ci          | latin7   |  41 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| latin7_general_cs          | latin7   |  42 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| macce_bin                  | macce    |  43 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| macce_general_ci           | macce    |  38 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| macroman_bin               | macroman |  53 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| macroman_general_ci        | macroman |  39 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| sjis_bin                   | sjis     |  88 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| sjis_japanese_ci           | sjis     |  13 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| swe7_bin                   | swe7     |  82 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| swe7_swedish_ci            | swe7     |  10 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| tis620_bin                 | tis620   |  89 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| tis620_thai_ci             | tis620   |  18 | Yes     | Yes      |       4 | PAD SPACE     |</span><br><span class="line">| ucs2_bin                   | ucs2     |  90 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| ucs2_croatian_ci           | ucs2     | 149 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| ucs2_czech_ci              | ucs2     | 138 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| ucs2_danish_ci             | ucs2     | 139 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| ucs2_esperanto_ci          | ucs2     | 145 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| ucs2_estonian_ci           | ucs2     | 134 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| ucs2_general_ci            | ucs2     |  35 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| ucs2_general_mysql500_ci   | ucs2     | 159 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| ucs2_german2_ci            | ucs2     | 148 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| ucs2_hungarian_ci          | ucs2     | 146 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| ucs2_icelandic_ci          | ucs2     | 129 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| ucs2_latvian_ci            | ucs2     | 130 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| ucs2_lithuanian_ci         | ucs2     | 140 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| ucs2_persian_ci            | ucs2     | 144 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| ucs2_polish_ci             | ucs2     | 133 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| ucs2_romanian_ci           | ucs2     | 131 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| ucs2_roman_ci              | ucs2     | 143 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| ucs2_sinhala_ci            | ucs2     | 147 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| ucs2_slovak_ci             | ucs2     | 141 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| ucs2_slovenian_ci          | ucs2     | 132 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| ucs2_spanish2_ci           | ucs2     | 142 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| ucs2_spanish_ci            | ucs2     | 135 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| ucs2_swedish_ci            | ucs2     | 136 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| ucs2_turkish_ci            | ucs2     | 137 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| ucs2_unicode_520_ci        | ucs2     | 150 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| ucs2_unicode_ci            | ucs2     | 128 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| ucs2_vietnamese_ci         | ucs2     | 151 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| ujis_bin                   | ujis     |  91 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| ujis_japanese_ci           | ujis     |  12 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| utf16le_bin                | utf16le  |  62 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| utf16le_general_ci         | utf16le  |  56 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| utf16_bin                  | utf16    |  55 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| utf16_croatian_ci          | utf16    | 122 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf16_czech_ci             | utf16    | 111 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf16_danish_ci            | utf16    | 112 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf16_esperanto_ci         | utf16    | 118 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf16_estonian_ci          | utf16    | 107 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf16_general_ci           | utf16    |  54 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| utf16_german2_ci           | utf16    | 121 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf16_hungarian_ci         | utf16    | 119 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf16_icelandic_ci         | utf16    | 102 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf16_latvian_ci           | utf16    | 103 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf16_lithuanian_ci        | utf16    | 113 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf16_persian_ci           | utf16    | 117 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf16_polish_ci            | utf16    | 106 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf16_romanian_ci          | utf16    | 104 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf16_roman_ci             | utf16    | 116 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf16_sinhala_ci           | utf16    | 120 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf16_slovak_ci            | utf16    | 114 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf16_slovenian_ci         | utf16    | 105 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf16_spanish2_ci          | utf16    | 115 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf16_spanish_ci           | utf16    | 108 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf16_swedish_ci           | utf16    | 109 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf16_turkish_ci           | utf16    | 110 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf16_unicode_520_ci       | utf16    | 123 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf16_unicode_ci           | utf16    | 101 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf16_vietnamese_ci        | utf16    | 124 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf32_bin                  | utf32    |  61 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| utf32_croatian_ci          | utf32    | 181 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf32_czech_ci             | utf32    | 170 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf32_danish_ci            | utf32    | 171 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf32_esperanto_ci         | utf32    | 177 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf32_estonian_ci          | utf32    | 166 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf32_general_ci           | utf32    |  60 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| utf32_german2_ci           | utf32    | 180 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf32_hungarian_ci         | utf32    | 178 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf32_icelandic_ci         | utf32    | 161 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf32_latvian_ci           | utf32    | 162 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf32_lithuanian_ci        | utf32    | 172 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf32_persian_ci           | utf32    | 176 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf32_polish_ci            | utf32    | 165 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf32_romanian_ci          | utf32    | 163 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf32_roman_ci             | utf32    | 175 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf32_sinhala_ci           | utf32    | 179 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf32_slovak_ci            | utf32    | 173 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf32_slovenian_ci         | utf32    | 164 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf32_spanish2_ci          | utf32    | 174 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf32_spanish_ci           | utf32    | 167 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf32_swedish_ci           | utf32    | 168 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf32_turkish_ci           | utf32    | 169 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf32_unicode_520_ci       | utf32    | 182 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf32_unicode_ci           | utf32    | 160 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf32_vietnamese_ci        | utf32    | 183 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8mb4_0900_ai_ci         | utf8mb4  | 255 | Yes     | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_0900_as_ci         | utf8mb4  | 305 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_0900_as_cs         | utf8mb4  | 278 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_0900_bin           | utf8mb4  | 309 |         | Yes      |       1 | NO PAD        |</span><br><span class="line">| utf8mb4_bin                | utf8mb4  |  46 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| utf8mb4_croatian_ci        | utf8mb4  | 245 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8mb4_cs_0900_ai_ci      | utf8mb4  | 266 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_cs_0900_as_cs      | utf8mb4  | 289 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_czech_ci           | utf8mb4  | 234 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8mb4_danish_ci          | utf8mb4  | 235 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8mb4_da_0900_ai_ci      | utf8mb4  | 267 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_da_0900_as_cs      | utf8mb4  | 290 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_de_pb_0900_ai_ci   | utf8mb4  | 256 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_de_pb_0900_as_cs   | utf8mb4  | 279 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_eo_0900_ai_ci      | utf8mb4  | 273 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_eo_0900_as_cs      | utf8mb4  | 296 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_esperanto_ci       | utf8mb4  | 241 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8mb4_estonian_ci        | utf8mb4  | 230 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8mb4_es_0900_ai_ci      | utf8mb4  | 263 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_es_0900_as_cs      | utf8mb4  | 286 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_es_trad_0900_ai_ci | utf8mb4  | 270 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_es_trad_0900_as_cs | utf8mb4  | 293 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_et_0900_ai_ci      | utf8mb4  | 262 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_et_0900_as_cs      | utf8mb4  | 285 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_general_ci         | utf8mb4  |  45 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| utf8mb4_german2_ci         | utf8mb4  | 244 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8mb4_hr_0900_ai_ci      | utf8mb4  | 275 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_hr_0900_as_cs      | utf8mb4  | 298 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_hungarian_ci       | utf8mb4  | 242 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8mb4_hu_0900_ai_ci      | utf8mb4  | 274 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_hu_0900_as_cs      | utf8mb4  | 297 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_icelandic_ci       | utf8mb4  | 225 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8mb4_is_0900_ai_ci      | utf8mb4  | 257 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_is_0900_as_cs      | utf8mb4  | 280 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_ja_0900_as_cs      | utf8mb4  | 303 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_ja_0900_as_cs_ks   | utf8mb4  | 304 |         | Yes      |      24 | NO PAD        |</span><br><span class="line">| utf8mb4_latvian_ci         | utf8mb4  | 226 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8mb4_la_0900_ai_ci      | utf8mb4  | 271 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_la_0900_as_cs      | utf8mb4  | 294 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_lithuanian_ci      | utf8mb4  | 236 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8mb4_lt_0900_ai_ci      | utf8mb4  | 268 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_lt_0900_as_cs      | utf8mb4  | 291 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_lv_0900_ai_ci      | utf8mb4  | 258 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_lv_0900_as_cs      | utf8mb4  | 281 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_persian_ci         | utf8mb4  | 240 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8mb4_pl_0900_ai_ci      | utf8mb4  | 261 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_pl_0900_as_cs      | utf8mb4  | 284 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_polish_ci          | utf8mb4  | 229 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8mb4_romanian_ci        | utf8mb4  | 227 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8mb4_roman_ci           | utf8mb4  | 239 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8mb4_ro_0900_ai_ci      | utf8mb4  | 259 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_ro_0900_as_cs      | utf8mb4  | 282 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_ru_0900_ai_ci      | utf8mb4  | 306 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_ru_0900_as_cs      | utf8mb4  | 307 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_sinhala_ci         | utf8mb4  | 243 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8mb4_sk_0900_ai_ci      | utf8mb4  | 269 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_sk_0900_as_cs      | utf8mb4  | 292 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_slovak_ci          | utf8mb4  | 237 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8mb4_slovenian_ci       | utf8mb4  | 228 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8mb4_sl_0900_ai_ci      | utf8mb4  | 260 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_sl_0900_as_cs      | utf8mb4  | 283 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_spanish2_ci        | utf8mb4  | 238 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8mb4_spanish_ci         | utf8mb4  | 231 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8mb4_sv_0900_ai_ci      | utf8mb4  | 264 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_sv_0900_as_cs      | utf8mb4  | 287 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_swedish_ci         | utf8mb4  | 232 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8mb4_tr_0900_ai_ci      | utf8mb4  | 265 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_tr_0900_as_cs      | utf8mb4  | 288 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_turkish_ci         | utf8mb4  | 233 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8mb4_unicode_520_ci     | utf8mb4  | 246 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8mb4_unicode_ci         | utf8mb4  | 224 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8mb4_vietnamese_ci      | utf8mb4  | 247 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8mb4_vi_0900_ai_ci      | utf8mb4  | 277 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_vi_0900_as_cs      | utf8mb4  | 300 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8mb4_zh_0900_as_cs      | utf8mb4  | 308 |         | Yes      |       0 | NO PAD        |</span><br><span class="line">| utf8_bin                   | utf8     |  83 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| utf8_croatian_ci           | utf8     | 213 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8_czech_ci              | utf8     | 202 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8_danish_ci             | utf8     | 203 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8_esperanto_ci          | utf8     | 209 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8_estonian_ci           | utf8     | 198 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8_general_ci            | utf8     |  33 | Yes     | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| utf8_general_mysql500_ci   | utf8     | 223 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| utf8_german2_ci            | utf8     | 212 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8_hungarian_ci          | utf8     | 210 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8_icelandic_ci          | utf8     | 193 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8_latvian_ci            | utf8     | 194 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8_lithuanian_ci         | utf8     | 204 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8_persian_ci            | utf8     | 208 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8_polish_ci             | utf8     | 197 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8_romanian_ci           | utf8     | 195 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8_roman_ci              | utf8     | 207 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8_sinhala_ci            | utf8     | 211 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8_slovak_ci             | utf8     | 205 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8_slovenian_ci          | utf8     | 196 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8_spanish2_ci           | utf8     | 206 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8_spanish_ci            | utf8     | 199 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8_swedish_ci            | utf8     | 200 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8_tolower_ci            | utf8     |  76 |         | Yes      |       1 | PAD SPACE     |</span><br><span class="line">| utf8_turkish_ci            | utf8     | 201 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8_unicode_520_ci        | utf8     | 214 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8_unicode_ci            | utf8     | 192 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">| utf8_vietnamese_ci         | utf8     | 215 |         | Yes      |       8 | PAD SPACE     |</span><br><span class="line">+<span class="comment">----------------------------+----------+-----+---------+----------+---------+---------------+</span></span><br><span class="line">272 rows in <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></table></figure>

<p>查看使用的字符集合校对：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SHOW VARIABLES LIKE &#39;character%&#39;;</span><br><span class="line">+--------------------------+--------------------------------+</span><br><span class="line">| Variable_name            | Value                          |</span><br><span class="line">+--------------------------+--------------------------------+</span><br><span class="line">| character_set_client     | latin1                         |</span><br><span class="line">| character_set_connection | latin1                         |</span><br><span class="line">| character_set_database   | utf8mb4                        |</span><br><span class="line">| character_set_filesystem | binary                         |</span><br><span class="line">| character_set_results    | latin1                         |</span><br><span class="line">| character_set_server     | utf8mb4                        |</span><br><span class="line">| character_set_system     | utf8                           |</span><br><span class="line">| character_sets_dir       | &#x2F;usr&#x2F;share&#x2F;mysql-8.0&#x2F;charsets&#x2F; |</span><br><span class="line">+--------------------------+--------------------------------+</span><br><span class="line">8 rows in set (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SHOW VARIABLES LIKE &#39;collation%&#39;;</span><br><span class="line">+----------------------+--------------------+</span><br><span class="line">| Variable_name        | Value              |</span><br><span class="line">+----------------------+--------------------+</span><br><span class="line">| collation_connection | latin1_swedish_ci  |</span><br><span class="line">| collation_database   | utf8mb4_0900_ai_ci |</span><br><span class="line">| collation_server     | utf8mb4_0900_ai_ci |</span><br><span class="line">+----------------------+--------------------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>给表指定字符集和校对：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; CREATE TABLE mytable</span><br><span class="line">    -&gt; (</span><br><span class="line">    -&gt;   column1 INT,</span><br><span class="line">    -&gt;   column2 VARCHAR(10)</span><br><span class="line">    -&gt; ) DEFAULT CHARACTER SET hebrew</span><br><span class="line">    -&gt;   COLLATE hebrew_general_ci;</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SHOW CREATE TABLE mytable;</span><br><span class="line">+<span class="comment">---------+------------------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">| Table   | <span class="keyword">Create</span> <span class="keyword">Table</span>                                                                                                                       |</span><br><span class="line">+<span class="comment">---------+------------------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">| mytable | <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`mytable`</span> (</span><br><span class="line">  <span class="string">`column1`</span> <span class="built_in">int</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`column2`</span> <span class="built_in">varchar</span>(<span class="number">10</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span></span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=hebrew |</span><br><span class="line">+<span class="comment">---------+------------------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="keyword">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<p>给列指定字符集和校对：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; CREATE TABLE mytable2(</span><br><span class="line">    -&gt;   column1 INT,</span><br><span class="line">    -&gt;   column2 VARCHAR(10),</span><br><span class="line">    -&gt;   column3 VARCHAR(10) CHARACTER SET latin1 COLLATE latin1_general_ci</span><br><span class="line">    -&gt; ) DEFAULT CHARACTER SET hebrew</span><br><span class="line">    -&gt;   COLLATE hebrew_general_ci;</span><br><span class="line">Query OK, 0 rows affected (0.02 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SHOW CREATE TABLE mytable2;</span><br><span class="line">+<span class="comment">----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">| Table    | <span class="keyword">Create</span> <span class="keyword">Table</span>                                                                                                                                                                                                             |</span><br><span class="line">+<span class="comment">----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">| mytable2 | <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`mytable2`</span> (</span><br><span class="line">  <span class="string">`column1`</span> <span class="built_in">int</span> <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`column2`</span> <span class="built_in">varchar</span>(<span class="number">10</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`column3`</span> <span class="built_in">varchar</span>(<span class="number">10</span>) <span class="built_in">CHARACTER</span> <span class="keyword">SET</span> latin1 <span class="keyword">COLLATE</span> latin1_general_ci <span class="keyword">DEFAULT</span> <span class="literal">NULL</span></span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=hebrew |</span><br><span class="line">+<span class="comment">----------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="keyword">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<p>使用 <code>COLLATE</code> 指定一个备用的校对顺序，临时区分大小写：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM customers</span><br><span class="line">    -&gt; ORDER BY cust_name, cust_address COLLATE utf8mb4_general_ci;</span><br><span class="line">+---------+----------------+---------------------+------------+------------+----------+--------------+--------------+---------------------+</span><br><span class="line">| cust_id | cust_name      | cust_address        | cust_city  | cust_state | cust_zip | cust_country | cust_contact | cust_email          |</span><br><span class="line">+---------+----------------+---------------------+------------+------------+----------+--------------+--------------+---------------------+</span><br><span class="line">|   10001 | Coyote Inc.    | 200 Maple Lane      | Detroit    | MI         | 44444    | USA          | Y Lee        | ylee@coyote.com     |</span><br><span class="line">|   10009 | M. Martian     | 42 Galaxy Way       | New York   | NY         | 11213    | USA          | NULL         | NULL                |</span><br><span class="line">|   10002 | Mouse House    | 333 Fromage Lane    | Columbus   | OH         | 43333    | USA          | Jerry Mouse  | NULL                |</span><br><span class="line">|   10007 | Pep E. LaPew   | 100 Main Street     | Los Angles | CA         | 90046    | USA          | NULL         | NULL                |</span><br><span class="line">|   10008 | Pep E. LaPew   | 100 Main Street     | Los Angles | CA         | 90046    | USA          | NULL         | NULL                |</span><br><span class="line">|   10005 | The Fudds      | 4545 53rd Street    | Chicago    | IL         | 54545    | USA          | E Fudd       | NULL                |</span><br><span class="line">|   10003 | Wascals        | 1 Sunny Place       | Muncie     | IN         | 42222    | USA          | Jim Jones    | rabbit@wascally.com |</span><br><span class="line">|   10004 | Yosemite Place | 829 Riverside Drive | Phoenix    | AZ         | 88888    | USA          | Y Sam        | sam@yosemite.com    |</span><br><span class="line">+---------+----------------+---------------------+------------+------------+----------+--------------+--------------+---------------------+</span><br><span class="line">8 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h2 id="访问控制（Access-Control）"><a href="#访问控制（Access-Control）" class="headerlink" title="访问控制（Access Control）"></a>访问控制（<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/access-control.html">Access Control</a>）</h2><p>MySQL 服务器的安全基础是：用户应该对他们需要的数据具有适当的访问权，既不能多也不能少。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E6%9C%80%E5%B0%8F%E6%9D%83%E9%99%90%E5%8E%9F%E5%88%99">最小权限原则</a></li>
</ul>
<p>MySQL 用户账号和信息存储在名为 mysql 的数据库中，其中有一个名为 user 的表，包含所有用户账号：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; USE mysql;</span><br><span class="line">Reading table information for completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup with -A</span><br><span class="line"></span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; SELECT user FROM user;</span><br><span class="line">+------------------+</span><br><span class="line">| user             |</span><br><span class="line">+------------------+</span><br><span class="line">| root             |</span><br><span class="line">| mysql.infoschema |</span><br><span class="line">| mysql.session    |</span><br><span class="line">| mysql.sys        |</span><br><span class="line">| root             |</span><br><span class="line">+------------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="用户账号"><a href="#用户账号" class="headerlink" title="用户账号"></a>用户账号</h3><p>使用 <code>CREATE USER</code> 语句创建用户，并用 <code>IDENTIFIED</code> 设置密码：</p>
<ul>
<li>密码以散列值的形式存储在数据库中</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; CREATE USER ben IDENTIFIED BY &#39;p@$$w0rd&#39;;</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT user FROM mysql.user;</span><br><span class="line">+------------------+</span><br><span class="line">| user             |</span><br><span class="line">+------------------+</span><br><span class="line">| ben              |</span><br><span class="line">| root             |</span><br><span class="line">| mysql.infoschema |</span><br><span class="line">| mysql.session    |</span><br><span class="line">| mysql.sys        |</span><br><span class="line">| root             |</span><br><span class="line">+------------------+</span><br><span class="line">6 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>使用 <code>RENAME USER</code> 重命名用户：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; RENAME USER ben TO cat;</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT user FROM mysql.user;</span><br><span class="line">+------------------+</span><br><span class="line">| user             |</span><br><span class="line">+------------------+</span><br><span class="line">| cat              |</span><br><span class="line">| root             |</span><br><span class="line">| mysql.infoschema |</span><br><span class="line">| mysql.session    |</span><br><span class="line">| mysql.sys        |</span><br><span class="line">| root             |</span><br><span class="line">+------------------+</span><br><span class="line">6 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>使用 <code>SET PASSWORD</code> 更改口令，mysql 数据库 user 表的 authentication_string 是密码经过哈希处理的结果：</p>
<ul>
<li>不指定用户名时，默认更新当前登录用户的口令：<code>SET PASSWORD = &#39;n3w p@$$w0rd&#39;;</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select user,authentication_string from mysql.user where user LIKE &#39;cat&#39;;</span><br><span class="line">+------+------------------------------------------------------------------------+</span><br><span class="line">| user | authentication_string                                                  |</span><br><span class="line">+------+------------------------------------------------------------------------+</span><br><span class="line">| cat  | $A$005$g1*ZeB!vr)F:2&#96;E;dUfKlOQ.F3Q8469sRKIvvfAccTP8SlR627FYnTStLj.n2 |</span><br><span class="line">+------+------------------------------------------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SET PASSWORD FOR cat &#x3D; &#39;n3w p@$$w0rd&#39;;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select user,authentication_string from mysql.user where user LIKE &#39;cat&#39;;</span><br><span class="line">+------+------------------------------------------------------------------------+</span><br><span class="line">| user | authentication_string                                                  |</span><br><span class="line">+------+------------------------------------------------------------------------+</span><br><span class="line">| cat  | $A$005$.&#39;r;</span><br><span class="line">                    Go^j0wm+wf6rpiUsskXasKT3FpbPDJcrJmF28N21dj1u2JfVZok8 |</span><br><span class="line">+------+------------------------------------------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>使用 <code>DROP USER</code> 删除用户账号（以及相关的权限）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; DROP USER cat;</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT user FROM mysql.user;</span><br><span class="line">+------------------+</span><br><span class="line">| user             |</span><br><span class="line">+------------------+</span><br><span class="line">| root             |</span><br><span class="line">| mysql.infoschema |</span><br><span class="line">| mysql.session    |</span><br><span class="line">| mysql.sys        |</span><br><span class="line">| root             |</span><br><span class="line">+------------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="访问权限"><a href="#访问权限" class="headerlink" title="访问权限"></a>访问权限</h3><p>使用 <code>SHOW GRANTS FOR</code> 查看授予用户的权限：</p>
<ul>
<li><code>USAGE</code> 表示没有对任意数据库和数据表都没有权限</li>
<li>MySQL 的权限用用户名和主机名结合定义，如果不指定主机名，则使用默认的主机名 <code>%</code></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SHOW GRANTS FOR cat;</span><br><span class="line">+---------------------------------+</span><br><span class="line">| Grants for cat@%                |</span><br><span class="line">+---------------------------------+</span><br><span class="line">| GRANT USAGE ON *.* TO &#96;cat&#96;@&#96;%&#96; |</span><br><span class="line">+---------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>使用 <code>GRANT</code> 语句设置权限，授予 cat 用户对 crashcourse 数据库中所有数据的只读权限，再次查看权限：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; GRANT SELECT ON crashcourse.* TO cat;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SHOW GRANTS FOR cat;</span><br><span class="line">+----------------------------------------------+</span><br><span class="line">| Grants for cat@%                             |</span><br><span class="line">+----------------------------------------------+</span><br><span class="line">| GRANT USAGE ON *.* TO &#96;cat&#96;@&#96;%&#96;              |</span><br><span class="line">| GRANT SELECT ON &#96;crashcourse&#96;.* TO &#96;cat&#96;@&#96;%&#96; |</span><br><span class="line">+----------------------------------------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><code>REVOKE</code> 用于撤销特定的权限，撤销刚才授予 cat 用户的权限：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; REVOKE SELECT ON crashcourse.* FROM cat;</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SHOW GRANTS FOR cat;</span><br><span class="line">+---------------------------------+</span><br><span class="line">| Grants for cat@%                |</span><br><span class="line">+---------------------------------+</span><br><span class="line">| GRANT USAGE ON *.* TO &#96;cat&#96;@&#96;%&#96; |</span><br><span class="line">+---------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><code>GRANT</code> 和 <code>REVOKE</code> 可以在几个层次上控制访问权限</p>
<ul>
<li>服务器（server），使用 <code>GRANT ALL</code> 和 <code>REVOKE ALL</code></li>
<li>数据库（database），使用 <code>ON database.*</code></li>
<li>表（table），使用 <code>ON database.table</code></li>
<li>列（column）</li>
<li>存储过程（procedure）</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/privileges-provided.html">MySQL 提供的权限</a></p>
<h2 id="数据库维护"><a href="#数据库维护" class="headerlink" title="数据库维护"></a>数据库维护</h2><h3 id="备份与恢复（Backup-and-Recovery）"><a href="#备份与恢复（Backup-and-Recovery）" class="headerlink" title="备份与恢复（Backup and Recovery）"></a>备份与恢复（<a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/mysql-backup-excerpt/5.6/en/backup-and-recovery.html">Backup and Recovery</a>）</h3><ol>
<li>使用 <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/mysql-backup-excerpt/5.6/en/using-mysqldump.html">mysqldump</a> 转储所有数据库内容到某个外部文件</li>
<li>使用 mysqlhotcopy 从一个数据库复制所有数据</li>
<li>使用 MySQL 的 <code>BACKUP TABLE</code> 或 <code>SELECT INTO OUTFILE</code> 转储所有数据到某个外部文件</li>
</ol>
<p>为了保证所有数据被写到磁盘（包括索引数据），可能需要在进行备份前使用 <code>FLUSH TABLES</code> 语句。</p>
<h3 id="维护"><a href="#维护" class="headerlink" title="维护"></a>维护</h3><p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/analyze-table.html"><code>ANALYZE TABLE</code></a> 用来检查表键是否正确：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; ANALYZE TABLE orders;</span><br><span class="line">+--------------+---------+----------+------------------------------------+</span><br><span class="line">| Table        | Op      | Msg_type | Msg_text                           |</span><br><span class="line">+--------------+---------+----------+------------------------------------+</span><br><span class="line">| mysql.orders | analyze | Error    | Table &#39;mysql.orders&#39; doesn&#39;t exist |</span><br><span class="line">| mysql.orders | analyze | status   | Operation failed                   |</span><br><span class="line">+--------------+---------+----------+------------------------------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/check-table.html"><code>CHECK TABLE</code></a> 检查一个或多个表的错误，还可以检查视图是否存在问题，比如视图定义中引用的表不再存在：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; CHECK TABLE orders, orderitems;</span><br><span class="line">+------------------+-------+----------+----------------------------------------+</span><br><span class="line">| Table            | Op    | Msg_type | Msg_text                               |</span><br><span class="line">+------------------+-------+----------+----------------------------------------+</span><br><span class="line">| mysql.orders     | check | Error    | Table &#39;mysql.orders&#39; doesn&#39;t exist     |</span><br><span class="line">| mysql.orders     | check | status   | Operation failed                       |</span><br><span class="line">| mysql.orderitems | check | Error    | Table &#39;mysql.orderitems&#39; doesn&#39;t exist |</span><br><span class="line">| mysql.orderitems | check | status   | Operation failed                       |</span><br><span class="line">+------------------+-------+----------+----------------------------------------+</span><br><span class="line">4 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/repair-table.html"><code>REPAIR TABLE</code></a> 针对某些存储引擎修复可能损坏的表。</p>
<ul>
<li>MyISAM 表访问产生不正确和不一致的结果</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/optimize-table.html"><code>OPTIMIZE TABLE</code></a> 重新组织表数据和相关索引数据的物理存储，以减少存储空间并提高访问表时的 I/O 效率。对每个表所做的确切更改取决于该表所使用的存储引擎。</p>
<ul>
<li>从一个表中删除大量数据，用以回收空间，从而优化表的性能</li>
</ul>
<h3 id="诊断启动问题"><a href="#诊断启动问题" class="headerlink" title="诊断启动问题"></a>诊断启动问题</h3><p>服务器启动问题通常在对 MySQL 配置或服务器本身进行更改时出现，MySQL 服务器自身通过在命令行上执行 <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/mysqld.html"><code>mysqld</code></a> 启动，具体选项使用 <code>--help</code> 参数查看即可。</p>
<h3 id="日志文件"><a href="#日志文件" class="headerlink" title="日志文件"></a>日志文件</h3><p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/server-logs.html">MySQL 服务器日志</a> 主要有以下几种：错误日志、查询日志、二进制日志、缓慢查询日志。</p>
<p>使用日志时，可以使用 <code>FLUSH LOGS</code> 语句刷新和重新开始所有日志文件。</p>
<h2 id="改善性能"><a href="#改善性能" class="headerlink" title="改善性能"></a>改善性能</h2><ol>
<li>硬件建议</li>
<li>专用服务器</li>
<li>修改默认设置</li>
<li>多用户多线程 DBMS ，可以使用 <code>SHOW PROCESSLIST</code> 显示所有活动进程</li>
<li><code>SELECT</code> 语句有多种写法</li>
<li>使用 <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/explain.html"><code>EXPLAIN</code></a> 语句解释 <code>SELECT</code> 语句的执行过程</li>
<li>通常，存储过程比一条一条执行 MySQL 语句快</li>
<li>正确的数据类型</li>
<li>绝不检索比需求更多的数据</li>
<li><code>DELAYED</code> 关键字</li>
<li>导入数据时，关闭自动提交</li>
<li>索引数据库表以改善检索性能</li>
<li>索引影响插入删除更新的性能</li>
<li>一般来说，最好使用 <code>FULLTEXT</code> 而不是 <code>LIKE</code></li>
<li>数据库是动态实体，需要动态调优</li>
<li>每条规则在某些条件下都会被打破</li>
</ol>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Jckling</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://jckling.github.io/2020/11/22/Notes/Database/MySQL%20%E5%BF%85%E7%9F%A5%E5%BF%85%E4%BC%9A/">https://jckling.github.io/2020/11/22/Notes/Database/MySQL 必知必会/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://jckling.github.io" target="_blank">Jckling's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a><a class="post-meta__tags" href="/tags/Database/">Database</a><a class="post-meta__tags" href="/tags/MySQL/">MySQL</a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2021/06/14/wF3vNBjf1LH79Ss.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/jckling/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/jckling/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li></ul></div></div><div class="ads-wrap"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-1035234274961147" data-ad-slot="3100725659" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/11/23/Other/Docker/Windows%2010%20Home+WSL2+Docker%20Desktop/"><img class="prev-cover" src="https://i.loli.net/2021/06/14/aKl57xkrPEVzvGA.png" onerror="onerror=null;src='/img/jckling/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Windows 10 家庭版 + WSL 2 + Docker Desktop</div></div></a></div><div class="next-post pull-right"><a href="/2020/11/21/Other/Docker/Windows%2010%20Home+VirtualBox+%20Docker%20Machine/"><img class="next-cover" src="https://i.loli.net/2021/06/14/aKl57xkrPEVzvGA.png" onerror="onerror=null;src='/img/jckling/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">如何在 Windows 10 家庭版上使用 Docker</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2020/04/03/LeetCode/DataBase-1/" title="LeetCode Database Easy"><img class="cover" src="https://i.loli.net/2021/06/14/CRcoAfdnJKvFNqW.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-04-03</div><div class="title">LeetCode Database Easy</div></div></a></div><div><a href="/2020/04/04/LeetCode/DataBase-2/" title="LeetCode Database Medium & Hard"><img class="cover" src="https://i.loli.net/2021/06/14/CRcoAfdnJKvFNqW.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-04-04</div><div class="title">LeetCode Database Medium & Hard</div></div></a></div><div><a href="/2018/04/22/Notes/Database/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%AE%BA/" title="《数据库系统概论》笔记整理"><img class="cover" src="https://i.loli.net/2021/06/14/CRcoAfdnJKvFNqW.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-04-22</div><div class="title">《数据库系统概论》笔记整理</div></div></a></div><div><a href="/2020/04/22/Security/DVWA/1.%20Brute%20Force/" title="DVWA Writeup Part I (Brute Force)"><img class="cover" src="https://i.loli.net/2021/06/14/aAsUJkFMvVpl4ro.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-04-22</div><div class="title">DVWA Writeup Part I (Brute Force)</div></div></a></div><div><a href="/2020/04/25/Security/DVWA/10.%20XSS%20Reflected/" title="DVWA Writeup Part X (XSS (Reflected))"><img class="cover" src="https://i.loli.net/2021/06/14/aAsUJkFMvVpl4ro.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-04-25</div><div class="title">DVWA Writeup Part X (XSS (Reflected))</div></div></a></div><div><a href="/2020/04/26/Security/DVWA/11.%20XSS%20Stored/" title="DVWA Writeup Part XI (XSS (Stored))"><img class="cover" src="https://i.loli.net/2021/06/14/aAsUJkFMvVpl4ro.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-04-26</div><div class="title">DVWA Writeup Part XI (XSS (Stored))</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/jckling/avatar.jpg" onerror="this.onerror=null;this.src='/img/jckling/avatar_404.png'" alt="avatar"/></div><div class="author-info__name">Jckling</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">107</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">40</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/jckling"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">欢迎访问本站 🥳 <br/>评论需要审核，请不要重复提交~</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL-%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-number">1.</span> <span class="toc-text">MySQL 环境搭建</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HELP"><span class="toc-number">2.</span> <span class="toc-text">HELP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#USE"><span class="toc-number">3.</span> <span class="toc-text">USE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SHOW"><span class="toc-number">4.</span> <span class="toc-text">SHOW</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SHOW-DATABASES"><span class="toc-number">4.1.</span> <span class="toc-text">SHOW DATABASES</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SHOW-TABLES"><span class="toc-number">4.2.</span> <span class="toc-text">SHOW TABLES</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SHOW-COLUMNS"><span class="toc-number">4.3.</span> <span class="toc-text">SHOW COLUMNS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SHOW-STATUS"><span class="toc-number">4.4.</span> <span class="toc-text">SHOW STATUS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SHOW-CREATE-DATABASE"><span class="toc-number">4.5.</span> <span class="toc-text">SHOW CREATE DATABASE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SHOW-CREATE-TABLE"><span class="toc-number">4.6.</span> <span class="toc-text">SHOW CREATE TABLE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SHOW-GRANTS"><span class="toc-number">4.7.</span> <span class="toc-text">SHOW GRANTS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SHOW-ERRORS"><span class="toc-number">4.8.</span> <span class="toc-text">SHOW ERRORS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SHOW-WARNINGS"><span class="toc-number">4.9.</span> <span class="toc-text">SHOW WARNINGS</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SELECT"><span class="toc-number">5.</span> <span class="toc-text">SELECT</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WHERE"><span class="toc-number">6.</span> <span class="toc-text">WHERE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AF%94%E8%BE%83%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="toc-number">6.1.</span> <span class="toc-text">比较操作符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="toc-number">6.2.</span> <span class="toc-text">逻辑操作符</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ORDER-BY"><span class="toc-number">7.</span> <span class="toc-text">ORDER BY</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Regular-Expressions"><span class="toc-number">8.</span> <span class="toc-text">Regular Expressions</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%AD%97%E6%AE%B5"><span class="toc-number">9.</span> <span class="toc-text">计算字段</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%BC%E6%8E%A5%E5%AD%97%E6%AE%B5"><span class="toc-number">9.1.</span> <span class="toc-text">拼接字段</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%88%AB%E5%90%8D"><span class="toc-number">9.2.</span> <span class="toc-text">使用别名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E7%AE%97%E6%95%B0%E8%AE%A1%E7%AE%97"><span class="toc-number">9.3.</span> <span class="toc-text">执行算数计算</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%EF%BC%88Functions-and-Operators%EF%BC%89"><span class="toc-number">10.</span> <span class="toc-text">函数（Functions and Operators）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E6%9C%AC%E5%87%BD%E6%95%B0"><span class="toc-number">10.1.</span> <span class="toc-text">文本函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E5%AD%A6%E5%87%BD%E6%95%B0"><span class="toc-number">10.2.</span> <span class="toc-text">数学函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E5%92%8C%E6%97%A5%E6%9C%9F%E5%87%BD%E6%95%B0"><span class="toc-number">10.3.</span> <span class="toc-text">时间和日期函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%81%9A%E9%9B%86%E5%87%BD%E6%95%B0"><span class="toc-number">11.</span> <span class="toc-text">聚集函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#AVG"><span class="toc-number">11.1.</span> <span class="toc-text">AVG()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#COUNT"><span class="toc-number">11.2.</span> <span class="toc-text">COUNT()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MAX"><span class="toc-number">11.3.</span> <span class="toc-text">MAX()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MIN"><span class="toc-number">11.4.</span> <span class="toc-text">MIN()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SUM"><span class="toc-number">11.5.</span> <span class="toc-text">SUM()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ALL-DISTINCT"><span class="toc-number">11.6.</span> <span class="toc-text">ALL | DISTINCT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E8%81%9A%E9%9B%86%E5%87%BD%E6%95%B0"><span class="toc-number">11.7.</span> <span class="toc-text">组合聚集函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%88%86%E7%BB%84"><span class="toc-number">12.</span> <span class="toc-text">数据分组</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GROUP-BY"><span class="toc-number">12.1.</span> <span class="toc-text">GROUP BY</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SELECT-%E5%AD%90%E5%8F%A5%E9%A1%BA%E5%BA%8F"><span class="toc-number">12.2.</span> <span class="toc-text">SELECT 子句顺序</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">13.</span> <span class="toc-text">子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4"><span class="toc-number">13.1.</span> <span class="toc-text">过滤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%9C%E4%B8%BA%E8%AE%A1%E7%AE%97%E5%AD%97%E6%AE%B5"><span class="toc-number">13.2.</span> <span class="toc-text">作为计算字段</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%EF%BC%88JOIN%EF%BC%89"><span class="toc-number">14.</span> <span class="toc-text">连接（JOIN）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AD%89%E5%80%BC%E8%BF%9E%E6%8E%A5%EF%BC%88INNER-JOIN%EF%BC%89"><span class="toc-number">14.1.</span> <span class="toc-text">等值连接（INNER JOIN）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E8%BF%9E%E6%8E%A5"><span class="toc-number">14.2.</span> <span class="toc-text">自连接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E7%84%B6%E8%BF%9E%E6%8E%A5%EF%BC%88NATURAL-JOIN%EF%BC%89"><span class="toc-number">14.3.</span> <span class="toc-text">自然连接（NATURAL JOIN）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%96%E9%83%A8%E8%BF%9E%E6%8E%A5%EF%BC%88OUTER-JOIN%EF%BC%89"><span class="toc-number">14.4.</span> <span class="toc-text">外部连接（OUTER JOIN）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E5%90%88%E8%81%9A%E9%9B%86%E5%87%BD%E6%95%B0"><span class="toc-number">14.5.</span> <span class="toc-text">结合聚集函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="toc-number">15.</span> <span class="toc-text">组合查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%A8%E6%96%87%E6%9C%AC%E6%90%9C%E7%B4%A2"><span class="toc-number">16.</span> <span class="toc-text">全文本搜索</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#INSERT"><span class="toc-number">17.</span> <span class="toc-text">INSERT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E5%85%A5%E5%8D%95%E8%A1%8C%E6%95%B0%E6%8D%AE"><span class="toc-number">17.1.</span> <span class="toc-text">插入单行数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E5%85%A5%E5%A4%9A%E8%A1%8C%E6%95%B0%E6%8D%AE"><span class="toc-number">17.2.</span> <span class="toc-text">插入多行数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E5%85%A5%E6%A3%80%E7%B4%A2%E5%87%BA%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="toc-number">17.3.</span> <span class="toc-text">插入检索出的数据</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UPDATE"><span class="toc-number">18.</span> <span class="toc-text">UPDATE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DELETE"><span class="toc-number">19.</span> <span class="toc-text">DELETE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CREATE-TABLE"><span class="toc-number">20.</span> <span class="toc-text">CREATE TABLE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#NULL"><span class="toc-number">20.1.</span> <span class="toc-text">NULL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PRIMARY-KEY"><span class="toc-number">20.2.</span> <span class="toc-text">PRIMARY KEY</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AUTO-INCREMENT"><span class="toc-number">20.3.</span> <span class="toc-text">AUTO_INCREMENT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DEFAULT"><span class="toc-number">20.4.</span> <span class="toc-text">DEFAULT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ENGINE"><span class="toc-number">20.5.</span> <span class="toc-text">ENGINE</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ALTER-TABLE"><span class="toc-number">21.</span> <span class="toc-text">ALTER TABLE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RENAME-TABLE"><span class="toc-number">22.</span> <span class="toc-text">RENAME TABLE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DROP-TABLE"><span class="toc-number">23.</span> <span class="toc-text">DROP TABLE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%EF%BC%88View%EF%BC%89"><span class="toc-number">24.</span> <span class="toc-text">视图（View）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8C%96%E5%A4%8D%E6%9D%82%E7%9A%84-SQL%E6%93%8D%E4%BD%9C"><span class="toc-number">24.1.</span> <span class="toc-text">简化复杂的 SQL操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F%E5%8C%96%E6%95%B0%E6%8D%AE"><span class="toc-number">24.2.</span> <span class="toc-text">格式化数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E6%95%B0%E6%8D%AE"><span class="toc-number">24.3.</span> <span class="toc-text">过滤数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%AD%97%E6%AE%B5-1"><span class="toc-number">24.4.</span> <span class="toc-text">计算字段</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E8%A7%86%E5%9B%BE"><span class="toc-number">24.5.</span> <span class="toc-text">更新视图</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%EF%BC%88stored-procedure%EF%BC%89"><span class="toc-number">25.</span> <span class="toc-text">存储过程（stored procedure）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CREATE-PROCEDURE"><span class="toc-number">25.1.</span> <span class="toc-text">CREATE PROCEDURE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CALL"><span class="toc-number">25.2.</span> <span class="toc-text">CALL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DROP-PROCEDURE"><span class="toc-number">25.3.</span> <span class="toc-text">DROP PROCEDURE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SHOW-CREATE-PROCEDURE"><span class="toc-number">25.4.</span> <span class="toc-text">SHOW CREATE PROCEDURE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SHOW-PROCEDURE-STATUS"><span class="toc-number">25.5.</span> <span class="toc-text">SHOW PROCEDURE STATUS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%99%BA%E8%83%BD%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">25.6.</span> <span class="toc-text">智能存储过程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B8%B8%E6%A0%87"><span class="toc-number">26.</span> <span class="toc-text">游标</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA"><span class="toc-number">26.1.</span> <span class="toc-text">创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%93%E5%BC%80%E5%92%8C%E5%85%B3%E9%97%AD"><span class="toc-number">26.2.</span> <span class="toc-text">打开和关闭</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%B8%B8%E6%A0%87"><span class="toc-number">26.3.</span> <span class="toc-text">使用游标</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A6%E5%8F%91%E5%99%A8%EF%BC%88Triggers%EF%BC%89"><span class="toc-number">27.</span> <span class="toc-text">触发器（Triggers）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA-1"><span class="toc-number">27.1.</span> <span class="toc-text">创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A0%E9%99%A4"><span class="toc-number">27.2.</span> <span class="toc-text">删除</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8"><span class="toc-number">27.3.</span> <span class="toc-text">使用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E5%8A%A1%EF%BC%88TRANSACTION%EF%BC%89"><span class="toc-number">28.</span> <span class="toc-text">事务（TRANSACTION）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E4%BA%8B%E5%8A%A1%E5%A4%84%E7%90%86"><span class="toc-number">28.1.</span> <span class="toc-text">控制事务处理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E9%9B%86%E5%92%8C%E6%A0%A1%E5%AF%B9"><span class="toc-number">29.</span> <span class="toc-text">字符集和校对</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%EF%BC%88Access-Control%EF%BC%89"><span class="toc-number">30.</span> <span class="toc-text">访问控制（Access Control）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E8%B4%A6%E5%8F%B7"><span class="toc-number">30.1.</span> <span class="toc-text">用户账号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E6%9D%83%E9%99%90"><span class="toc-number">30.2.</span> <span class="toc-text">访问权限</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BB%B4%E6%8A%A4"><span class="toc-number">31.</span> <span class="toc-text">数据库维护</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%EF%BC%88Backup-and-Recovery%EF%BC%89"><span class="toc-number">31.1.</span> <span class="toc-text">备份与恢复（Backup and Recovery）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%B4%E6%8A%A4"><span class="toc-number">31.2.</span> <span class="toc-text">维护</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%8A%E6%96%AD%E5%90%AF%E5%8A%A8%E9%97%AE%E9%A2%98"><span class="toc-number">31.3.</span> <span class="toc-text">诊断启动问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6"><span class="toc-number">31.4.</span> <span class="toc-text">日志文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%B9%E5%96%84%E6%80%A7%E8%83%BD"><span class="toc-number">32.</span> <span class="toc-text">改善性能</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/11/22/Other/Datalog%20%E5%BC%95%E6%93%8E%20Souffl%C3%A9%20%E6%8C%87%E5%8D%97/" title="Datalog 引擎 Soufflé 指南"><img src="https://i.loli.net/2021/06/14/oSn9dxfYhEHClIe.jpg" onerror="this.onerror=null;this.src='/img/jckling/404.jpg'" alt="Datalog 引擎 Soufflé 指南"/></a><div class="content"><a class="title" href="/2021/11/22/Other/Datalog%20%E5%BC%95%E6%93%8E%20Souffl%C3%A9%20%E6%8C%87%E5%8D%97/" title="Datalog 引擎 Soufflé 指南">Datalog 引擎 Soufflé 指南</a><time datetime="2021-11-22T11:01:43.000Z" title="发表于 2021-11-22 19:01:43">2021-11-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/11/05/Jaeger/CVE-2020-12691%20%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E7%9B%B8%E5%85%B3%E4%BF%A1%E6%81%AF%E8%BF%BD%E8%B8%AA/" title="CVE-2020-12691 漏洞利用相关信息追踪"><img src="https://i.loli.net/2021/06/14/bk5UlhqE4DZJfYu.png" onerror="this.onerror=null;this.src='/img/jckling/404.jpg'" alt="CVE-2020-12691 漏洞利用相关信息追踪"/></a><div class="content"><a class="title" href="/2021/11/05/Jaeger/CVE-2020-12691%20%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E7%9B%B8%E5%85%B3%E4%BF%A1%E6%81%AF%E8%BF%BD%E8%B8%AA/" title="CVE-2020-12691 漏洞利用相关信息追踪">CVE-2020-12691 漏洞利用相关信息追踪</a><time datetime="2021-11-05T07:25:15.000Z" title="发表于 2021-11-05 15:25:15">2021-11-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/10/26/Other/LogiQL%20%E5%85%A5%E9%97%A8/" title="LogiQL 入门"><img src="https://developer.logicblox.com/wp-content/uploads/2017/12/prod-bg-panelfour.jpg" onerror="this.onerror=null;this.src='/img/jckling/404.jpg'" alt="LogiQL 入门"/></a><div class="content"><a class="title" href="/2021/10/26/Other/LogiQL%20%E5%85%A5%E9%97%A8/" title="LogiQL 入门">LogiQL 入门</a><time datetime="2021-10-26T08:15:05.000Z" title="发表于 2021-10-26 16:15:05">2021-10-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/10/12/Security/Gadget%20Inspector%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/" title="Gadget Inspector 源码解析"><img src="https://i.loli.net/2021/06/14/2NXqsznriG8blc7.jpg" onerror="this.onerror=null;this.src='/img/jckling/404.jpg'" alt="Gadget Inspector 源码解析"/></a><div class="content"><a class="title" href="/2021/10/12/Security/Gadget%20Inspector%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/" title="Gadget Inspector 源码解析">Gadget Inspector 源码解析</a><time datetime="2021-10-12T03:41:30.000Z" title="发表于 2021-10-12 11:41:30">2021-10-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/10/11/Other/Python%20%E7%88%AC%E5%8F%96%20twitter%20%E6%95%B0%E6%8D%AE/" title="Python 爬取 twitter 数据"><img src="https://about.twitter.com/content/dam/about-twitter/en/brand-toolkit/brand-banner-desktop.jpg.twimg.1920.jpg" onerror="this.onerror=null;this.src='/img/jckling/404.jpg'" alt="Python 爬取 twitter 数据"/></a><div class="content"><a class="title" href="/2021/10/11/Other/Python%20%E7%88%AC%E5%8F%96%20twitter%20%E6%95%B0%E6%8D%AE/" title="Python 爬取 twitter 数据">Python 爬取 twitter 数据</a><time datetime="2021-10-11T10:44:50.000Z" title="发表于 2021-10-11 18:44:50">2021-10-11</time></div></div></div></div><div class="card-widget ads-wrap"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-1035234274961147" data-ad-slot="8787224657" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div></div></main><footer id="footer" style="background-image: url('https://i.loli.net/2021/06/14/wF3vNBjf1LH79Ss.png')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By Jckling</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>function loadWaline () {
  function initWaline () {
    const waline = new Waline(Object.assign({
      el: '#waline-wrap',
      serverURL: 'https://blog-comments-puce.vercel.app',
      avatar: 'retro',
      avatarCDN: 'https://sdn.geekzu.org/avatar/',
      path: location.pathname,
      visitor: false,
      dark: 'html[data-theme="dark"]'
    }, {"emoji":"https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/tw-emoji"}))
  }

  if (typeof Waline === 'function') initWaline() 
  else getScript('https://cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js').then(initWaline)
}

if ('Waline' === 'Waline' || !false) {
  if (false) btf.loadComment(document.getElementById('waline-wrap'),loadWaline)
  else setTimeout(loadWaline, 0)
} else {
  function loadOtherComment () {
    loadWaline()
  }
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>