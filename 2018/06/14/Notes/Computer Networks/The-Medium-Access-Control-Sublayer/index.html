<!DOCTYPE html><html lang="[&quot;zh-CN&quot;,&quot;en&quot;,&quot;zh-HK&quot;,&quot;zh-TW&quot;,&quot;default&quot;]" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>《计算机网络（英文版·第5版）》 The Medium Access Control Sublayer | Jckling's Blog</title><meta name="keywords" content="计算机网络,Computer Networks"><meta name="author" content="Jckling"><meta name="copyright" content="Jckling"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="《计算机网络》第五版（英文） 介质访问控制子层">
<meta property="og:type" content="article">
<meta property="og:title" content="《计算机网络（英文版·第5版）》 The Medium Access Control Sublayer">
<meta property="og:url" content="https://jckling.github.io/2018/06/14/Notes/Computer%20Networks/The-Medium-Access-Control-Sublayer/index.html">
<meta property="og:site_name" content="Jckling&#39;s Blog">
<meta property="og:description" content="《计算机网络》第五版（英文） 介质访问控制子层">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2021/06/14/z9KUc1FV7eaD8pi.jpg">
<meta property="article:published_time" content="2018-06-14T10:50:51.000Z">
<meta property="article:modified_time" content="2021-11-23T14:04:58.773Z">
<meta property="article:author" content="Jckling">
<meta property="article:tag" content="计算机网络">
<meta property="article:tag" content="Computer Networks">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/06/14/z9KUc1FV7eaD8pi.jpg"><link rel="shortcut icon" href="/img/jckling/favicon.ico"><link rel="canonical" href="https://jckling.github.io/2018/06/14/Notes/Computer%20Networks/The-Medium-Access-Control-Sublayer/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google_site_verification" content="pZZt69mo0ndoxIJ1vjEe830lXbvD26aiVAZ-k0FWM5k"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?20b7797c0b5f4e821c1449cd4c6c98c8";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-164555720-1"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-164555720-1');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '《计算机网络（英文版·第5版）》 The Medium Access Control Sublayer',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-11-23 22:04:58'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="Jckling's Blog" type="application/atom+xml">
</head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/jckling/avatar.jpg" onerror="onerror=null;src='/img/jckling/avatar_404.png'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">107</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">40</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-film"></i><span> Movie</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://i.loli.net/2021/06/14/z9KUc1FV7eaD8pi.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Jckling's Blog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-film"></i><span> Movie</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">《计算机网络（英文版·第5版）》 The Medium Access Control Sublayer</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2018-06-14T10:50:51.000Z" title="undefined 2018-06-14 18:50:51">2018-06-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Notes/">Notes</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="《计算机网络（英文版·第5版）》 The Medium Access Control Sublayer"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2018/06/14/Notes/Computer%20Networks/The-Medium-Access-Control-Sublayer/#post-comment"><span class="waline-comment-count" id="/2018/06/14/Notes/Computer%20Networks/The-Medium-Access-Control-Sublayer/"></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>网络链路可以分成两大类（传输技术）：使用点到点连接和使用广播信道</p>
<p>在任何一个广播网络中，关键的问题是当多方竞争信道的使用权时如何确定谁可以使用信道</p>
<p>广播信道有时候也称为多路访问信道（multiaccess channel）或随机访问信道（random access channel）</p>
<p>用来确定多路访问信道下一个使用者的协议属于数据链路层的一个子层，该层称为介质访问控制子层（MAC, Medium Access Control）</p>
<h1 id="信道分配问题"><a href="#信道分配问题" class="headerlink" title="信道分配问题"></a>信道分配问题</h1><p>如何在竞争用户之间分配单个广播信道</p>
<ul>
<li>静态分配</li>
<li>动态分配</li>
<li>特殊算法</li>
</ul>
<h2 id="静态信道分配"><a href="#静态信道分配" class="headerlink" title="静态信道分配"></a>静态信道分配</h2><p>在多个竞争用户之间分配单个信道的传统做法（电话公司）是把信道容量拆开分给多个用户使用</p>
<ul>
<li>如 FDM（频分多路复用），TDM（时分多路复用，时间槽）</li>
<li>如果总共有 $N$ 个用户，则整个带宽被分成 $N$ 等份，每个用户获得一份<ul>
<li>由于每个用户都有各自专用的频段，所以用户之间不会发生干扰</li>
</ul>
</li>
<li>当用户数量少且固定不变时，这种分割简单有效<ul>
<li>FM 无线电广播就是一个无线信道的多路复用例子。每个电台获得 FM 波段的一部分使用权，大部分时间用该波段广播自己的信号</li>
</ul>
</li>
<li>当发送方的数量非常多而且经常不断变化，或者流量呈现突发性（bursty），FDM 就存在问题<ul>
<li>如果小于 $N$ 个用户通信，带宽被浪费</li>
<li>如果多于 $N$ 个用户通信，有些用户的通信会被拒绝</li>
</ul>
</li>
<li>假设用户数量维持在 $N$ 个，这种将单个信道划分成多个静态子信道的做法仍是低效的<ul>
<li>当有些用户停止通信时，他们的带宽就被浪费了</li>
</ul>
</li>
<li>在计算机系统中的数据流量表现出极端的突发性</li>
</ul>
<p>频分复用</p>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-1.png" width="65%">


<p>排队理论计算（M/M/1）</p>
<ul>
<li>$T$ = 发送一帧所需要的平均时延 （秒）</li>
<li>$C$ = 容量 （bps）</li>
<li>$\lambda$ = 随机到达帧的平均到达速率 （帧/秒）</li>
<li>$1 / \mu$ = 帧的长度均值 （bit/帧）</li>
<li>$\mu C$ = 信道的服务率 （帧/秒）</li>
</ul>
<p>$$ T = 1/（\mu C - \lambda） $$</p>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-2.png" width="65%">


<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-3.png" width="65%">


<p>现在将单个信道分成 $N$ 个独立的子信道，每个子信道的容量为 $C/N$ bps</p>
<ul>
<li>每个子信道的平均到达率变成 $\lambda / N$<br>$$ T = 1/(\mu(C/N) - (\lambda/N)) = N/(\mu C - \lambda) = NT$$</li>
</ul>
<p>划分信道后单个信道的平均延迟比不分的情况差 $N$ 倍</p>
<h2 id="动态信道分配的假设"><a href="#动态信道分配的假设" class="headerlink" title="动态信道分配的假设"></a>动态信道分配的假设</h2><p>5 个关键假设</p>
<ol>
<li>流量独立（independent traffic）<ul>
<li>该模型是由 $N$ 个独立的站（比如计算机、电话）组成的，每个站都有一个程序或者用户产生要传输的帧</li>
<li>在长度为 $\triangle t$ 的间隔内，期望产生的帧数是 $\lambda \triangle t$，这里 $\lambda$ 为常数（新帧的到达率）</li>
<li>一旦产生一帧，则站就被阻塞，直到该帧被成功发送出去</li>
</ul>
</li>
<li>单信道（single channel）<ul>
<li>所有的通信都用这一个信道</li>
<li>所有的站可以在该信道上传输数据，也可以从该信道接收数据</li>
<li>所有站的能力都相同，尽管协议可能为站分配不同的角色（比如优先级）</li>
</ul>
</li>
<li>冲突可观察（observable collision）<ul>
<li>如果两帧同时传输，则它们在时间上就重叠，由此产生的信号是混乱的，这种情况称为冲突（collision）</li>
<li>所有的站都能够检测到冲突事件的发生</li>
<li>冲突的帧必须在以后再次被发送</li>
<li>除了因冲突而产生的错误外，不会再有其他的错误</li>
</ul>
</li>
<li>时间连续或分槽（continuous or slotted time）<ul>
<li>时间可以假设是连续的，即在任何时刻都可以开始传输帧</li>
<li>另一种选择是把时间分槽或者分成离散的间隔（时间槽 time slot）<ul>
<li>帧的传输只能从每个时间槽的起始点开始</li>
<li>一个时间槽可能包含 0、1 或者多个帧，分别对应于空闲的时间槽、一次成功发送，一次冲突</li>
</ul>
</li>
</ul>
</li>
<li>载波侦听或不听（carrier sense or no carrier sense）<ul>
<li>有了载波侦听的假设，一个站在试图用信道之前就能知道该信道当前是否正被使用<ul>
<li>如果信道侦听结果是忙，则没有一个站会再去试图使用该信道</li>
</ul>
</li>
<li>如果没有载波侦听，站就无法在使用信道之前侦听信道，它们只能盲目地传输，以后再判断这次传输是否成功</li>
</ul>
</li>
</ol>
<p>最后三个假设依赖于该系统的工程</p>
<ul>
<li>流量独立意味着帧的到达是独立的，实际上是突发性的</li>
<li>单信道的假设是该模型的核心</li>
<li>冲突假设是最基本的</li>
<li>对时间给出两种不同的假设的理由在于时间槽可用来改善协议性能</li>
<li>一个网络可能具有载波侦听功能</li>
</ul>
<h1 id="多路访问协议"><a href="#多路访问协议" class="headerlink" title="多路访问协议"></a>多路访问协议</h1><p>当站有数据包要传送的时候</p>
<ul>
<li>以全信道速率 $R$ 来传送</li>
<li>站之间无事先协商</li>
</ul>
<p>两个或更多的站试图传送</p>
<ul>
<li>产生冲突</li>
</ul>
<p>随机访问 MAC 协议规定</p>
<ul>
<li>如何检测冲突</li>
<li>如何从冲突中恢复过来（例如，通过延迟重传）</li>
</ul>
<h2 id="ALOHA"><a href="#ALOHA" class="headerlink" title="ALOHA"></a>ALOHA</h2><h3 id="纯-ALOHA-pure-时间连续"><a href="#纯-ALOHA-pure-时间连续" class="headerlink" title="纯 ALOHA (pure) 时间连续"></a>纯 ALOHA (pure) 时间连续</h3><p>基本思想</p>
<ul>
<li>当用户有数据需要发送时就传输</li>
<li>冲突的帧将被损坏</li>
<li>发送方能够知道帧是否损坏</li>
<li>发送方等待一段随机的时间，然后再次发送该帧</li>
</ul>
<p>竞争（contention）系统</p>
<ul>
<li>系统中多个用户共享一个信道的方法会导致冲突</li>
</ul>
<p>ALOHA 系统中帧的框架结构</p>
<ul>
<li>所有帧具有同样的长度</li>
<li>对于 ALOHA 系统，采用统一长度的帧比长度可变的帧更能达到最大吞吐量</li>
</ul>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-4.png" width="65%">

<ul>
<li>只要两个帧在相同时间试图占用信道，冲突就会发生，并且两帧都会损坏</li>
<li>如果新帧的第一位与几乎快传完的前一帧的最后一位重叠，则这两帧都会损坏（具有不正确的校验和），稍后都必须被重传</li>
</ul>
<p>易受冲突周期</p>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-5.png" width="65%">


<p>纯 ALOHA 的效率</p>
<ul>
<li>用帧时（frame time）来表示传输一个标准的、固定长度的帧所需要的时间（即帧长度/比特率）</li>
</ul>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-6.png" width="65%">

<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-7.png" width="65%">


<h3 id="分槽-ALOHA"><a href="#分槽-ALOHA" class="headerlink" title="分槽 ALOHA"></a>分槽 ALOHA</h3><p>假设</p>
<ul>
<li>所有的帧大小相同</li>
<li>时间被分成相同大小的时间槽，每个时间槽内发送1帧</li>
<li>站只在时间槽的开始时刻传输帧</li>
<li>站是同步的</li>
<li>如果 2 个或更多的站在同一个时间槽内传输，所有站都能检测到冲突</li>
</ul>
<p>操作</p>
<ul>
<li>当站产生了新帧，它将在下一个时间槽传输</li>
<li>没有冲突，站可以在下一个时间槽发送新帧</li>
<li>发生冲突，站在以后的时间槽内以概率 $p$ 重传该帧，直到成功</li>
</ul>
<p>冲突</p>
<ul>
<li>阴影表示碰撞</li>
</ul>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-8.png" width="65%">


<p>优点和缺点</p>
<ul>
<li>优点<ul>
<li>每个活跃的站可以以全信道速率连续传送</li>
<li>高度分散：只有站之间的时间槽需要同步</li>
</ul>
</li>
<li>缺点<ul>
<li>冲突，浪费时间槽</li>
<li>空闲时间槽</li>
<li>站可能没法在少于发送时间槽的时间内检测到冲突</li>
</ul>
</li>
</ul>
<p>信道利用率</p>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-9.png" width="65%">


<p>吞吐量与负载</p>
<ul>
<li>18%</li>
<li>37% = 1/e</li>
</ul>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-10.png" width="65%">


<h2 id="载波侦听多路访问协议"><a href="#载波侦听多路访问协议" class="headerlink" title="载波侦听多路访问协议"></a>载波侦听多路访问协议</h2><p>载波侦听协议（carrier sense protocol）</p>
<ul>
<li>站监听是否存在载波（即是否有传输），并据此采取相应的动作</li>
<li>当一个站监听到除了它发送的信息以外的信息，说明产生了冲突</li>
</ul>
<h3 id="坚持和非坚持-CSMA"><a href="#坚持和非坚持-CSMA" class="headerlink" title="坚持和非坚持 CSMA"></a>坚持和非坚持 CSMA</h3><h4 id="1-坚持-CSMA"><a href="#1-坚持-CSMA" class="headerlink" title="1-坚持 CSMA"></a>1-坚持 CSMA</h4><ul>
<li>当一个站有数据要发送时，它首先侦听信道，确定当时是否有其他站正在传输数据</li>
<li>如果信道空闲，它就发送数据</li>
<li>如果信道忙，它就等待直到信道变成空闲，然后发送一帧</li>
<li>如果发生冲突，该站等待一段随机时间，然后再重复上述过程</li>
</ul>
<p>1-坚持：当站发现信道空闲时，它传输数据的概率为 1</p>
<p>如果两个站在第三个站的发送过程中准备好了拟发送的数据，它俩都会礼貌等待直到当前传输结束；然后双方确定同时开始传输，发生冲突</p>
<p>信号的传播延迟对冲突有着重大影响</p>
<ul>
<li>在某个站开始发送后，另一个站也刚好做好发送的准备并侦听信道</li>
<li>如果第一个站的信号没能到达第二个站，后者侦听到信道是空闲的，因而也开始发送，由此导致了冲突</li>
<li>这个时机取决于信道上合适的帧数，或信道的带宽延迟积（bandwith-delay product）<ul>
<li>如果信道只能够容纳帧的很小一部分（大多数局域网），由于信号的传播延迟小，冲突发生的机会就小</li>
<li>带宽延迟积越大，这种影响就变得越加重要，因而协议的性能越差</li>
</ul>
</li>
</ul>
<h4 id="非坚持-CSMA"><a href="#非坚持-CSMA" class="headerlink" title="非坚持 CSMA"></a>非坚持 CSMA</h4><ul>
<li>站在发送数据之前要先侦听信道</li>
<li>如果没有其他站在发送数据，则该站自己开始发送数据</li>
<li>如果信道当前正在使用中，则该站并不持续对信道进行监听（以便传输结束后立即抓住机会发送数据）</li>
<li>它会等待一段随机时间，然后重复上述算法<ul>
<li>因此该算法将有更好的信道利用率，但比 1-坚持 CSMA 有更大的延迟</li>
</ul>
</li>
</ul>
<h4 id="p-坚持-CSMA"><a href="#p-坚持-CSMA" class="headerlink" title="p-坚持 CSMA"></a>p-坚持 CSMA</h4><ul>
<li>适用于分时间槽的信道</li>
<li>当一个站准备好要发送的数据时，它就侦听信道</li>
<li>如果信道是空闲的，则它按照概率 $p$ 发送数据，以概率 $q=1-p$ 将发送推迟到下一个时间槽<ul>
<li>如果下一个时间槽也是空闲的，还是那样</li>
<li>整个过程一直重复，直到帧被发送出去，或者另一个站开始发送数据</li>
<li>当另一个站开始发送数据，那么按照冲突发生时的处理过程：等待一段随机时间，然后重新开始整个过程</li>
</ul>
</li>
<li>如果该站刚开始时就侦听到信道为忙，则它等到下一个时间槽，然后再应用上面的算法</li>
</ul>
<h4 id="信道使用率与负载比较"><a href="#信道使用率与负载比较" class="headerlink" title="信道使用率与负载比较"></a>信道使用率与负载比较</h4><img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-11.png" width="65%">


<h3 id="带冲突检测的-CSMA（CSMA-CD-CSMA-with-Collision-Detection）"><a href="#带冲突检测的-CSMA（CSMA-CD-CSMA-with-Collision-Detection）" class="headerlink" title="带冲突检测的 CSMA（CSMA/CD, CSMA with Collision Detection）"></a>带冲突检测的 CSMA（CSMA/CD, CSMA with Collision Detection）</h3><p>另一个改进是每个站快速检测到发生冲突后立即停止传输帧（而不是继续完成传输）</p>
<ul>
<li>节省时间和带宽</li>
<li>这种协议称为带冲突检测的 CSMA（CSMA/CD, CSMA with Collision Detection），它是经典以太局域网的基础</li>
</ul>
<p>冲突检测是一个模拟过程，站的硬件在传输时必须侦听信道。如果它读回的信号不同于它放到信道上的信号，则它就知道发生了冲突（碰撞）</p>
<p>概念模型</p>
<ul>
<li>竞争期、传输期、空闲期（所有站都静止）</li>
</ul>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-12.png" width="65%">

<p>在标记为 $t_0$ 点，一个站已经完成了帧的传送，其他需要发送帧的站现在可以试图发送</p>
<ul>
<li>如果有两个或多个站同时进行传送，冲突就会发生</li>
<li>如果一个站检测到冲突，则它立即终止自己的传送，等待一段随机时间，然后再重新尝试传送</li>
</ul>
<p>CSMA/CD 竞争间隙</p>
<ul>
<li>一个站需要多长时间才能意识到发生冲突（检测冲突的最小时间）<ul>
<li>到达最远站的时间的两倍</li>
</ul>
</li>
<li>只有在这段时间内没有检测到冲突，则站就可以认为自己抓住了信道</li>
</ul>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-13.png" width="65%">


<p>CSMA/CD 和分槽 ALOHA 的区别在于，只有一个站能用来传输的时间槽（即信道被抓住了）后面紧跟的那些时间槽被用来传输该帧的其余部分。如果帧时相比传播时间长很多，这种差异将大大提高协议的性能</p>
<p>可靠性</p>
<ul>
<li>没有 MAC 子层协议保证可靠的传输</li>
<li>即使在没有冲突的情况下，由于各种原因（例如，缺少缓冲区空间或错过中断），接收方可能没有正确地拷贝帧</li>
</ul>
<h1 id="以太网"><a href="#以太网" class="headerlink" title="以太网"></a>以太网</h1><p>IEEE 802</p>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-14.png" width="65%">

<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-15.png" width="65%">


<p>IEEE 802.3</p>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-16.png" width="65%">


<p>以太网流行的原因（主导的LAN技术）</p>
<ul>
<li>便宜</li>
<li>第一种广泛使用的LAN技术</li>
<li>比令牌 LAN 和 ATM 更简单、便宜</li>
<li>速度高达 10, 100, 1000, 10000 Mbps</li>
</ul>
<p><strong>两种以太网</strong></p>
<p>经典以太网</p>
<ul>
<li>解决了多路访问问题</li>
<li>3~10 Mbps</li>
</ul>
<p>交换式以太网</p>
<ul>
<li>使用了一种称为交换机的设备连接不同的计算机</li>
<li>100、1000、10000 Mbps</li>
<li>实际上，现在使用的只有交换式以太网</li>
</ul>
<h2 id="经典以太网"><a href="#经典以太网" class="headerlink" title="经典以太网"></a>经典以太网</h2><h3 id="经典以太网物理层"><a href="#经典以太网物理层" class="headerlink" title="经典以太网物理层"></a>经典以太网物理层</h3><p>经典以太网架构</p>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-17.png" width="65%">


<p>以太网的每个版本都有电缆的最大长度限制（即无需放大的长度），这个范围内的信号可以正常传播，超过这个范围信号将无法传播。可以用中继器把多条电缆连接起来</p>
<p>电缆</p>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-18.png" width="65%">

<ul>
<li>粗以太网（thick Ethernet）</li>
<li>细以太网（thin Ethernet）</li>
<li>双绞线</li>
<li>光纤</li>
</ul>
<p>10Base5 意味着它以 10 Mbps 的速度运行，使用基带信号并可支持长达 500 米的段</p>
<p>中继器（repeater）</p>
<ul>
<li>中继器是一个物理层设备，它能接收、放大（即再生）并在两个方向上重发信号</li>
<li>至于软件方面，一系列由中继器连接起来的电缆段与一根单独的电缆并没有什么不同（除了由中继器引入的少量延迟外）</li>
<li>以太网可以包含多个电缆段和多个中继器，但是不允许任意两个收发器之间的距离超过 2.5 千米，并且任意两个收发器之间经过的中继器不能超过 4 个</li>
</ul>
<h3 id="经典以太网-MAC-子层协议"><a href="#经典以太网-MAC-子层协议" class="headerlink" title="经典以太网 MAC 子层协议"></a>经典以太网 MAC 子层协议</h3><p>DIX 标准（DIX standard）</p>
<ul>
<li>DEC、Intel（因特尔）、Xerox（施乐）在 1987 年制定的 10 Mbps 以太网标准</li>
</ul>
<p>IEEE 802.3</p>
<ul>
<li>DIX 做少许修订后，1983 年成为 IEEE 802.3 标准</li>
</ul>
<p>以太网和 IEEE 802 封装</p>
<ul>
<li>主机要求 RFC1122</li>
</ul>
<p>连接到 10 Mbps 以太网电缆的每个 Internet 主机</p>
<ul>
<li>必须能够使用 RFC-894 封装发送和接收数据包</li>
<li>应该能够接受 RFC-894 数据包混合的 RFC-1042</li>
<li>可以使用 RFC-1042 封装发送数据包</li>
</ul>
<h3 id="以太网帧结构"><a href="#以太网帧结构" class="headerlink" title="以太网帧结构"></a>以太网帧结构</h3><img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-19.png" width="65%">

<p>8 bytes 前导码（preamble）</p>
<ul>
<li>每个字节包含比特模式 <code>10101010</code>（除了最后一个字节的最后2位为11）</li>
<li>最后一个字节称为 802.3 的帧起始界定符（SOF, Start of Frame）</li>
<li>比特模式是由曼彻斯特编码产生的 10 MHz 方波，每个波 6.4 微秒，以便接收方的时钟与发送方同步</li>
<li>最后两个 1 告诉接收方即将开始一个帧</li>
</ul>
<p>6 bytes 目标地址（destination, MAC address）</p>
<ul>
<li>如果第一位为 0，则表示是一个普通地址</li>
<li>如果第一位为 1，则表示是一个组地址<ul>
<li>组地址允许多个站同时监听一个地址</li>
<li>当某个帧被发送到一个组地址，该组中的所有站都接收它</li>
<li>往一组地址的发送行为称为组播（multicasting）</li>
</ul>
</li>
<li>全 1 组成的特殊地址保留用作广播（broadcasting）<ul>
<li>被网络上的所有站接收</li>
<li>组播是更多的选择，但涉及组管理；广播不区分站，不需要任何管理机制</li>
</ul>
</li>
</ul>
<p>6 bytes 源地址（source, MAC address）</p>
<ul>
<li>具有全球唯一性，由 IEEE 统一分配</li>
<li>地址段的前 3 个字节用作该站所在的组织唯一标识符（OUI, Organizationally Unique Identifer）<ul>
<li>由IEEE分配，指明了网络设备制造商</li>
<li>制造商获得一块 $2^{24}$ 的地址</li>
<li>地址字段的最后 3 个字节由制造商负责分配，并在设备出厂之前把完整的地址用程序编入 NIC</li>
</ul>
</li>
</ul>
<p>2 bytes 类型（Type）/ 长度（Length）</p>
<ul>
<li>以太网使用类型字段表示帧内包含了什么<ul>
<li>同一时间在同一台机器上使用了多种网络协议，当一个以太帧到达接收方时，操作系统需要知道应该调用哪个网络层协议来处理帧携带的数据包</li>
<li>类型字段指定了把帧送给那个进程处理</li>
<li><code>0x0800</code> 的类型代码意味着帧内包含一个 IPv4 的数据包</li>
</ul>
</li>
<li>IEEE 802.3 以其智慧决定该字段携带帧的长度<ul>
<li>以太网的长度必须由其内部携带的数据来确定<ul>
<li>违反分层</li>
<li>由数据包内的另一个逻辑链路控制（LLC, Logical Link Control）协议头来处理<ul>
<li>使用 8 个字节来传达 2 个字节的协议类型信息</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>0~1500 bytes 数据（data）</p>
<ul>
<li>最多可包含 1500 个字节</li>
<li>最小帧长限制<ul>
<li>当一个收发器检测到冲突时，它会截断当前的帧，这意味着冲突帧中已经送出的位将会出现在电缆上</li>
<li>为了容易区分有效帧和垃圾数据，以太网要求有效帧必须至少 64 字节长<ul>
<li>从目标地址算起直到校验和，包括这两个字段</li>
<li>如果帧的数据部分少于 46 个字节，则使用填充（pad）字段来填充该帧</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>0~46 bytes 填充（pad）</p>
<ul>
<li>填充保证传输的时间足够长，因此当第一个比特到达目的地的时候它仍在传输。当突发噪声回到发送方时传送过程仍在进行</li>
</ul>
<p>4 bytes 校验和（checksum）</p>
<ul>
<li>CRC 是差错检测码，用来确定接收到的帧比特是否正确</li>
<li>只提供检错功能，如果检测到一个错误，则丢弃帧</li>
</ul>
<p>以太网II 的类型字段</p>
<ul>
<li>任何值小于等于 <code>0x600 = 1536</code> 可解释为长度字段，任何大于 <code>0x600</code> 可解释为类型字段</li>
</ul>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-20.png" width="65%">


<p>MAC地址</p>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-21.png" width="65%">


<p>以太网II 帧中的 TCP/IP 包</p>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-22.png" width="65%">


<p>限制最小帧长的另一个理由是避免出现这样的情况：</p>
<ul>
<li>当一个短帧还没有到达电缆远端的发送方，该帧的传送就已经结束</li>
<li>而在电缆的远端，该帧可能与另一帧发生冲突</li>
</ul>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-23.png" width="65%">

<p>例子</p>
<ul>
<li>对于一个最大长度为 2500 米，具有 4 个中继器的 10 Mbps LAN，在最差情况下，往返一次的时间大约是 50 微秒（其中包括了通过 4 个中继器所需要的时间）</li>
<li>因此，允许的最小帧长必须至少需要这么长的时间来传输</li>
<li>以 10 Mbps 的速率，发送一位需要 100 纳秒，所以 500 位是保证可以工作的最小帧长</li>
<li>考虑到加上安全余量，该值被增加到 512 位，或者 64 字节</li>
</ul>
<h3 id="二进制指数后退的-CSMA-CA"><a href="#二进制指数后退的-CSMA-CA" class="headerlink" title="二进制指数后退的 CSMA/CA"></a>二进制指数后退的 CSMA/CA</h3><p>经典以太网使用 1-坚持 CSMA/CD 算法</p>
<ul>
<li>适配器（adapter）如果检测到其他中继器正在传输，则它不传输。载波侦测（carrier sense）</li>
<li>当正在传输的适配器检测到别的适配器正在传输，它就终止传输。冲突检测（collision detection）</li>
<li>在尝试重传前，适配器随机等待一段时间。随机访问（random access）</li>
<li><em>当站有帧要发送时需要侦听介质，一旦介质变为空闲便立即发送。在它们发送的同时监测信道上是否有冲突。如果有冲突，则立即停止传输，并发出一个短冲突加强信号，在等待一段随机时间后重发</em></li>
</ul>
<p>二进制指数后退算法（binary exponential backoff）</p>
<ol>
<li>适配器获取数据报并创建帧</li>
<li>如果适配器检测到信道空闲，它就开始传输帧；如果检测到信道繁忙，则等待信道空闲再发送</li>
<li>如果适配器在没有检测到其他传输的情况下传输完整个帧，则适配器对帧的操作就结束了</li>
<li>如果适配器在传输过程中检测到另一个传输，则终止（abort）并发送阻塞（jam）信号（48bit）</li>
<li>终止后，适配器进入指数后退：在第 m 次冲突后，适配器从 $0 \sim 2^m-1$ 中随机选择一个 $K$，然后等待 $K*512$ bit 的时间再返回到步骤 2</li>
</ol>
<p>实际情况</p>
<ul>
<li>第一次冲突发生后，每个站随机等待 0 个或 1 个时间槽，之后再重试发送，如果两个站冲突之后选择了同一个随机数，那么它们将再次冲突。在第二次冲突后，每个站随机选择 0、1、2、3，然后等待这么多个时间槽。如果第三次冲突又发生了，则下一次等待的时间槽数从 $0 \sim 2^3-1$ 之间随机选择</li>
<li>到达 10 次冲突后，随机数的选择区间被固定在最大值 1023（$2^{10}-1$）；在 16 次冲突之后，控制器放弃努力，并给计算机返回一个失败报告</li>
<li>时间槽是由最坏的情况决定的。500 m, 4 中继器 = 512 bit times = 51.2 µsec</li>
<li>随着网络速度的提高，最小帧长必须增加或最大电缆长度必须相应减小</li>
</ul>
<p>能确保两种情况</p>
<ul>
<li>如果只有少量站发生冲突，则它可能确保较低的延迟</li>
<li>当许多站发生冲突时，它也可以保证在一个相对合理的时间间隔内解决冲突</li>
<li>将延迟后退的步子截断在 1023 可避免延迟增长的太大</li>
</ul>
<p>如果没有发生碰撞，发送方就假设该帧可能被成功传递了</p>
<p>无论是 CSMA/CD 还是以太网都不提供确认</p>
<p>适用于错误率很低的有线电缆和光纤信道</p>
<h3 id="以太网性能"><a href="#以太网性能" class="headerlink" title="以太网性能"></a>以太网性能</h3><p>IEEE 802 标准性能</p>
<ul>
<li>$F$ 帧的长度（frame length）</li>
<li>$B$ 网络带宽（network bandwidth）</li>
<li>$L$ 电缆长度（cable length）</li>
<li>$c$ 信号传播速度（speed of signal propagation）</li>
<li>$e$ 每个帧e个竞争时间槽（contention slot）的最优（optimal）情形</li>
<li>信道效率（channel efficiency） = $1 / (1+2BLe/cF)$</li>
</ul>
<p>在给定帧长度的情况下，增加网络带宽（B）或距离（L）将会降低网络效率</p>
<ul>
<li>人们总是希望在长距离上拥有高带宽，而用这种方式实现的以太网可能并不是这些应用的最佳系统，所以接下来看交换式以太网</li>
</ul>
<p>在往返时间为 51.2 µsec，10 Mbps 的数据速率下，信道效率与就绪站数之间的关系</p>
<ul>
<li>对于 64 bytes 的时间槽时间，64 字节的帧并不是最有效的</li>
<li>当帧长度为 1024 字节，每个竞争间隔趋近于 e 个 64 字节时间槽时，竞争期为 174 字节长，效率为 85%</li>
</ul>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-24.png" width="65%">


<h2 id="交换式以太网"><a href="#交换式以太网" class="headerlink" title="交换式以太网"></a>交换式以太网</h2><img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-25.png" width="65%">

<ul>
<li>（a）每个站都有一条专用电线连接到一个中央集线器。集线器只是简单地连接所有线，就像把它们焊在一起<ul>
<li>双绞线集线器成为以太网的主要形式</li>
<li>然而，集线器不能增加容量，因为逻辑上等同于单根电缆的经典以太网</li>
</ul>
</li>
<li>（b）交换式以太网，核心是一个交换机（switch），交换机包含一块连接所有端口的高速背板</li>
</ul>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-26.png" width="65%">

<ul>
<li>每根电缆把交换机或集线器与一台计算机连接</li>
<li>具有集线器同样的优点<ul>
<li>通过简单的插入或拔出电缆就能完成增加或删除一台机器</li>
<li>若交换机本身发生了故障，更换整个交换机即可</li>
</ul>
</li>
<li>由于交换机只希望每个输入端口是标准以太网帧，就有可能把一部分端口用作集中器。连接到集线器上</li>
</ul>
<p>交换机内部</p>
<ul>
<li>只把帧输出到该帧想去的端口<ul>
<li>当交换机端口接收到来自某个站的以太网帧，它就检查该帧的以太网地址，确定该帧前往的目的地端口</li>
<li>要求交换机能够知道端口对应哪个地址</li>
</ul>
</li>
<li>通常背板的运行速度高达许多个 Gbps，并且使用专用的协议<ul>
<li>这些交换机专用协议无须标准化，因为它们完全隐藏在交换机内部</li>
</ul>
</li>
<li>然后，目标端口在通往目标站的双绞线上传输该帧，没有任何其他端口知道这个帧的存在</li>
</ul>
<h3 id="冲突域（collision-domain）"><a href="#冲突域（collision-domain）" class="headerlink" title="冲突域（collision domain）"></a>冲突域（collision domain）</h3><p>在集线器中，所有的站都位于通一个冲突域（collision domain），它们必须使用 CSMA/CD 算法来调度各自的传输</p>
<p>在交换机中，每个端口有自己独立的冲突域。冲突不可能发生，因而 CSMA/CD 也就不需要了</p>
<ul>
<li>通常情况下，电缆是全双工的，站和端口可以同时往电缆上发送帧，根本无须担心其他站或者端口</li>
<li>如果电缆是半双工的，则站和端口必须以通常的 CSMA/CD 方式竞争传输</li>
</ul>
<h3 id="交换机的好处"><a href="#交换机的好处" class="headerlink" title="交换机的好处"></a>交换机的好处</h3><p>性能优于集线器</p>
<ul>
<li>由于没有冲突，容量的使用更为有效</li>
<li>有了交换机可以同时发送多个帧（从不同的站发出）</li>
<li>也有安全上的益处<ul>
<li>大多数 LAN 接口都支持混杂模式（promiscuous mode），这个模式下所有的帧都被发到每台机器，而不只是那些它寻址的机器。每个连接到集线器上的计算机能看到其他所有计算机之间的流量</li>
</ul>
</li>
</ul>
<p>帧到达交换机端口并穿过交换机背板输出到适当的端口。然而，由于两帧可能在同一时间去往同一个输出端口，交换机必须有缓冲，以便它暂时把输入帧排入队直到帧被传输到输出端口</p>
<p>系统总吞吐量通常可以提高一个数量级，主要取决于端口数目和流量模式</p>
<p>冲突域数量</p>
<ul>
<li>交换机分割了冲突域</li>
</ul>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-27.png" width="65%">

<ul>
<li>仍然有一个广播域（交换机不用来创建互联网络，默认情况下不会分割广播域；路由器也可以）</li>
</ul>
<p>使用 VLAN 交换网络</p>
<ul>
<li>需要路由器来提供 VLAN 间通信或网络互联</li>
</ul>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-28.png" width="65%">


<h3 id="快速以太网-802-3u-1995"><a href="#快速以太网-802-3u-1995" class="headerlink" title="快速以太网 802.3u, 1995"></a>快速以太网 802.3u, 1995</h3><p>快速以太网的基本思想：保留原来的帧格式、接口和过程规则，只是将比特时间从 100 纳秒降低到 10 纳秒</p>
<p>所有的快速以太网系统使用集线器和交换机</p>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-29.png" width="65%">

<p>100 Base-TX（5 类双绞线）</p>
<ul>
<li>每个站用到两对双绞线，一对用于发送信号到集线器，另一对用于从集线器接收信号</li>
<li>可以处理 125 MHz 的时钟速率</li>
<li>采用 4B/5B 编码方案（125MHz*4/5=100MHZ）</li>
<li>在集线器中半双工（标准CDMA/CD）</li>
<li>在交换机中全双工（缓冲和告诉背板交换）</li>
</ul>
<h3 id="千兆以太网-802-3ab-1999"><a href="#千兆以太网-802-3ab-1999" class="headerlink" title="千兆以太网 802.3ab, 1999"></a>千兆以太网 802.3ab, 1999</h3><p>与快速以太网一样，千兆以太网使用点到点链路，也支持自动协商（配置autonegotiation）</p>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-30.png" width="65%">

<ul>
<li>（a）最简单的配置，两台计算机直接相连</li>
<li>（b）用一个交换机或集线器连接多台计算机和额外的交换机或集线器</li>
</ul>
<p>支持两种不同的操作模式</p>
<ul>
<li>全双工-交换机<ul>
<li>所有线路都具有缓存</li>
<li>不可能存在竞争，不需要 CSMA/CD</li>
<li>线缆最大长度由信号强度来决定，而不是突发噪声在最差情况下传回到发送方所需的事件来决定</li>
</ul>
</li>
<li>半双工-集线器<ul>
<li>无法将入境帧缓存</li>
<li>使用标准的 CSMA/CD 协议</li>
</ul>
</li>
</ul>
<p>新特性</p>
<ul>
<li>使得最大线缆长度增加到 200 m（以前 25 m）</li>
<li>载波扩充（carrier extension）<ul>
<li>本质是让硬件在普通的帧后增加一些填充位，将帧的长度扩充到 512 字节</li>
</ul>
</li>
<li>帧突发（frame bursting）<ul>
<li>允许发送方将多个待发送帧级联在一起，一次传输出去</li>
</ul>
</li>
</ul>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-31.png" width="65%">

<ul>
<li>既支持铜线也支持光纤</li>
</ul>
<h3 id="万兆以太网"><a href="#万兆以太网" class="headerlink" title="万兆以太网"></a>万兆以太网</h3><p>数据中心，交换局内部；长途高带宽中继线</p>
<ul>
<li>长距离的连接使用光纤，短距离的连接可以使用铜缆或光纤</li>
</ul>
<p>只支持全双工操作，CSMA/CD 不属于设计，兼容性依然重要，自动协商</p>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-32.png" width="65%">


<h2 id="以太网回顾"><a href="#以太网回顾" class="headerlink" title="以太网回顾"></a>以太网回顾</h2><ul>
<li>简单性和灵活性</li>
<li>可靠性</li>
<li>廉价</li>
<li>容易维护</li>
<li>TCP/IP 使得以太网容易实现互连，因为 IP 和以太网都是无连接的</li>
<li>变化不要求软件也变化</li>
</ul>
<h1 id="无线局域网"><a href="#无线局域网" class="headerlink" title="无线局域网*"></a>无线局域网*</h1><p>无线局域网标准</p>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-33.png" width="65%">


<h2 id="802-11-体系结构和协议栈"><a href="#802-11-体系结构和协议栈" class="headerlink" title="802.11 体系结构和协议栈"></a>802.11 体系结构和协议栈</h2><p>802.11 体系结构</p>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-34.png" width="65%">

<ul>
<li>（a）有架构模式，每个客户端与一个接入点（AP, access point）关联<ul>
<li>几个接入点可以通过分布式系统（distribution system）的有线网络连接在一起，形成一个扩展的 802.11 网络</li>
</ul>
</li>
<li>（b）自组织（ad hoc）模式，相互关联的计算机</li>
</ul>
<p>协议栈</p>
<ul>
<li>客户端和 AP 的协议栈相同</li>
<li>介质访问控制（MAC, medium access conntrol）子层决定如何分配信道（下一个谁可以发送）</li>
<li>逻辑链路控制（LLC, logical link control）子层，隐藏 802 系列协议之间的差异</li>
</ul>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-35.png" width="65%">


<h2 id="802-11-物理层"><a href="#802-11-物理层" class="headerlink" title="802.11 物理层"></a>802.11 物理层</h2><p>所有的 802.11 技术都使用短程无线电传输信号，通常在 2.4 GHz 或 5 GHz 频段</p>
<ul>
<li>最大优点是无需许可证</li>
</ul>
<p>频带（Frequency Bands） - ISM</p>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-36.png" width="65%">


<h2 id="802-11-MAC-子层协议"><a href="#802-11-MAC-子层协议" class="headerlink" title="802.11 MAC 子层协议"></a>802.11 MAC 子层协议</h2><p>802.11 试图避免冲突，采用的协议称为带有冲突避免的 CSMA（CSMA/CA, CDMA with Collision Avoidance）</p>
<ul>
<li>在发送帧前侦听信道和检测到冲突后指数后退</li>
<li>需要发送帧的站必须以随机后退开始，而且它不等待冲突的发生</li>
</ul>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-37.png" width="65%">


<p>和以太网不同的地方</p>
<ul>
<li>早起后退有助于避免冲突。冲突避免在无线传输中非常重要，即使只发生一个冲突因为整个帧都被传输了出去，因此冲突的代价非常大</li>
<li>利用确认来推断是否发生冲突，因为冲突无法被检测出来</li>
</ul>
<p>隐藏（hidden）终端问题 &amp; 暴露（exposed）终端问题</p>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-38.png" width="65%">


<p>虚拟信道侦听</p>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-39.png" width="65%">

<ul>
<li>网络分配向量（NAV, Network Allocation Vector），说明这个帧所属的一系列数据将传输多长时间</li>
<li>可选的 RTS/CTS 机制使用NAV来防止隐藏终端在同一时间发送：RTS 请求对方允许自己发送一个帧，CTS 作为应答</li>
</ul>
<p>带有物理侦听和虚拟侦听的 CSMA/CA 是 802.11 协议的核心</p>
<p>802.11 机制</p>
<ul>
<li>可靠性<ul>
<li>降低传输速率</li>
<li>发送短帧，802.11 允许把帧拆分成更小的段（segment），每个段有自己的校验和</li>
</ul>
</li>
<li>节省电源<ul>
<li>节能的基本机制建立在信标帧（beacon frames）基础上<ul>
<li>电源管理位（power-management），省电模式（power-save mode）</li>
<li>自动省电交付（APSD, Automatic Power Save Delivery）</li>
</ul>
</li>
</ul>
</li>
<li>服务质量<ul>
<li>802.11e 帧间间隔</li>
<li>传输机会（transmission opportunity）</li>
</ul>
</li>
</ul>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-40.png" width="65%">

<ul>
<li>DFC 帧间隔（DIFS）</li>
<li>短帧间间隔（SIFS）</li>
<li>仲裁帧间空间（AIFS）</li>
<li>扩展帧间间隔（EIFS）</li>
</ul>
<h2 id="802-11-帧结构"><a href="#802-11-帧结构" class="headerlink" title="802.11 帧结构"></a>802.11 帧结构</h2><p>802.11 标准定义了空中三种不同类型的帧：数据帧、控制帧、管理帧</p>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-41.png" width="65%">

<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-42.png" width="65%">


<h2 id="服务"><a href="#服务" class="headerlink" title="服务"></a>服务</h2><ul>
<li>关联（association）：连接到 AP</li>
<li>重新关联（reassociation）：改变首选 AP</li>
<li>分发（distribution）：决定如何路由帧</li>
<li>集成（integration）：处理协议转换</li>
<li>数据传送（data delivery）</li>
<li>隐私（privacy）：管理加密和解密 ，WPA2 基于 AES</li>
<li>QoS 流量调度（QoS traffic scheduling）：处理不同优先级</li>
<li>管理频谱：发射功率控制（transmit power control）&amp; 动态频率选择（dynamic frequency selection）</li>
</ul>
<h1 id="宽带无线"><a href="#宽带无线" class="headerlink" title="宽带无线*"></a>宽带无线*</h1><p>802.16 与 802.11 和 3G 的比较<br>802.16 体系结构和协议栈<br>802.16 物理层<br>802.16 MAC 子层协议<br>802.16 帧结构</p>
<h1 id="蓝牙"><a href="#蓝牙" class="headerlink" title="蓝牙*"></a>蓝牙*</h1><p>蓝牙体系结构<br>蓝牙协议栈<br>蓝牙无线电层<br>蓝牙链路层<br>蓝牙帧结构</p>
<h1 id="RFID-——-无线频射识别"><a href="#RFID-——-无线频射识别" class="headerlink" title="RFID —— 无线频射识别*"></a>RFID —— 无线频射识别*</h1><p>EPC Gen 2 体系结构<br>EPC Gen 2 物理层<br>EPC Gen 2 标签标识层<br>标签标识消息格式</p>
<h1 id="数据链路层交换"><a href="#数据链路层交换" class="headerlink" title="数据链路层交换"></a>数据链路层交换</h1><p>网桥和虚拟网桥协议</p>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-43.png" width="65%">


<p><strong>用网桥来连接局域网，组织成更大的局域网</strong></p>
<p>交换机（switch）是网桥（bridge）的现代名称</p>
<ul>
<li>工作在数据链路层</li>
<li>通过检查数据链路层地址来转发帧</li>
<li>不审查被转发帧的有效载荷字段<ul>
<li>可以处理任何类型的数据包：IPv4, IPv6, ATM, AppleTalk, …</li>
</ul>
</li>
</ul>
<p>集线器或中继器：只是将电信号放大</p>
<p>路由器</p>
<ul>
<li>工作在网络层</li>
<li>检查数据包的地址，并基于这些地址路由数据包<ul>
<li>只能以预先设计好的协议工作</li>
</ul>
</li>
</ul>
<h2 id="网桥的使用"><a href="#网桥的使用" class="headerlink" title="网桥的使用"></a>网桥的使用</h2><p>使用网桥的理由</p>
<ul>
<li>多个不同的局域网需要交互</li>
<li>分散在多个地方的局域网需要互连（更便宜的解决方案）</li>
<li>将单个局域网划分成小局域网以减少负载</li>
<li>将局域网划分为长距离段（长往返延迟）</li>
<li>提供可靠性（来自出错节点的垃圾帧）</li>
<li>提供安全（防止混杂模式）</li>
</ul>
<p>透明网桥</p>
<ul>
<li>不需要更改硬件</li>
<li>不需要更改软件</li>
<li>不需要设置交换机地址</li>
<li>不需要下载路由表或参数</li>
<li>无状态（或尽可能无状态），不影响原有状态</li>
</ul>
<p>创建透明网桥的两种算法</p>
<ul>
<li>后向学习算法（backward learning）</li>
<li>生成树算法（spanning tree）</li>
</ul>
<h2 id="学习网桥"><a href="#学习网桥" class="headerlink" title="学习网桥"></a>学习网桥</h2><p>两个局域网桥接在一起的拓扑结构分两种情况</p>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-44.png" width="65%">

<ul>
<li><p>（a）两个多点局域网</p>
<ul>
<li>为了桥接多点局域网，网桥的加入犹如在每个多点局域网上加了一个新站</li>
</ul>
</li>
<li><p>（b）局域网用点到点电缆连接在一起，包括一个集线器</p>
<ul>
<li>为了桥接点到点局域网，要么集线器连到网桥，或者最好换成网桥以便提高性能</li>
<li>不同种类的线缆都可以附接到一个网桥上<ul>
<li>连接网桥 B1 和 B2 的线缆可能是长距离光前连接</li>
<li>连接网桥和栈的线缆可能是短距离双绞线</li>
</ul>
</li>
</ul>
</li>
<li><p>网桥是站和集线器都能与之相连的设备</p>
</li>
<li><p>所有附在网桥统一端口的站都属于通一个冲突域，该冲突域和其他端口的冲突域不同</p>
</li>
<li><p>如果存在多个站，例如传统的以太网、集线器或半双工链路，那么帧的发送需要用到 CSMA/CD 协议</p>
</li>
</ul>
<h3 id="路由过程"><a href="#路由过程" class="headerlink" title="路由过程"></a>路由过程</h3><p>取决于入境帧的到达端口和目标地址</p>
<ul>
<li>如果目标地址的端口和源端口相同，则丢弃该帧</li>
<li>如果目标地址的端口和源端口不同，则将该帧转发到目标端口</li>
<li>如果目标地址的端口未知，则使用泛洪法，将帧发送到所有的端口，除了它入境的端口</li>
</ul>
<h3 id="后向学习算法"><a href="#后向学习算法" class="headerlink" title="后向学习算法"></a>后向学习算法</h3><p>建立一个大的哈希表</p>
<ul>
<li>初始情况下，所有的哈希表都是空的，因此使用泛洪将帧发送出去</li>
<li>通过检查源地址，网桥学习到局域网中哪些机器是可达的，并在哈希表中构造一项</li>
<li>网桥中有一个进程定期扫描哈希表，并且将那些时间值在几分钟以前的表项都清除掉<ul>
<li>网桥记录帧的到达时间</li>
</ul>
</li>
</ul>
<h3 id="网桥设计"><a href="#网桥设计" class="headerlink" title="网桥设计"></a>网桥设计</h3><p>两种基本架构</p>
<ul>
<li>直通式交换（cut-through switching）/ 虫孔路由（wormhole routing）<ul>
<li>一旦入境线路输入帧的目的地址字段就可以马上转发（在完整接收一帧之前就开始了转发） </li>
</ul>
</li>
<li>存储-转发交换（store-and-forward switching）<ul>
<li>在转发前接收并分析整个包</li>
</ul>
</li>
</ul>
<p>网桥上的协议处理</p>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-45.png" width="65%">

<ul>
<li>一个数据包来自一个更高的层次，下降进入以太网 MAC 层。它获取一个以太网头（还有一个尾）组成传输单元。该单元被传到物理层，通过电缆传播，然后被网桥接收</li>
<li>在网桥中，帧从物理层网上传给以太网的 MAC 层。相比普通站协议栈里的以太网 MAC 层，网桥的这一层扩展了处理功能<ul>
<li>它把帧传递到中继（relay）模块，该模块仍属于 MAC 层，网桥的中继功能仅仅使用了以太网的 MAC 头来确定如何处理帧</li>
</ul>
</li>
<li>一般情况下，在给定层上中继时可以重写该层的头。VALN 就提供了这样的一个例子</li>
<li>在任何情况下，网桥都不能查看帧的内部，以及了解帧携带的是否是一个 IP 数据</li>
<li>一个具有 $K$ 个端口的网桥将有 $K$ 个 MAC 和物理层实例</li>
</ul>
<h2 id="生成树网桥"><a href="#生成树网桥" class="headerlink" title="生成树网桥"></a>生成树网桥</h2><p>为了提高可靠性，网桥之间可使用冗余链路</p>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-46.png" width="65%">


<p>在一对网桥之间并行设置了两条链路。这种设计可确保一条链路宕掉后，网络不会被分成两组计算机，使它们之间无法通信</p>
<ul>
<li>问题：生成了拓扑环路</li>
</ul>
<p>控制网桥和交换机互连的规则</p>
<ul>
<li>网桥 / 交换机 / 集线器 LAN 必须形成一棵树，而不是一个环<ul>
<li>这意味任何两台主机之间只能有一条路径</li>
</ul>
</li>
<li>如果存在多条平行路径，则会形成一个环，导致循环中无线循环帧</li>
<li>为了防止这种情况发生 IEEE（IEEE 802.1D）定义了生成树算法（STA），该算法可自动检测环路并禁用其中一条并行路径</li>
</ul>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-47.png" width="65%">

<ul>
<li>虚线表示不属于生成树的链路</li>
</ul>
<h3 id="生成树算法（STA-Spanning-Tree-Algorithm）"><a href="#生成树算法（STA-Spanning-Tree-Algorithm）" class="headerlink" title="生成树算法（STA ,Spanning Tree Algorithm）"></a>生成树算法（STA ,Spanning Tree Algorithm）</h3><ul>
<li>首先选择一个网桥作为生成树的根（具有最低标识符（MAC address）的网桥）</li>
<li>每个网桥确定从根网桥到其每个端口的路径成本（根路径成本）。成本由段的数量和这些段的比特率确定</li>
<li>确定根端口<ul>
<li>对于网桥，它的哪个端口具有最低的根路径成本</li>
</ul>
</li>
<li>确定指定网桥<ul>
<li>将处理特定 LAN 请求的网桥（即使该 LAN 可能连接了多个网桥）。根据从网段到根网桥的最小路径成本进行选择</li>
</ul>
</li>
<li>树包括每个局域网，但不一定是每个桥</li>
<li>继续检查拓扑结构的变化，更新生成树</li>
</ul>
<h2 id="中继器，集线器，网桥，交换机，路由，网关"><a href="#中继器，集线器，网桥，交换机，路由，网关" class="headerlink" title="中继器，集线器，网桥，交换机，路由，网关"></a>中继器，集线器，网桥，交换机，路由，网关</h2><p>之所以存在不同层的问题，是因为不同的设备使用不同的信息来决定如何交换</p>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-48.png" width="65%">

<h3 id="物理层"><a href="#物理层" class="headerlink" title="物理层"></a>物理层</h3><p>中继器</p>
<ul>
<li>中继器是模拟设备，主要用来处理自己所连的线缆上的信号。在一个线缆上出现的信号被清理、放大，然后再被放到另一个线缆上</li>
<li>中继器并不理解帧、数据包、帧头，它们只知道把比特编码成电压的符号</li>
</ul>
<p>集线器</p>
<ul>
<li>集线器有多条输入线路，它将这些输入线路连接在一起。从任何一条线路上到达的帧都被发送到所有其他的线路上。如果两帧同时到达，它们将会冲突。</li>
<li>连接到同一个集线器上的所有线路必须以同样的速度运行</li>
<li>集线器与中继器不同，它们（通常）不会放大入境信号，并且可以有多条输入线路</li>
<li>但是两者差别并不大。与中继器一样，集线器也是物理层设备，因而它不会检查链路层地址，也不以任何方式使用该地址</li>
</ul>
<h3 id="数据链路层"><a href="#数据链路层" class="headerlink" title="数据链路层"></a>数据链路层</h3><p>网桥</p>
<ul>
<li>网桥连接两个或多个局域网</li>
<li>跟集线器一样，一个现代网桥有多个端口，通常具有 4~48 条某种类型的输入线</li>
<li>与集线器不同的是网桥的每个端口被隔离成它自己一个冲突域；如果端口是全双工的点到点线路，则需要用到 CDMA/CD 算法</li>
<li>当到达一帧时，网桥从帧头提取出帧的目的地址，并用该地址查询一张应该把帧发往哪里去的表。对于以太网，地址是 48 位的目标地址。</li>
<li>网桥只把帧输出到所需要的端口，在同一时间可以转发多个帧</li>
<li>网桥比集线器提供了更好的性能，隔离网桥端口还意味着输入线路可以以不同的速度运行，甚至可以是不同的网络类型。</li>
<li>从一端口接收一帧并从另一个不同端口发送出去，需要网桥内部进行缓冲。如果帧的速度大于网桥的重发速度，网桥就可能耗尽缓冲空间从而开始不得不丢弃帧</li>
<li>网桥最初是被用来连接不同种类的局域网，由于不同局域网之间的差异，这方面的工作总是做的不好，反正就是不好</li>
</ul>
<p>局域网之间的差异还可以体现在另外两个方面</p>
<ul>
<li>安全性<ul>
<li>某些局域网使用了链路层的加密机制，例如 802.11 ；有的局域网却不具备任何安全性，例如以太网</li>
</ul>
</li>
<li>服务质量<ul>
<li>某些局域网具备服务质量特性，例如 802.11 ；而有的却没有服务质量的概念，例如以太网</li>
</ul>
</li>
</ul>
<p>交换机是现代网桥的另一个称呼，差异更多体现在市场上而不是技术上</p>
<h3 id="网络层"><a href="#网络层" class="headerlink" title="网络层"></a>网络层</h3><p>路由器</p>
<ul>
<li>当一个数据包进入到路由器时，帧头和帧尾被剥掉，帧的有效载荷字段中的数据包被传给路由软件</li>
<li>路由软件利用数据包的头信息来选择输出线路</li>
<li>对于一个 IP 数据包，包头将包含一个 32 位（IPv4）或者 128 位（IPv6）地址，而不是 48 位的 IEEE 802 地址</li>
<li>路由软件看不到帧地址，甚至不知道数据包来自哪个 LAN 或哪条点到点线路</li>
</ul>
<h3 id="传输层"><a href="#传输层" class="headerlink" title="传输层"></a>传输层</h3><p>传输网关，它们将两台使用了不同面向连接传输协议的计算机连接起来</p>
<ul>
<li>TCP/IP 协议和 SCTP</li>
<li>传输网关将数据包从一个连接复制到另一个连接上，并且根据需要对数据包重新进行格式化</li>
</ul>
<h3 id="应用层"><a href="#应用层" class="headerlink" title="应用层"></a>应用层</h3><p>应用网关能理解数据的格式和内容，并且可以将消息从一种格式转换为另一种格式</p>
<h3 id="交换机和集线器的区别"><a href="#交换机和集线器的区别" class="headerlink" title="交换机和集线器的区别"></a>交换机和集线器的区别</h3><p>集线器/中继器将帧转发到所有接口（端口），从而使帧到达所有连接的设备，即使该帧可能仅用于连接到特定端口的系统</p>
<p>交换机仅将帧转发到所需的接口，通过映射MAC地址到端口。因此交换机可以减少其他LAN网段上的数据包数量，提高性能和安全性</p>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-49.png" width="65%">

<h3 id="交换机和路由器的区别"><a href="#交换机和路由器的区别" class="headerlink" title="交换机和路由器的区别"></a>交换机和路由器的区别</h3><p>虽然大多数交换机都在 OSI 参考模型的数据链路层（第 2 层）上运行，但有些交换机还具有路由器的功能，并且也在网络层（第 3 层）工作。事实上，第3层交换机与路由器非常相似。</p>
<p>路由器和第3层交换机的根本区别在于，交换机具有优化的硬件，可以像第 2 层交换机一样快速传递数据，但它们就像路由器一样，决定如何在第 3 层传输流量</p>
<p>在局域网环境中，第 3 层交换机通常比路由器更快，因为它建立在交换硬件上</p>
<h2 id="虚拟局域网（VALN）"><a href="#虚拟局域网（VALN）" class="headerlink" title="虚拟局域网（VALN）"></a>虚拟局域网（VALN）</h2><p>大楼使用了集线器和交换机的集中式布线</p>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-50.png" width="65%">

<p>谁连在哪一个 LAN 真的很重要吗？</p>
<ul>
<li>简单的回答是肯定的</li>
<li>将 LAN 上的用户分成适当的组，以便反映出用户的组织结构，而不是大楼的物理布局结构<ul>
<li>安全性：公共访问</li>
<li>负载</li>
<li>广播流量：广播风暴（broadcast）<ul>
<li>ARP 广播 IP 获得 MAC 地址</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>VLAN</p>
<ul>
<li>范围有限制的 LAN</li>
<li>将逻辑拓扑从物理拓扑中分离出来</li>
<li>用软件方式对大楼重新进行布线</li>
<li>基于 VLAN 感知交换机（VLAN-aware）</li>
</ul>
<p>为了使 VLAN 正常运行，网桥必须建立配置表</p>
<ul>
<li>这些配置表明了通过哪些端口可以访问到那些 VLAN</li>
<li>每个端口都分配了 VLAN 颜色<ul>
<li>如果一个端口上的所有计算机都属于同一个 LAN，则适用</li>
</ul>
</li>
<li>为每个 MAC 地址分配了 VLAN 颜色<ul>
<li>列出与其连接的每台计算机的 MAC 地址以及计算机所在的 LAN</li>
</ul>
</li>
<li>每个第 3 层协议或 IP 地址分配了 VLAN 颜色<ul>
<li>灵活但违反了层的依赖性</li>
</ul>
</li>
</ul>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-51.png" width="65%">

<ul>
<li>B1 将来自灰色（G）端口的帧泛洪给所有灰色端口，以及 B2，B2 将发送给标记为 G 的端口</li>
<li>一个端口可以标记为多种VLAN颜色</li>
</ul>
<h3 id="IEEE-802-1Q-标准"><a href="#IEEE-802-1Q-标准" class="headerlink" title="IEEE 802.1Q 标准"></a>IEEE 802.1Q 标准</h3><p>为了实现 VLAN，需要知道帧的 VLAN 颜色（而不是机器的 VLAN 颜色）</p>
<ul>
<li>解决问题的关键是要认识到实际使用 VLAN 字段的只是网桥和交换机</li>
<li>它们只出现在连接网桥的线路上，而不是连接到最终站的线路上</li>
<li>所以网桥必须能感知 VLAN</li>
</ul>
<img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-52.png" width="65%">

<ul>
<li>因为一些计算机（和交换机）无法感知 VLAN，因此第一个 VLAN 感知的网桥在帧上添加一个 VLAN 字段，路径上的最后一个网桥把添加的 VLAN 字段删除</li>
</ul>
<h3 id="VLAN-中继（Trunking）"><a href="#VLAN-中继（Trunking）" class="headerlink" title="VLAN 中继（Trunking）"></a>VLAN 中继（Trunking）</h3><img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-53.png" width="65%">

<ul>
<li>每个逻辑 VLAN 就像一个单独的物理网桥</li>
<li>VLAN 可以跨越多个交换机</li>
<li>中继为多个 VLAN 传送流量</li>
<li>中继使用特殊封装来区分不同的 VLAN</li>
</ul>
<h3 id="IEEE-802-1Q-帧"><a href="#IEEE-802-1Q-帧" class="headerlink" title="IEEE 802.1Q 帧"></a>IEEE 802.1Q 帧</h3><img src="https://media.githubusercontent.com/media/jckling/Assets/master/computer%20networks/4/4-54.png" width="65%">

<p>唯一的变化是加入了一对 2 字节字段</p>
<ul>
<li>第一个 2 字节是 VLAN 协议标识符（VLAN protocol ID），它的值是 <code>0x8100</code></li>
<li>第二个 2 字节包含三个字字段，最主要的是 VLAN 标识符（identifier）</li>
</ul>
<p>当一个标记帧到达一个 VLAN 感知交换机，该交换机利用 VLAN 标识符作为索引，在一张表中查找要去哪些端口</p>
<ul>
<li>自动配置表（动态建立）的方法<ul>
<li>IP 子网</li>
<li>MAC 地址，VMPS（VLAN 成员策略服务器）</li>
<li>用户认证，802.1x，端口访问控制</li>
</ul>
</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Jckling</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://jckling.github.io/2018/06/14/Notes/Computer%20Networks/The-Medium-Access-Control-Sublayer/">https://jckling.github.io/2018/06/14/Notes/Computer Networks/The-Medium-Access-Control-Sublayer/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://jckling.github.io" target="_blank">Jckling's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">计算机网络</a><a class="post-meta__tags" href="/tags/Computer-Networks/">Computer Networks</a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2021/06/14/z9KUc1FV7eaD8pi.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/jckling/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/jckling/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li></ul></div></div><div class="ads-wrap"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-1035234274961147" data-ad-slot="3100725659" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2018/06/14/Notes/Computer%20Networks/The-Data-Link-Layer/"><img class="prev-cover" src="https://i.loli.net/2021/06/14/z9KUc1FV7eaD8pi.jpg" onerror="onerror=null;src='/img/jckling/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">《计算机网络（英文版·第5版）》 The Data Link Layer</div></div></a></div><div class="next-post pull-right"><a href="/2018/06/13/Notes/Computer%20Networks/The-Physical-Layer/"><img class="next-cover" src="https://i.loli.net/2021/06/14/z9KUc1FV7eaD8pi.jpg" onerror="onerror=null;src='/img/jckling/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">《计算机网络（英文版·第5版）》 The Physical Layer</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2018/06/25/Notes/Computer%20Networks/The-Application-Layer/" title="《计算机网络（英文版·第5版）》 The Application Layer"><img class="cover" src="https://i.loli.net/2021/06/14/z9KUc1FV7eaD8pi.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-06-25</div><div class="title">《计算机网络（英文版·第5版）》 The Application Layer</div></div></a></div><div><a href="/2018/06/14/Notes/Computer%20Networks/The-Data-Link-Layer/" title="《计算机网络（英文版·第5版）》 The Data Link Layer"><img class="cover" src="https://i.loli.net/2021/06/14/z9KUc1FV7eaD8pi.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-06-14</div><div class="title">《计算机网络（英文版·第5版）》 The Data Link Layer</div></div></a></div><div><a href="/2018/06/13/Notes/Computer%20Networks/The-Introduction/" title="《计算机网络（英文版·第5版）》 The Introduction"><img class="cover" src="https://i.loli.net/2021/06/14/z9KUc1FV7eaD8pi.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-06-13</div><div class="title">《计算机网络（英文版·第5版）》 The Introduction</div></div></a></div><div><a href="/2018/06/13/Notes/Computer%20Networks/The-Physical-Layer/" title="《计算机网络（英文版·第5版）》 The Physical Layer"><img class="cover" src="https://i.loli.net/2021/06/14/z9KUc1FV7eaD8pi.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-06-13</div><div class="title">《计算机网络（英文版·第5版）》 The Physical Layer</div></div></a></div><div><a href="/2018/06/22/Notes/Computer%20Networks/The-Transport-Layer/" title="《计算机网络（英文版·第5版）》 The Transport Layer"><img class="cover" src="https://i.loli.net/2021/06/14/z9KUc1FV7eaD8pi.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-06-22</div><div class="title">《计算机网络（英文版·第5版）》 The Transport Layer</div></div></a></div><div><a href="/2018/06/15/Notes/Computer%20Networks/The-Network-Layer/" title="《计算机网络（英文版·第5版）》 The Network Layer"><img class="cover" src="https://i.loli.net/2021/06/14/z9KUc1FV7eaD8pi.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-06-15</div><div class="title">《计算机网络（英文版·第5版）》 The Network Layer</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/jckling/avatar.jpg" onerror="this.onerror=null;this.src='/img/jckling/avatar_404.png'" alt="avatar"/></div><div class="author-info__name">Jckling</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">107</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">40</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/jckling"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">欢迎访问本站 🥳 <br/>评论需要审核，请不要重复提交~</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BF%A1%E9%81%93%E5%88%86%E9%85%8D%E9%97%AE%E9%A2%98"><span class="toc-number">1.</span> <span class="toc-text">信道分配问题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E4%BF%A1%E9%81%93%E5%88%86%E9%85%8D"><span class="toc-number">1.1.</span> <span class="toc-text">静态信道分配</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E4%BF%A1%E9%81%93%E5%88%86%E9%85%8D%E7%9A%84%E5%81%87%E8%AE%BE"><span class="toc-number">1.2.</span> <span class="toc-text">动态信道分配的假设</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A4%9A%E8%B7%AF%E8%AE%BF%E9%97%AE%E5%8D%8F%E8%AE%AE"><span class="toc-number">2.</span> <span class="toc-text">多路访问协议</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ALOHA"><span class="toc-number">2.1.</span> <span class="toc-text">ALOHA</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%AF-ALOHA-pure-%E6%97%B6%E9%97%B4%E8%BF%9E%E7%BB%AD"><span class="toc-number">2.1.1.</span> <span class="toc-text">纯 ALOHA (pure) 时间连续</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%A7%BD-ALOHA"><span class="toc-number">2.1.2.</span> <span class="toc-text">分槽 ALOHA</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BD%BD%E6%B3%A2%E4%BE%A6%E5%90%AC%E5%A4%9A%E8%B7%AF%E8%AE%BF%E9%97%AE%E5%8D%8F%E8%AE%AE"><span class="toc-number">2.2.</span> <span class="toc-text">载波侦听多路访问协议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9D%9A%E6%8C%81%E5%92%8C%E9%9D%9E%E5%9D%9A%E6%8C%81-CSMA"><span class="toc-number">2.2.1.</span> <span class="toc-text">坚持和非坚持 CSMA</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%9D%9A%E6%8C%81-CSMA"><span class="toc-number">2.2.1.1.</span> <span class="toc-text">1-坚持 CSMA</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%9E%E5%9D%9A%E6%8C%81-CSMA"><span class="toc-number">2.2.1.2.</span> <span class="toc-text">非坚持 CSMA</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#p-%E5%9D%9A%E6%8C%81-CSMA"><span class="toc-number">2.2.1.3.</span> <span class="toc-text">p-坚持 CSMA</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%A1%E9%81%93%E4%BD%BF%E7%94%A8%E7%8E%87%E4%B8%8E%E8%B4%9F%E8%BD%BD%E6%AF%94%E8%BE%83"><span class="toc-number">2.2.1.4.</span> <span class="toc-text">信道使用率与负载比较</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%A6%E5%86%B2%E7%AA%81%E6%A3%80%E6%B5%8B%E7%9A%84-CSMA%EF%BC%88CSMA-CD-CSMA-with-Collision-Detection%EF%BC%89"><span class="toc-number">2.2.2.</span> <span class="toc-text">带冲突检测的 CSMA（CSMA&#x2F;CD, CSMA with Collision Detection）</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%A5%E5%A4%AA%E7%BD%91"><span class="toc-number">3.</span> <span class="toc-text">以太网</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%8F%E5%85%B8%E4%BB%A5%E5%A4%AA%E7%BD%91"><span class="toc-number">3.1.</span> <span class="toc-text">经典以太网</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%8F%E5%85%B8%E4%BB%A5%E5%A4%AA%E7%BD%91%E7%89%A9%E7%90%86%E5%B1%82"><span class="toc-number">3.1.1.</span> <span class="toc-text">经典以太网物理层</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%8F%E5%85%B8%E4%BB%A5%E5%A4%AA%E7%BD%91-MAC-%E5%AD%90%E5%B1%82%E5%8D%8F%E8%AE%AE"><span class="toc-number">3.1.2.</span> <span class="toc-text">经典以太网 MAC 子层协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A5%E5%A4%AA%E7%BD%91%E5%B8%A7%E7%BB%93%E6%9E%84"><span class="toc-number">3.1.3.</span> <span class="toc-text">以太网帧结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%8C%87%E6%95%B0%E5%90%8E%E9%80%80%E7%9A%84-CSMA-CA"><span class="toc-number">3.1.4.</span> <span class="toc-text">二进制指数后退的 CSMA&#x2F;CA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A5%E5%A4%AA%E7%BD%91%E6%80%A7%E8%83%BD"><span class="toc-number">3.1.5.</span> <span class="toc-text">以太网性能</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%A4%E6%8D%A2%E5%BC%8F%E4%BB%A5%E5%A4%AA%E7%BD%91"><span class="toc-number">3.2.</span> <span class="toc-text">交换式以太网</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%B2%E7%AA%81%E5%9F%9F%EF%BC%88collision-domain%EF%BC%89"><span class="toc-number">3.2.1.</span> <span class="toc-text">冲突域（collision domain）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%A4%E6%8D%A2%E6%9C%BA%E7%9A%84%E5%A5%BD%E5%A4%84"><span class="toc-number">3.2.2.</span> <span class="toc-text">交换机的好处</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BF%AB%E9%80%9F%E4%BB%A5%E5%A4%AA%E7%BD%91-802-3u-1995"><span class="toc-number">3.2.3.</span> <span class="toc-text">快速以太网 802.3u, 1995</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%83%E5%85%86%E4%BB%A5%E5%A4%AA%E7%BD%91-802-3ab-1999"><span class="toc-number">3.2.4.</span> <span class="toc-text">千兆以太网 802.3ab, 1999</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%87%E5%85%86%E4%BB%A5%E5%A4%AA%E7%BD%91"><span class="toc-number">3.2.5.</span> <span class="toc-text">万兆以太网</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A5%E5%A4%AA%E7%BD%91%E5%9B%9E%E9%A1%BE"><span class="toc-number">3.3.</span> <span class="toc-text">以太网回顾</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%97%A0%E7%BA%BF%E5%B1%80%E5%9F%9F%E7%BD%91"><span class="toc-number">4.</span> <span class="toc-text">无线局域网*</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#802-11-%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E5%92%8C%E5%8D%8F%E8%AE%AE%E6%A0%88"><span class="toc-number">4.1.</span> <span class="toc-text">802.11 体系结构和协议栈</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#802-11-%E7%89%A9%E7%90%86%E5%B1%82"><span class="toc-number">4.2.</span> <span class="toc-text">802.11 物理层</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#802-11-MAC-%E5%AD%90%E5%B1%82%E5%8D%8F%E8%AE%AE"><span class="toc-number">4.3.</span> <span class="toc-text">802.11 MAC 子层协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#802-11-%E5%B8%A7%E7%BB%93%E6%9E%84"><span class="toc-number">4.4.</span> <span class="toc-text">802.11 帧结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1"><span class="toc-number">4.5.</span> <span class="toc-text">服务</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%BD%E5%B8%A6%E6%97%A0%E7%BA%BF"><span class="toc-number">5.</span> <span class="toc-text">宽带无线*</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%93%9D%E7%89%99"><span class="toc-number">6.</span> <span class="toc-text">蓝牙*</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RFID-%E2%80%94%E2%80%94-%E6%97%A0%E7%BA%BF%E9%A2%91%E5%B0%84%E8%AF%86%E5%88%AB"><span class="toc-number">7.</span> <span class="toc-text">RFID —— 无线频射识别*</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82%E4%BA%A4%E6%8D%A2"><span class="toc-number">8.</span> <span class="toc-text">数据链路层交换</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E6%A1%A5%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">8.1.</span> <span class="toc-text">网桥的使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E7%BD%91%E6%A1%A5"><span class="toc-number">8.2.</span> <span class="toc-text">学习网桥</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E8%BF%87%E7%A8%8B"><span class="toc-number">8.2.1.</span> <span class="toc-text">路由过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8E%E5%90%91%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95"><span class="toc-number">8.2.2.</span> <span class="toc-text">后向学习算法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E6%A1%A5%E8%AE%BE%E8%AE%A1"><span class="toc-number">8.2.3.</span> <span class="toc-text">网桥设计</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E6%A0%91%E7%BD%91%E6%A1%A5"><span class="toc-number">8.3.</span> <span class="toc-text">生成树网桥</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E6%A0%91%E7%AE%97%E6%B3%95%EF%BC%88STA-Spanning-Tree-Algorithm%EF%BC%89"><span class="toc-number">8.3.1.</span> <span class="toc-text">生成树算法（STA ,Spanning Tree Algorithm）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%AD%E7%BB%A7%E5%99%A8%EF%BC%8C%E9%9B%86%E7%BA%BF%E5%99%A8%EF%BC%8C%E7%BD%91%E6%A1%A5%EF%BC%8C%E4%BA%A4%E6%8D%A2%E6%9C%BA%EF%BC%8C%E8%B7%AF%E7%94%B1%EF%BC%8C%E7%BD%91%E5%85%B3"><span class="toc-number">8.4.</span> <span class="toc-text">中继器，集线器，网桥，交换机，路由，网关</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%A9%E7%90%86%E5%B1%82"><span class="toc-number">8.4.1.</span> <span class="toc-text">物理层</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82"><span class="toc-number">8.4.2.</span> <span class="toc-text">数据链路层</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%B1%82"><span class="toc-number">8.4.3.</span> <span class="toc-text">网络层</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%A0%E8%BE%93%E5%B1%82"><span class="toc-number">8.4.4.</span> <span class="toc-text">传输层</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%B1%82"><span class="toc-number">8.4.5.</span> <span class="toc-text">应用层</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%92%8C%E9%9B%86%E7%BA%BF%E5%99%A8%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">8.4.6.</span> <span class="toc-text">交换机和集线器的区别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%92%8C%E8%B7%AF%E7%94%B1%E5%99%A8%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">8.4.7.</span> <span class="toc-text">交换机和路由器的区别</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91%EF%BC%88VALN%EF%BC%89"><span class="toc-number">8.5.</span> <span class="toc-text">虚拟局域网（VALN）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#IEEE-802-1Q-%E6%A0%87%E5%87%86"><span class="toc-number">8.5.1.</span> <span class="toc-text">IEEE 802.1Q 标准</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#VLAN-%E4%B8%AD%E7%BB%A7%EF%BC%88Trunking%EF%BC%89"><span class="toc-number">8.5.2.</span> <span class="toc-text">VLAN 中继（Trunking）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IEEE-802-1Q-%E5%B8%A7"><span class="toc-number">8.5.3.</span> <span class="toc-text">IEEE 802.1Q 帧</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/11/22/Other/Datalog%20%E5%BC%95%E6%93%8E%20Souffl%C3%A9%20%E6%8C%87%E5%8D%97/" title="Datalog 引擎 Soufflé 指南"><img src="https://i.loli.net/2021/06/14/oSn9dxfYhEHClIe.jpg" onerror="this.onerror=null;this.src='/img/jckling/404.jpg'" alt="Datalog 引擎 Soufflé 指南"/></a><div class="content"><a class="title" href="/2021/11/22/Other/Datalog%20%E5%BC%95%E6%93%8E%20Souffl%C3%A9%20%E6%8C%87%E5%8D%97/" title="Datalog 引擎 Soufflé 指南">Datalog 引擎 Soufflé 指南</a><time datetime="2021-11-22T11:01:43.000Z" title="发表于 2021-11-22 19:01:43">2021-11-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/11/05/Jaeger/CVE-2020-12691%20%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E7%9B%B8%E5%85%B3%E4%BF%A1%E6%81%AF%E8%BF%BD%E8%B8%AA/" title="CVE-2020-12691 漏洞利用相关信息追踪"><img src="https://i.loli.net/2021/06/14/bk5UlhqE4DZJfYu.png" onerror="this.onerror=null;this.src='/img/jckling/404.jpg'" alt="CVE-2020-12691 漏洞利用相关信息追踪"/></a><div class="content"><a class="title" href="/2021/11/05/Jaeger/CVE-2020-12691%20%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E7%9B%B8%E5%85%B3%E4%BF%A1%E6%81%AF%E8%BF%BD%E8%B8%AA/" title="CVE-2020-12691 漏洞利用相关信息追踪">CVE-2020-12691 漏洞利用相关信息追踪</a><time datetime="2021-11-05T07:25:15.000Z" title="发表于 2021-11-05 15:25:15">2021-11-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/10/26/Other/LogiQL%20%E5%85%A5%E9%97%A8/" title="LogiQL 入门"><img src="https://developer.logicblox.com/wp-content/uploads/2017/12/prod-bg-panelfour.jpg" onerror="this.onerror=null;this.src='/img/jckling/404.jpg'" alt="LogiQL 入门"/></a><div class="content"><a class="title" href="/2021/10/26/Other/LogiQL%20%E5%85%A5%E9%97%A8/" title="LogiQL 入门">LogiQL 入门</a><time datetime="2021-10-26T08:15:05.000Z" title="发表于 2021-10-26 16:15:05">2021-10-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/10/12/Security/Gadget%20Inspector%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/" title="Gadget Inspector 源码解析"><img src="https://i.loli.net/2021/06/14/2NXqsznriG8blc7.jpg" onerror="this.onerror=null;this.src='/img/jckling/404.jpg'" alt="Gadget Inspector 源码解析"/></a><div class="content"><a class="title" href="/2021/10/12/Security/Gadget%20Inspector%20%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/" title="Gadget Inspector 源码解析">Gadget Inspector 源码解析</a><time datetime="2021-10-12T03:41:30.000Z" title="发表于 2021-10-12 11:41:30">2021-10-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/10/11/Other/Python%20%E7%88%AC%E5%8F%96%20twitter%20%E6%95%B0%E6%8D%AE/" title="Python 爬取 twitter 数据"><img src="https://about.twitter.com/content/dam/about-twitter/en/brand-toolkit/brand-banner-desktop.jpg.twimg.1920.jpg" onerror="this.onerror=null;this.src='/img/jckling/404.jpg'" alt="Python 爬取 twitter 数据"/></a><div class="content"><a class="title" href="/2021/10/11/Other/Python%20%E7%88%AC%E5%8F%96%20twitter%20%E6%95%B0%E6%8D%AE/" title="Python 爬取 twitter 数据">Python 爬取 twitter 数据</a><time datetime="2021-10-11T10:44:50.000Z" title="发表于 2021-10-11 18:44:50">2021-10-11</time></div></div></div></div><div class="card-widget ads-wrap"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-1035234274961147" data-ad-slot="8787224657" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div></div></main><footer id="footer" style="background-image: url('https://i.loli.net/2021/06/14/z9KUc1FV7eaD8pi.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By Jckling</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>function loadWaline () {
  function initWaline () {
    const waline = new Waline(Object.assign({
      el: '#waline-wrap',
      serverURL: 'https://blog-comments-puce.vercel.app',
      avatar: 'retro',
      avatarCDN: 'https://sdn.geekzu.org/avatar/',
      path: location.pathname,
      visitor: false,
      dark: 'html[data-theme="dark"]'
    }, {"emoji":"https://cdn.jsdelivr.net/gh/walinejs/emojis@1.0.0/tw-emoji"}))
  }

  if (typeof Waline === 'function') initWaline() 
  else getScript('https://cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js').then(initWaline)
}

if ('Waline' === 'Waline' || !false) {
  if (false) btf.loadComment(document.getElementById('waline-wrap'),loadWaline)
  else setTimeout(loadWaline, 0)
} else {
  function loadOtherComment () {
    loadWaline()
  }
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>